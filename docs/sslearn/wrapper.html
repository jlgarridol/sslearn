<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>sslearn.wrapper API documentation</title>
            <link rel="icon" href="data:image/webp;base64,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"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../sslearn.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;sslearn</a>

<a href="/sslearn">            <img src="data:image/webp;base64,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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#self-training-algorithms">Self-Training Algorithms</a></li>
  <li><a href="#co-training-algorithms">Co-Training Algorithms</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#SelfTraining">SelfTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SelfTraining.__init__">SelfTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#SelfTraining.fit">fit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Setred">Setred</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Setred.__init__">Setred</a>
                        </li>
                        <li>
                                <a class="function" href="#Setred.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#Setred.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#Setred.predict_proba">predict_proba</a>
                        </li>
                        <li>
                                <a class="function" href="#Setred.score">score</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CoTraining">CoTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CoTraining.__init__">CoTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.predict_proba">predict_proba</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.score">score</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CoTrainingByCommittee">CoTrainingByCommittee</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.__init__">CoTrainingByCommittee</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.predict_proba">predict_proba</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.score">score</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DemocraticCoLearning">DemocraticCoLearning</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DemocraticCoLearning.__init__">DemocraticCoLearning</a>
                        </li>
                        <li>
                                <a class="function" href="#DemocraticCoLearning.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#DemocraticCoLearning.predict_proba">predict_proba</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Rasco">Rasco</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Rasco.__init__">Rasco</a>
                        </li>
                        <li>
                                <a class="function" href="#Rasco.fit">fit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RelRasco">RelRasco</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RelRasco.__init__">RelRasco</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CoForest">CoForest</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CoForest.__init__">CoForest</a>
                        </li>
                        <li>
                                <a class="function" href="#CoForest.fit">fit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TriTraining">TriTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TriTraining.__init__">TriTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#TriTraining.fit">fit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DeTriTraining">DeTriTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DeTriTraining.__init__">DeTriTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#DeTriTraining.fit">fit</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>pdoc 14.4.0</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../sslearn.html">sslearn</a><wbr>.wrapper    </h1>

                        <div class="docstring"><p>Summary of module <code><a href="">sslearn.wrapper</a></code>:</p>

<p>This module contains classes to train semi-supervised learning algorithms using a wrapper approach.</p>

<h2 id="self-training-algorithms">Self-Training Algorithms</h2>

<ul>
<li><a href="#SelfTraining">SelfTraining</a>: 
Self-training algorithm.</li>
<li><a href="#Setred">Setred</a>:
Self-training with redundancy reduction.</li>
</ul>

<h2 id="co-training-algorithms">Co-Training Algorithms</h2>

<ul>
<li><a href="#CoTraining">CoTraining</a>:
Co-training</li>
<li><a href="#CoTrainingByCommittee">CoTrainingByCommittee</a>:
Co-training by committee</li>
<li><a href="#DemocraticCoLearning">DemocraticCoLearning</a>:
Democratic co-learning</li>
<li><a href="#Rasco">Rasco</a>:
Random subspace co-training</li>
<li><a href="#RelRasco">RelRasco</a>:
Relevant random subspace co-training</li>
<li><a href="#CoForest">CoForest</a>:
Co-Forest</li>
<li><a href="#TriTraining">TriTraining</a>:
Tri-training</li>
<li><a href="#DeTriTraining">DeTriTraining</a>:
Data Editing Tri-training</li>
</ul>
</div>

                        <input id="mod-wrapper-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-wrapper-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">Summary of module `sslearn.wrapper`:</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">This module contains classes to train semi-supervised learning algorithms using a wrapper approach.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">## Self-Training Algorithms</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">* [SelfTraining](#SelfTraining): </span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">Self-training algorithm.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="sd">* [Setred](#Setred):</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">Self-training with redundancy reduction.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">## Co-Training Algorithms</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">* [CoTraining](#CoTraining):</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="sd">Co-training</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="sd">* [CoTrainingByCommittee](#CoTrainingByCommittee):</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="sd">Co-training by committee</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="sd">* [DemocraticCoLearning](#DemocraticCoLearning):</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="sd">Democratic co-learning</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="sd">* [Rasco](#Rasco):</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="sd">Random subspace co-training</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="sd">* [RelRasco](#RelRasco):</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="sd">Relevant random subspace co-training</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="sd">* [CoForest](#CoForest):</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="sd">Co-Forest</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="sd">* [TriTraining](#TriTraining):</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="sd">Tri-training</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="sd">* [DeTriTraining](#DeTriTraining):</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="sd">Data Editing Tri-training</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="kn">from</span> <span class="nn">._co</span> <span class="kn">import</span> <span class="p">(</span><span class="n">CoForest</span><span class="p">,</span> <span class="n">CoTraining</span><span class="p">,</span> <span class="n">CoTrainingByCommittee</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>                  <span class="n">DemocraticCoLearning</span><span class="p">,</span> <span class="n">Rasco</span><span class="p">,</span> <span class="n">RelRasco</span><span class="p">)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a><span class="kn">from</span> <span class="nn">._self</span> <span class="kn">import</span> <span class="n">SelfTraining</span><span class="p">,</span> <span class="n">Setred</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a><span class="kn">from</span> <span class="nn">._tritraining</span> <span class="kn">import</span> <span class="n">DeTriTraining</span><span class="p">,</span> <span class="n">TriTraining</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SelfTraining&quot;</span><span class="p">,</span> <span class="s2">&quot;Setred&quot;</span><span class="p">,</span> <span class="s2">&quot;CoTraining&quot;</span><span class="p">,</span> <span class="s2">&quot;CoTrainingByCommittee&quot;</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>           <span class="s2">&quot;DemocraticCoLearning&quot;</span><span class="p">,</span> <span class="s2">&quot;Rasco&quot;</span><span class="p">,</span> <span class="s2">&quot;RelRasco&quot;</span><span class="p">,</span> <span class="s2">&quot;CoForest&quot;</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>           <span class="s2">&quot;TriTraining&quot;</span><span class="p">,</span> <span class="s2">&quot;DeTriTraining&quot;</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="SelfTraining">
                            <input id="SelfTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SelfTraining</span><wbr>(<span class="base">sklearn.semi_supervised._self_training.SelfTrainingClassifier</span>):

                <label class="view-source-button" for="SelfTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SelfTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SelfTraining-17"><a href="#SelfTraining-17"><span class="linenos"> 17</span></a><span class="k">class</span> <span class="nc">SelfTraining</span><span class="p">(</span><span class="n">SelfTrainingClassifier</span><span class="p">):</span>
</span><span id="SelfTraining-18"><a href="#SelfTraining-18"><span class="linenos"> 18</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SelfTraining-19"><a href="#SelfTraining-19"><span class="linenos"> 19</span></a><span class="sd">    **Self Training Classifier with data loader compatible.**</span>
</span><span id="SelfTraining-20"><a href="#SelfTraining-20"><span class="linenos"> 20</span></a><span class="sd">    ----------------------------</span>
</span><span id="SelfTraining-21"><a href="#SelfTraining-21"><span class="linenos"> 21</span></a>
</span><span id="SelfTraining-22"><a href="#SelfTraining-22"><span class="linenos"> 22</span></a><span class="sd">    Is the same `SelfTrainingClassifier` from sklearn but with `sslearn` data loader compatible.</span>
</span><span id="SelfTraining-23"><a href="#SelfTraining-23"><span class="linenos"> 23</span></a><span class="sd">    For more information, see the [sklearn documentation](https://scikit-learn.org/stable/modules/generated/sklearn.semi_supervised.SelfTrainingClassifier.html).</span>
</span><span id="SelfTraining-24"><a href="#SelfTraining-24"><span class="linenos"> 24</span></a>
</span><span id="SelfTraining-25"><a href="#SelfTraining-25"><span class="linenos"> 25</span></a><span class="sd">    **Example**</span>
</span><span id="SelfTraining-26"><a href="#SelfTraining-26"><span class="linenos"> 26</span></a><span class="sd">    -----------</span>
</span><span id="SelfTraining-27"><a href="#SelfTraining-27"><span class="linenos"> 27</span></a><span class="sd">    ```python</span>
</span><span id="SelfTraining-28"><a href="#SelfTraining-28"><span class="linenos"> 28</span></a><span class="sd">    from sklearn.datasets import load_iris</span>
</span><span id="SelfTraining-29"><a href="#SelfTraining-29"><span class="linenos"> 29</span></a><span class="sd">    from sslearn.model_selection import artificial_ssl_dataset</span>
</span><span id="SelfTraining-30"><a href="#SelfTraining-30"><span class="linenos"> 30</span></a><span class="sd">    from sslearn.wrapper import SelfTraining</span>
</span><span id="SelfTraining-31"><a href="#SelfTraining-31"><span class="linenos"> 31</span></a>
</span><span id="SelfTraining-32"><a href="#SelfTraining-32"><span class="linenos"> 32</span></a><span class="sd">    X, y = load_iris(return_X_y=True)</span>
</span><span id="SelfTraining-33"><a href="#SelfTraining-33"><span class="linenos"> 33</span></a><span class="sd">    X, y, X_unlabel, y_unlabel, _, _ = artificial_ssl_dataset(X, y, label_rate=0.1, random_state=0)</span>
</span><span id="SelfTraining-34"><a href="#SelfTraining-34"><span class="linenos"> 34</span></a>
</span><span id="SelfTraining-35"><a href="#SelfTraining-35"><span class="linenos"> 35</span></a><span class="sd">    clf = SelfTraining()</span>
</span><span id="SelfTraining-36"><a href="#SelfTraining-36"><span class="linenos"> 36</span></a><span class="sd">    clf.fit(X, y)</span>
</span><span id="SelfTraining-37"><a href="#SelfTraining-37"><span class="linenos"> 37</span></a><span class="sd">    clf.score(X_unlabel, y_unlabel)</span>
</span><span id="SelfTraining-38"><a href="#SelfTraining-38"><span class="linenos"> 38</span></a><span class="sd">    ```</span>
</span><span id="SelfTraining-39"><a href="#SelfTraining-39"><span class="linenos"> 39</span></a>
</span><span id="SelfTraining-40"><a href="#SelfTraining-40"><span class="linenos"> 40</span></a><span class="sd">    **References**</span>
</span><span id="SelfTraining-41"><a href="#SelfTraining-41"><span class="linenos"> 41</span></a><span class="sd">    --------------</span>
</span><span id="SelfTraining-42"><a href="#SelfTraining-42"><span class="linenos"> 42</span></a><span class="sd">    David Yarowsky. (1995). &lt;br&gt;</span>
</span><span id="SelfTraining-43"><a href="#SelfTraining-43"><span class="linenos"> 43</span></a><span class="sd">    Unsupervised word sense disambiguation rivaling supervised methods.&lt;br&gt;</span>
</span><span id="SelfTraining-44"><a href="#SelfTraining-44"><span class="linenos"> 44</span></a><span class="sd">    In &lt;i&gt;Proceedings of the 33rd annual meeting on Association for Computational Linguistics (ACL &#39;95).&lt;/i&gt;&lt;br&gt;</span>
</span><span id="SelfTraining-45"><a href="#SelfTraining-45"><span class="linenos"> 45</span></a><span class="sd">    Association for Computational Linguistics,&lt;br&gt;</span>
</span><span id="SelfTraining-46"><a href="#SelfTraining-46"><span class="linenos"> 46</span></a><span class="sd">    Stroudsburg, PA, USA, 189-196. &lt;br&gt;</span>
</span><span id="SelfTraining-47"><a href="#SelfTraining-47"><span class="linenos"> 47</span></a><span class="sd">    [10.3115/981658.981684](https://doi.org/10.3115/981658.981684)</span>
</span><span id="SelfTraining-48"><a href="#SelfTraining-48"><span class="linenos"> 48</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SelfTraining-49"><a href="#SelfTraining-49"><span class="linenos"> 49</span></a>
</span><span id="SelfTraining-50"><a href="#SelfTraining-50"><span class="linenos"> 50</span></a>    <span class="n">_estimator_type</span> <span class="o">=</span> <span class="s2">&quot;classifier&quot;</span>
</span><span id="SelfTraining-51"><a href="#SelfTraining-51"><span class="linenos"> 51</span></a>
</span><span id="SelfTraining-52"><a href="#SelfTraining-52"><span class="linenos"> 52</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="SelfTraining-53"><a href="#SelfTraining-53"><span class="linenos"> 53</span></a>                 <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="SelfTraining-54"><a href="#SelfTraining-54"><span class="linenos"> 54</span></a>                 <span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
</span><span id="SelfTraining-55"><a href="#SelfTraining-55"><span class="linenos"> 55</span></a>                 <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span>
</span><span id="SelfTraining-56"><a href="#SelfTraining-56"><span class="linenos"> 56</span></a>                 <span class="n">k_best</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="SelfTraining-57"><a href="#SelfTraining-57"><span class="linenos"> 57</span></a>                 <span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="SelfTraining-58"><a href="#SelfTraining-58"><span class="linenos"> 58</span></a>                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="SelfTraining-59"><a href="#SelfTraining-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Self-training. Adaptation of SelfTrainingClassifier from sklearn with data loader compatible.</span>
</span><span id="SelfTraining-60"><a href="#SelfTraining-60"><span class="linenos"> 60</span></a>
</span><span id="SelfTraining-61"><a href="#SelfTraining-61"><span class="linenos"> 61</span></a><span class="sd">        This class allows a given supervised classifier to function as a</span>
</span><span id="SelfTraining-62"><a href="#SelfTraining-62"><span class="linenos"> 62</span></a><span class="sd">        semi-supervised classifier, allowing it to learn from unlabeled data. It</span>
</span><span id="SelfTraining-63"><a href="#SelfTraining-63"><span class="linenos"> 63</span></a><span class="sd">        does this by iteratively predicting pseudo-labels for the unlabeled data</span>
</span><span id="SelfTraining-64"><a href="#SelfTraining-64"><span class="linenos"> 64</span></a><span class="sd">        and adding them to the training set.</span>
</span><span id="SelfTraining-65"><a href="#SelfTraining-65"><span class="linenos"> 65</span></a>
</span><span id="SelfTraining-66"><a href="#SelfTraining-66"><span class="linenos"> 66</span></a><span class="sd">        The classifier will continue iterating until either max_iter is reached, or</span>
</span><span id="SelfTraining-67"><a href="#SelfTraining-67"><span class="linenos"> 67</span></a><span class="sd">        no pseudo-labels were added to the training set in the previous iteration.</span>
</span><span id="SelfTraining-68"><a href="#SelfTraining-68"><span class="linenos"> 68</span></a>
</span><span id="SelfTraining-69"><a href="#SelfTraining-69"><span class="linenos"> 69</span></a><span class="sd">        Parameters</span>
</span><span id="SelfTraining-70"><a href="#SelfTraining-70"><span class="linenos"> 70</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining-71"><a href="#SelfTraining-71"><span class="linenos"> 71</span></a><span class="sd">        base_estimator : estimator object</span>
</span><span id="SelfTraining-72"><a href="#SelfTraining-72"><span class="linenos"> 72</span></a><span class="sd">            An estimator object implementing ``fit`` and ``predict_proba``.</span>
</span><span id="SelfTraining-73"><a href="#SelfTraining-73"><span class="linenos"> 73</span></a><span class="sd">            Invoking the ``fit`` method will fit a clone of the passed estimator,</span>
</span><span id="SelfTraining-74"><a href="#SelfTraining-74"><span class="linenos"> 74</span></a><span class="sd">            which will be stored in the ``base_estimator_`` attribute.</span>
</span><span id="SelfTraining-75"><a href="#SelfTraining-75"><span class="linenos"> 75</span></a>
</span><span id="SelfTraining-76"><a href="#SelfTraining-76"><span class="linenos"> 76</span></a><span class="sd">        threshold : float, default=0.75</span>
</span><span id="SelfTraining-77"><a href="#SelfTraining-77"><span class="linenos"> 77</span></a><span class="sd">            The decision threshold for use with `criterion=&#39;threshold&#39;`.</span>
</span><span id="SelfTraining-78"><a href="#SelfTraining-78"><span class="linenos"> 78</span></a><span class="sd">            Should be in [0, 1). When using the &#39;threshold&#39; criterion, a</span>
</span><span id="SelfTraining-79"><a href="#SelfTraining-79"><span class="linenos"> 79</span></a><span class="sd">            :ref:`well calibrated classifier &lt;calibration&gt;` should be used.</span>
</span><span id="SelfTraining-80"><a href="#SelfTraining-80"><span class="linenos"> 80</span></a>
</span><span id="SelfTraining-81"><a href="#SelfTraining-81"><span class="linenos"> 81</span></a><span class="sd">        criterion : {&#39;threshold&#39;, &#39;k_best&#39;}, default=&#39;threshold&#39;</span>
</span><span id="SelfTraining-82"><a href="#SelfTraining-82"><span class="linenos"> 82</span></a><span class="sd">            The selection criterion used to select which labels to add to the</span>
</span><span id="SelfTraining-83"><a href="#SelfTraining-83"><span class="linenos"> 83</span></a><span class="sd">            training set. If &#39;threshold&#39;, pseudo-labels with prediction</span>
</span><span id="SelfTraining-84"><a href="#SelfTraining-84"><span class="linenos"> 84</span></a><span class="sd">            probabilities above `threshold` are added to the dataset. If &#39;k_best&#39;,</span>
</span><span id="SelfTraining-85"><a href="#SelfTraining-85"><span class="linenos"> 85</span></a><span class="sd">            the `k_best` pseudo-labels with highest prediction probabilities are</span>
</span><span id="SelfTraining-86"><a href="#SelfTraining-86"><span class="linenos"> 86</span></a><span class="sd">            added to the dataset. When using the &#39;threshold&#39; criterion, a</span>
</span><span id="SelfTraining-87"><a href="#SelfTraining-87"><span class="linenos"> 87</span></a><span class="sd">            :ref:`well calibrated classifier &lt;calibration&gt;` should be used.</span>
</span><span id="SelfTraining-88"><a href="#SelfTraining-88"><span class="linenos"> 88</span></a>
</span><span id="SelfTraining-89"><a href="#SelfTraining-89"><span class="linenos"> 89</span></a><span class="sd">        k_best : int, default=10</span>
</span><span id="SelfTraining-90"><a href="#SelfTraining-90"><span class="linenos"> 90</span></a><span class="sd">            The amount of samples to add in each iteration. Only used when</span>
</span><span id="SelfTraining-91"><a href="#SelfTraining-91"><span class="linenos"> 91</span></a><span class="sd">            `criterion` is k_best&#39;.</span>
</span><span id="SelfTraining-92"><a href="#SelfTraining-92"><span class="linenos"> 92</span></a>
</span><span id="SelfTraining-93"><a href="#SelfTraining-93"><span class="linenos"> 93</span></a><span class="sd">        max_iter : int or None, default=10</span>
</span><span id="SelfTraining-94"><a href="#SelfTraining-94"><span class="linenos"> 94</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal</span>
</span><span id="SelfTraining-95"><a href="#SelfTraining-95"><span class="linenos"> 95</span></a><span class="sd">            to 0. If it is ``None``, the classifier will continue to predict labels</span>
</span><span id="SelfTraining-96"><a href="#SelfTraining-96"><span class="linenos"> 96</span></a><span class="sd">            until no new pseudo-labels are added, or all unlabeled samples have</span>
</span><span id="SelfTraining-97"><a href="#SelfTraining-97"><span class="linenos"> 97</span></a><span class="sd">            been labeled.</span>
</span><span id="SelfTraining-98"><a href="#SelfTraining-98"><span class="linenos"> 98</span></a>
</span><span id="SelfTraining-99"><a href="#SelfTraining-99"><span class="linenos"> 99</span></a><span class="sd">        verbose : bool, default=False</span>
</span><span id="SelfTraining-100"><a href="#SelfTraining-100"><span class="linenos">100</span></a><span class="sd">            Enable verbose output.</span>
</span><span id="SelfTraining-101"><a href="#SelfTraining-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SelfTraining-102"><a href="#SelfTraining-102"><span class="linenos">102</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">k_best</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="SelfTraining-103"><a href="#SelfTraining-103"><span class="linenos">103</span></a>
</span><span id="SelfTraining-104"><a href="#SelfTraining-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="SelfTraining-105"><a href="#SelfTraining-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SelfTraining-106"><a href="#SelfTraining-106"><span class="linenos">106</span></a><span class="sd">        Fits this ``SelfTrainingClassifier`` to a dataset.</span>
</span><span id="SelfTraining-107"><a href="#SelfTraining-107"><span class="linenos">107</span></a>
</span><span id="SelfTraining-108"><a href="#SelfTraining-108"><span class="linenos">108</span></a><span class="sd">        Parameters</span>
</span><span id="SelfTraining-109"><a href="#SelfTraining-109"><span class="linenos">109</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining-110"><a href="#SelfTraining-110"><span class="linenos">110</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="SelfTraining-111"><a href="#SelfTraining-111"><span class="linenos">111</span></a><span class="sd">            Array representing the data.</span>
</span><span id="SelfTraining-112"><a href="#SelfTraining-112"><span class="linenos">112</span></a>
</span><span id="SelfTraining-113"><a href="#SelfTraining-113"><span class="linenos">113</span></a><span class="sd">        y : {array-like, sparse matrix} of shape (n_samples,)</span>
</span><span id="SelfTraining-114"><a href="#SelfTraining-114"><span class="linenos">114</span></a><span class="sd">            Array representing the labels. Unlabeled samples should have the</span>
</span><span id="SelfTraining-115"><a href="#SelfTraining-115"><span class="linenos">115</span></a><span class="sd">            label -1.</span>
</span><span id="SelfTraining-116"><a href="#SelfTraining-116"><span class="linenos">116</span></a>
</span><span id="SelfTraining-117"><a href="#SelfTraining-117"><span class="linenos">117</span></a><span class="sd">        Returns</span>
</span><span id="SelfTraining-118"><a href="#SelfTraining-118"><span class="linenos">118</span></a><span class="sd">        -------</span>
</span><span id="SelfTraining-119"><a href="#SelfTraining-119"><span class="linenos">119</span></a><span class="sd">        self : SelfTrainingClassifier</span>
</span><span id="SelfTraining-120"><a href="#SelfTraining-120"><span class="linenos">120</span></a><span class="sd">            Returns an instance of self.</span>
</span><span id="SelfTraining-121"><a href="#SelfTraining-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SelfTraining-122"><a href="#SelfTraining-122"><span class="linenos">122</span></a>        <span class="n">y_adapted</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SelfTraining-123"><a href="#SelfTraining-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">or</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">:</span>
</span><span id="SelfTraining-124"><a href="#SelfTraining-124"><span class="linenos">124</span></a>            <span class="n">y_adapted</span> <span class="o">=</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
</span><span id="SelfTraining-125"><a href="#SelfTraining-125"><span class="linenos">125</span></a>            <span class="n">y_adapted</span><span class="p">[</span><span class="n">y_adapted</span> <span class="o">==</span> <span class="s1">&#39;-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="SelfTraining-126"><a href="#SelfTraining-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_adapted</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h2 id="self-training-classifier-with-data-loader-compatible"><strong>Self Training Classifier with data loader compatible.</strong></h2>

<p>Is the same <code>SelfTrainingClassifier</code> from sklearn but with <code><a href="../sslearn.html">sslearn</a></code> data loader compatible.
For more information, see the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.semi_supervised.SelfTrainingClassifier.html">sklearn documentation</a>.</p>

<h2 id="example"><strong>Example</strong></h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn"><a href="model_selection.html">sslearn.model_selection</a></span> <span class="kn">import</span> <span class="n">artificial_ssl_dataset</span>
<span class="kn">from</span> <span class="nn"><a href="">sslearn.wrapper</a></span> <span class="kn">import</span> <span class="n">SelfTraining</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">artificial_ssl_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">SelfTraining</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="references"><strong>References</strong></h2>

<p>David Yarowsky. (1995). <br>
Unsupervised word sense disambiguation rivaling supervised methods.<br>
In <i>Proceedings of the 33rd annual meeting on Association for Computational Linguistics (ACL '95).</i><br>
Association for Computational Linguistics,<br>
Stroudsburg, PA, USA, 189-196. <br>
<a href="https://doi.org/10.3115/981658.981684">10.3115/981658.981684</a></p>
</div>


                            <div id="SelfTraining.__init__" class="classattr">
                                        <input id="SelfTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SelfTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span>,</span><span class="param">	<span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span>,</span><span class="param">	<span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;threshold&#39;</span>,</span><span class="param">	<span class="n">k_best</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="SelfTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SelfTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SelfTraining.__init__-52"><a href="#SelfTraining.__init__-52"><span class="linenos"> 52</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-53"><a href="#SelfTraining.__init__-53"><span class="linenos"> 53</span></a>                 <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-54"><a href="#SelfTraining.__init__-54"><span class="linenos"> 54</span></a>                 <span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-55"><a href="#SelfTraining.__init__-55"><span class="linenos"> 55</span></a>                 <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-56"><a href="#SelfTraining.__init__-56"><span class="linenos"> 56</span></a>                 <span class="n">k_best</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-57"><a href="#SelfTraining.__init__-57"><span class="linenos"> 57</span></a>                 <span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-58"><a href="#SelfTraining.__init__-58"><span class="linenos"> 58</span></a>                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="SelfTraining.__init__-59"><a href="#SelfTraining.__init__-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Self-training. Adaptation of SelfTrainingClassifier from sklearn with data loader compatible.</span>
</span><span id="SelfTraining.__init__-60"><a href="#SelfTraining.__init__-60"><span class="linenos"> 60</span></a>
</span><span id="SelfTraining.__init__-61"><a href="#SelfTraining.__init__-61"><span class="linenos"> 61</span></a><span class="sd">        This class allows a given supervised classifier to function as a</span>
</span><span id="SelfTraining.__init__-62"><a href="#SelfTraining.__init__-62"><span class="linenos"> 62</span></a><span class="sd">        semi-supervised classifier, allowing it to learn from unlabeled data. It</span>
</span><span id="SelfTraining.__init__-63"><a href="#SelfTraining.__init__-63"><span class="linenos"> 63</span></a><span class="sd">        does this by iteratively predicting pseudo-labels for the unlabeled data</span>
</span><span id="SelfTraining.__init__-64"><a href="#SelfTraining.__init__-64"><span class="linenos"> 64</span></a><span class="sd">        and adding them to the training set.</span>
</span><span id="SelfTraining.__init__-65"><a href="#SelfTraining.__init__-65"><span class="linenos"> 65</span></a>
</span><span id="SelfTraining.__init__-66"><a href="#SelfTraining.__init__-66"><span class="linenos"> 66</span></a><span class="sd">        The classifier will continue iterating until either max_iter is reached, or</span>
</span><span id="SelfTraining.__init__-67"><a href="#SelfTraining.__init__-67"><span class="linenos"> 67</span></a><span class="sd">        no pseudo-labels were added to the training set in the previous iteration.</span>
</span><span id="SelfTraining.__init__-68"><a href="#SelfTraining.__init__-68"><span class="linenos"> 68</span></a>
</span><span id="SelfTraining.__init__-69"><a href="#SelfTraining.__init__-69"><span class="linenos"> 69</span></a><span class="sd">        Parameters</span>
</span><span id="SelfTraining.__init__-70"><a href="#SelfTraining.__init__-70"><span class="linenos"> 70</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining.__init__-71"><a href="#SelfTraining.__init__-71"><span class="linenos"> 71</span></a><span class="sd">        base_estimator : estimator object</span>
</span><span id="SelfTraining.__init__-72"><a href="#SelfTraining.__init__-72"><span class="linenos"> 72</span></a><span class="sd">            An estimator object implementing ``fit`` and ``predict_proba``.</span>
</span><span id="SelfTraining.__init__-73"><a href="#SelfTraining.__init__-73"><span class="linenos"> 73</span></a><span class="sd">            Invoking the ``fit`` method will fit a clone of the passed estimator,</span>
</span><span id="SelfTraining.__init__-74"><a href="#SelfTraining.__init__-74"><span class="linenos"> 74</span></a><span class="sd">            which will be stored in the ``base_estimator_`` attribute.</span>
</span><span id="SelfTraining.__init__-75"><a href="#SelfTraining.__init__-75"><span class="linenos"> 75</span></a>
</span><span id="SelfTraining.__init__-76"><a href="#SelfTraining.__init__-76"><span class="linenos"> 76</span></a><span class="sd">        threshold : float, default=0.75</span>
</span><span id="SelfTraining.__init__-77"><a href="#SelfTraining.__init__-77"><span class="linenos"> 77</span></a><span class="sd">            The decision threshold for use with `criterion=&#39;threshold&#39;`.</span>
</span><span id="SelfTraining.__init__-78"><a href="#SelfTraining.__init__-78"><span class="linenos"> 78</span></a><span class="sd">            Should be in [0, 1). When using the &#39;threshold&#39; criterion, a</span>
</span><span id="SelfTraining.__init__-79"><a href="#SelfTraining.__init__-79"><span class="linenos"> 79</span></a><span class="sd">            :ref:`well calibrated classifier &lt;calibration&gt;` should be used.</span>
</span><span id="SelfTraining.__init__-80"><a href="#SelfTraining.__init__-80"><span class="linenos"> 80</span></a>
</span><span id="SelfTraining.__init__-81"><a href="#SelfTraining.__init__-81"><span class="linenos"> 81</span></a><span class="sd">        criterion : {&#39;threshold&#39;, &#39;k_best&#39;}, default=&#39;threshold&#39;</span>
</span><span id="SelfTraining.__init__-82"><a href="#SelfTraining.__init__-82"><span class="linenos"> 82</span></a><span class="sd">            The selection criterion used to select which labels to add to the</span>
</span><span id="SelfTraining.__init__-83"><a href="#SelfTraining.__init__-83"><span class="linenos"> 83</span></a><span class="sd">            training set. If &#39;threshold&#39;, pseudo-labels with prediction</span>
</span><span id="SelfTraining.__init__-84"><a href="#SelfTraining.__init__-84"><span class="linenos"> 84</span></a><span class="sd">            probabilities above `threshold` are added to the dataset. If &#39;k_best&#39;,</span>
</span><span id="SelfTraining.__init__-85"><a href="#SelfTraining.__init__-85"><span class="linenos"> 85</span></a><span class="sd">            the `k_best` pseudo-labels with highest prediction probabilities are</span>
</span><span id="SelfTraining.__init__-86"><a href="#SelfTraining.__init__-86"><span class="linenos"> 86</span></a><span class="sd">            added to the dataset. When using the &#39;threshold&#39; criterion, a</span>
</span><span id="SelfTraining.__init__-87"><a href="#SelfTraining.__init__-87"><span class="linenos"> 87</span></a><span class="sd">            :ref:`well calibrated classifier &lt;calibration&gt;` should be used.</span>
</span><span id="SelfTraining.__init__-88"><a href="#SelfTraining.__init__-88"><span class="linenos"> 88</span></a>
</span><span id="SelfTraining.__init__-89"><a href="#SelfTraining.__init__-89"><span class="linenos"> 89</span></a><span class="sd">        k_best : int, default=10</span>
</span><span id="SelfTraining.__init__-90"><a href="#SelfTraining.__init__-90"><span class="linenos"> 90</span></a><span class="sd">            The amount of samples to add in each iteration. Only used when</span>
</span><span id="SelfTraining.__init__-91"><a href="#SelfTraining.__init__-91"><span class="linenos"> 91</span></a><span class="sd">            `criterion` is k_best&#39;.</span>
</span><span id="SelfTraining.__init__-92"><a href="#SelfTraining.__init__-92"><span class="linenos"> 92</span></a>
</span><span id="SelfTraining.__init__-93"><a href="#SelfTraining.__init__-93"><span class="linenos"> 93</span></a><span class="sd">        max_iter : int or None, default=10</span>
</span><span id="SelfTraining.__init__-94"><a href="#SelfTraining.__init__-94"><span class="linenos"> 94</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal</span>
</span><span id="SelfTraining.__init__-95"><a href="#SelfTraining.__init__-95"><span class="linenos"> 95</span></a><span class="sd">            to 0. If it is ``None``, the classifier will continue to predict labels</span>
</span><span id="SelfTraining.__init__-96"><a href="#SelfTraining.__init__-96"><span class="linenos"> 96</span></a><span class="sd">            until no new pseudo-labels are added, or all unlabeled samples have</span>
</span><span id="SelfTraining.__init__-97"><a href="#SelfTraining.__init__-97"><span class="linenos"> 97</span></a><span class="sd">            been labeled.</span>
</span><span id="SelfTraining.__init__-98"><a href="#SelfTraining.__init__-98"><span class="linenos"> 98</span></a>
</span><span id="SelfTraining.__init__-99"><a href="#SelfTraining.__init__-99"><span class="linenos"> 99</span></a><span class="sd">        verbose : bool, default=False</span>
</span><span id="SelfTraining.__init__-100"><a href="#SelfTraining.__init__-100"><span class="linenos">100</span></a><span class="sd">            Enable verbose output.</span>
</span><span id="SelfTraining.__init__-101"><a href="#SelfTraining.__init__-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SelfTraining.__init__-102"><a href="#SelfTraining.__init__-102"><span class="linenos">102</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">k_best</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Self-training. Adaptation of SelfTrainingClassifier from sklearn with data loader compatible.</p>

<p>This class allows a given supervised classifier to function as a
semi-supervised classifier, allowing it to learn from unlabeled data. It
does this by iteratively predicting pseudo-labels for the unlabeled data
and adding them to the training set.</p>

<p>The classifier will continue iterating until either max_iter is reached, or
no pseudo-labels were added to the training set in the previous iteration.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (estimator object):
An estimator object implementing <code><a href="#SelfTraining.fit">fit</a></code> and <code><a href="#SelfTraining.predict_proba">predict_proba</a></code>.
Invoking the <code><a href="#SelfTraining.fit">fit</a></code> method will fit a clone of the passed estimator,
which will be stored in the <code>base_estimator_</code> attribute.</li>
<li><strong>threshold</strong> (float, default=0.75):
The decision threshold for use with <code>criterion='threshold'</code>.
Should be in [0, 1). When using the 'threshold' criterion, a
:ref:<code>well calibrated classifier &lt;calibration&gt;</code> should be used.</li>
<li><strong>criterion</strong> ({'threshold', 'k_best'}, default='threshold'):
The selection criterion used to select which labels to add to the
training set. If 'threshold', pseudo-labels with prediction
probabilities above <code>threshold</code> are added to the dataset. If 'k_best',
the <code>k_best</code> pseudo-labels with highest prediction probabilities are
added to the dataset. When using the 'threshold' criterion, a
:ref:<code>well calibrated classifier &lt;calibration&gt;</code> should be used.</li>
<li><strong>k_best</strong> (int, default=10):
The amount of samples to add in each iteration. Only used when
<code>criterion</code> is k_best'.</li>
<li><strong>max_iter</strong> (int or None, default=10):
Maximum number of iterations allowed. Should be greater than or equal
to 0. If it is <code>None</code>, the classifier will continue to predict labels
until no new pseudo-labels are added, or all unlabeled samples have
been labeled.</li>
<li><strong>verbose</strong> (bool, default=False):
Enable verbose output.</li>
</ul>
</div>


                            </div>
                            <div id="SelfTraining.fit" class="classattr">
                                        <input id="SelfTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SelfTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SelfTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SelfTraining.fit-104"><a href="#SelfTraining.fit-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="SelfTraining.fit-105"><a href="#SelfTraining.fit-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SelfTraining.fit-106"><a href="#SelfTraining.fit-106"><span class="linenos">106</span></a><span class="sd">        Fits this ``SelfTrainingClassifier`` to a dataset.</span>
</span><span id="SelfTraining.fit-107"><a href="#SelfTraining.fit-107"><span class="linenos">107</span></a>
</span><span id="SelfTraining.fit-108"><a href="#SelfTraining.fit-108"><span class="linenos">108</span></a><span class="sd">        Parameters</span>
</span><span id="SelfTraining.fit-109"><a href="#SelfTraining.fit-109"><span class="linenos">109</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining.fit-110"><a href="#SelfTraining.fit-110"><span class="linenos">110</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="SelfTraining.fit-111"><a href="#SelfTraining.fit-111"><span class="linenos">111</span></a><span class="sd">            Array representing the data.</span>
</span><span id="SelfTraining.fit-112"><a href="#SelfTraining.fit-112"><span class="linenos">112</span></a>
</span><span id="SelfTraining.fit-113"><a href="#SelfTraining.fit-113"><span class="linenos">113</span></a><span class="sd">        y : {array-like, sparse matrix} of shape (n_samples,)</span>
</span><span id="SelfTraining.fit-114"><a href="#SelfTraining.fit-114"><span class="linenos">114</span></a><span class="sd">            Array representing the labels. Unlabeled samples should have the</span>
</span><span id="SelfTraining.fit-115"><a href="#SelfTraining.fit-115"><span class="linenos">115</span></a><span class="sd">            label -1.</span>
</span><span id="SelfTraining.fit-116"><a href="#SelfTraining.fit-116"><span class="linenos">116</span></a>
</span><span id="SelfTraining.fit-117"><a href="#SelfTraining.fit-117"><span class="linenos">117</span></a><span class="sd">        Returns</span>
</span><span id="SelfTraining.fit-118"><a href="#SelfTraining.fit-118"><span class="linenos">118</span></a><span class="sd">        -------</span>
</span><span id="SelfTraining.fit-119"><a href="#SelfTraining.fit-119"><span class="linenos">119</span></a><span class="sd">        self : SelfTrainingClassifier</span>
</span><span id="SelfTraining.fit-120"><a href="#SelfTraining.fit-120"><span class="linenos">120</span></a><span class="sd">            Returns an instance of self.</span>
</span><span id="SelfTraining.fit-121"><a href="#SelfTraining.fit-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SelfTraining.fit-122"><a href="#SelfTraining.fit-122"><span class="linenos">122</span></a>        <span class="n">y_adapted</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SelfTraining.fit-123"><a href="#SelfTraining.fit-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">or</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">:</span>
</span><span id="SelfTraining.fit-124"><a href="#SelfTraining.fit-124"><span class="linenos">124</span></a>            <span class="n">y_adapted</span> <span class="o">=</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
</span><span id="SelfTraining.fit-125"><a href="#SelfTraining.fit-125"><span class="linenos">125</span></a>            <span class="n">y_adapted</span><span class="p">[</span><span class="n">y_adapted</span> <span class="o">==</span> <span class="s1">&#39;-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="SelfTraining.fit-126"><a href="#SelfTraining.fit-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_adapted</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fits this <code>SelfTrainingClassifier</code> to a dataset.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
<li><strong>y</strong> ({array-like, sparse matrix} of shape (n_samples,)):
Array representing the labels. Unlabeled samples should have the
label -1.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (SelfTrainingClassifier):
Returns an instance of self.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.semi_supervised._self_training.SelfTrainingClassifier</dt>
                                <dd id="SelfTraining.predict" class="function">predict</dd>
                <dd id="SelfTraining.predict_proba" class="function">predict_proba</dd>
                <dd id="SelfTraining.decision_function" class="function">decision_function</dd>
                <dd id="SelfTraining.predict_log_proba" class="function">predict_log_proba</dd>
                <dd id="SelfTraining.score" class="function">score</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="SelfTraining.get_params" class="function">get_params</dd>
                <dd id="SelfTraining.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Setred">
                            <input id="Setred-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Setred</span><wbr>(<span class="base">sklearn.base.BaseEstimator</span>, <span class="base">sklearn.base.MetaEstimatorMixin</span>):

                <label class="view-source-button" for="Setred-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred-129"><a href="#Setred-129"><span class="linenos">129</span></a><span class="k">class</span> <span class="nc">Setred</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">MetaEstimatorMixin</span><span class="p">):</span>
</span><span id="Setred-130"><a href="#Setred-130"><span class="linenos">130</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Setred-131"><a href="#Setred-131"><span class="linenos">131</span></a><span class="sd">    **Self-training with Editing.**</span>
</span><span id="Setred-132"><a href="#Setred-132"><span class="linenos">132</span></a><span class="sd">    ----------------------------</span>
</span><span id="Setred-133"><a href="#Setred-133"><span class="linenos">133</span></a>
</span><span id="Setred-134"><a href="#Setred-134"><span class="linenos">134</span></a><span class="sd">    Create a SETRED classifier. It is a self-training algorithm that uses a rejection mechanism to avoid adding noisy samples to the training set.</span>
</span><span id="Setred-135"><a href="#Setred-135"><span class="linenos">135</span></a><span class="sd">    The main process are:</span>
</span><span id="Setred-136"><a href="#Setred-136"><span class="linenos">136</span></a><span class="sd">    1. Train a classifier with the labeled data.</span>
</span><span id="Setred-137"><a href="#Setred-137"><span class="linenos">137</span></a><span class="sd">    2. Create a pool of unlabeled data and select the most confident predictions.</span>
</span><span id="Setred-138"><a href="#Setred-138"><span class="linenos">138</span></a><span class="sd">    3. Repeat until the maximum number of iterations is reached:</span>
</span><span id="Setred-139"><a href="#Setred-139"><span class="linenos">139</span></a><span class="sd">        a. Select the most confident predictions from the unlabeled data.</span>
</span><span id="Setred-140"><a href="#Setred-140"><span class="linenos">140</span></a><span class="sd">        b. Calculate the neighborhood graph of the labeled data and the selected instances from the unlabeled data.</span>
</span><span id="Setred-141"><a href="#Setred-141"><span class="linenos">141</span></a><span class="sd">        c. Calculate the significance level of the selected instances.</span>
</span><span id="Setred-142"><a href="#Setred-142"><span class="linenos">142</span></a><span class="sd">        d. Reject the instances that are not significant according their position in the neighborhood graph.</span>
</span><span id="Setred-143"><a href="#Setred-143"><span class="linenos">143</span></a><span class="sd">        e. Add the selected instances to the labeled data and retrains the classifier.</span>
</span><span id="Setred-144"><a href="#Setred-144"><span class="linenos">144</span></a><span class="sd">        f. Add new instances to the pool of unlabeled data.</span>
</span><span id="Setred-145"><a href="#Setred-145"><span class="linenos">145</span></a><span class="sd">    4. Return the classifier trained with the labeled data.</span>
</span><span id="Setred-146"><a href="#Setred-146"><span class="linenos">146</span></a>
</span><span id="Setred-147"><a href="#Setred-147"><span class="linenos">147</span></a><span class="sd">    **Example**</span>
</span><span id="Setred-148"><a href="#Setred-148"><span class="linenos">148</span></a><span class="sd">    -----------</span>
</span><span id="Setred-149"><a href="#Setred-149"><span class="linenos">149</span></a><span class="sd">    ```python</span>
</span><span id="Setred-150"><a href="#Setred-150"><span class="linenos">150</span></a><span class="sd">    from sklearn.datasets import load_iris</span>
</span><span id="Setred-151"><a href="#Setred-151"><span class="linenos">151</span></a><span class="sd">    from sslearn.model_selection import artificial_ssl_dataset</span>
</span><span id="Setred-152"><a href="#Setred-152"><span class="linenos">152</span></a><span class="sd">    from sslearn.wrapper import Setred</span>
</span><span id="Setred-153"><a href="#Setred-153"><span class="linenos">153</span></a>
</span><span id="Setred-154"><a href="#Setred-154"><span class="linenos">154</span></a><span class="sd">    X, y = load_iris(return_X_y=True)</span>
</span><span id="Setred-155"><a href="#Setred-155"><span class="linenos">155</span></a><span class="sd">    X, y, X_unlabel, y_unlabel, _, _ = artificial_ssl_dataset(X, y, label_rate=0.1, random_state=0)</span>
</span><span id="Setred-156"><a href="#Setred-156"><span class="linenos">156</span></a>
</span><span id="Setred-157"><a href="#Setred-157"><span class="linenos">157</span></a><span class="sd">    clf = Setred()</span>
</span><span id="Setred-158"><a href="#Setred-158"><span class="linenos">158</span></a><span class="sd">    clf.fit(X, y)</span>
</span><span id="Setred-159"><a href="#Setred-159"><span class="linenos">159</span></a><span class="sd">    clf.score(X_unlabel, y_unlabel)</span>
</span><span id="Setred-160"><a href="#Setred-160"><span class="linenos">160</span></a><span class="sd">    ```</span>
</span><span id="Setred-161"><a href="#Setred-161"><span class="linenos">161</span></a>
</span><span id="Setred-162"><a href="#Setred-162"><span class="linenos">162</span></a><span class="sd">    **References**</span>
</span><span id="Setred-163"><a href="#Setred-163"><span class="linenos">163</span></a><span class="sd">    ----------</span>
</span><span id="Setred-164"><a href="#Setred-164"><span class="linenos">164</span></a><span class="sd">    Li, Ming, and Zhi-Hua Zhou. (2005)&lt;br&gt;</span>
</span><span id="Setred-165"><a href="#Setred-165"><span class="linenos">165</span></a><span class="sd">    SETRED: Self-training with editing,&lt;br&gt;</span>
</span><span id="Setred-166"><a href="#Setred-166"><span class="linenos">166</span></a><span class="sd">    in &lt;i&gt;Advances in Knowledge Discovery and Data Mining.&lt;/i&gt; &lt;br&gt;</span>
</span><span id="Setred-167"><a href="#Setred-167"><span class="linenos">167</span></a><span class="sd">    Pacific-Asia Conference on Knowledge Discovery and Data Mining &lt;br&gt;</span>
</span><span id="Setred-168"><a href="#Setred-168"><span class="linenos">168</span></a><span class="sd">    LNAI 3518, Springer, Berlin, Heidelberg, &lt;br&gt;</span>
</span><span id="Setred-169"><a href="#Setred-169"><span class="linenos">169</span></a><span class="sd">    [10.1007/11430919_71](https://doi.org/10.1007/11430919_71)</span>
</span><span id="Setred-170"><a href="#Setred-170"><span class="linenos">170</span></a>
</span><span id="Setred-171"><a href="#Setred-171"><span class="linenos">171</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Setred-172"><a href="#Setred-172"><span class="linenos">172</span></a>
</span><span id="Setred-173"><a href="#Setred-173"><span class="linenos">173</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Setred-174"><a href="#Setred-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Setred-175"><a href="#Setred-175"><span class="linenos">175</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
</span><span id="Setred-176"><a href="#Setred-176"><span class="linenos">176</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
</span><span id="Setred-177"><a href="#Setred-177"><span class="linenos">177</span></a>        <span class="n">distance</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span>
</span><span id="Setred-178"><a href="#Setred-178"><span class="linenos">178</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="Setred-179"><a href="#Setred-179"><span class="linenos">179</span></a>        <span class="n">rejection_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
</span><span id="Setred-180"><a href="#Setred-180"><span class="linenos">180</span></a>        <span class="n">graph_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Setred-181"><a href="#Setred-181"><span class="linenos">181</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Setred-182"><a href="#Setred-182"><span class="linenos">182</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Setred-183"><a href="#Setred-183"><span class="linenos">183</span></a>    <span class="p">):</span>
</span><span id="Setred-184"><a href="#Setred-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Setred-185"><a href="#Setred-185"><span class="linenos">185</span></a><span class="sd">        Create a SETRED classifier.</span>
</span><span id="Setred-186"><a href="#Setred-186"><span class="linenos">186</span></a><span class="sd">        It is a self-training algorithm that uses a rejection mechanism to avoid adding noisy samples to the training set.</span>
</span><span id="Setred-187"><a href="#Setred-187"><span class="linenos">187</span></a><span class="sd">        </span>
</span><span id="Setred-188"><a href="#Setred-188"><span class="linenos">188</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-189"><a href="#Setred-189"><span class="linenos">189</span></a><span class="sd">        ----------</span>
</span><span id="Setred-190"><a href="#Setred-190"><span class="linenos">190</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="Setred-191"><a href="#Setred-191"><span class="linenos">191</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default KNeighborsClassifier(n_neighbors=3)</span>
</span><span id="Setred-192"><a href="#Setred-192"><span class="linenos">192</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="Setred-193"><a href="#Setred-193"><span class="linenos">193</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0., by default 40</span>
</span><span id="Setred-194"><a href="#Setred-194"><span class="linenos">194</span></a><span class="sd">        distance : str, optional</span>
</span><span id="Setred-195"><a href="#Setred-195"><span class="linenos">195</span></a><span class="sd">            The distance metric to use for the graph.</span>
</span><span id="Setred-196"><a href="#Setred-196"><span class="linenos">196</span></a><span class="sd">            The default metric is euclidean, and with p=2 is equivalent to the standard Euclidean metric.</span>
</span><span id="Setred-197"><a href="#Setred-197"><span class="linenos">197</span></a><span class="sd">            For a list of available metrics, see the documentation of DistanceMetric and the metrics listed in sklearn.metrics.pairwise.PAIRWISE_DISTANCE_FUNCTIONS.</span>
</span><span id="Setred-198"><a href="#Setred-198"><span class="linenos">198</span></a><span class="sd">            Note that the `cosine` metric uses cosine_distances., by default `euclidean`</span>
</span><span id="Setred-199"><a href="#Setred-199"><span class="linenos">199</span></a><span class="sd">        poolsize : float, optional</span>
</span><span id="Setred-200"><a href="#Setred-200"><span class="linenos">200</span></a><span class="sd">            Max number of unlabel instances candidates to pseudolabel, by default 0.25</span>
</span><span id="Setred-201"><a href="#Setred-201"><span class="linenos">201</span></a><span class="sd">        rejection_threshold : float, optional</span>
</span><span id="Setred-202"><a href="#Setred-202"><span class="linenos">202</span></a><span class="sd">            significance level, by default 0.05</span>
</span><span id="Setred-203"><a href="#Setred-203"><span class="linenos">203</span></a><span class="sd">        graph_neighbors : int, optional</span>
</span><span id="Setred-204"><a href="#Setred-204"><span class="linenos">204</span></a><span class="sd">            Number of neighbors for each sample., by default 1</span>
</span><span id="Setred-205"><a href="#Setred-205"><span class="linenos">205</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="Setred-206"><a href="#Setred-206"><span class="linenos">206</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="Setred-207"><a href="#Setred-207"><span class="linenos">207</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="Setred-208"><a href="#Setred-208"><span class="linenos">208</span></a><span class="sd">            The number of parallel jobs to run for neighbors search. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors, by default None</span>
</span><span id="Setred-209"><a href="#Setred-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred-210"><a href="#Setred-210"><span class="linenos">210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">can_be_list</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Setred-211"><a href="#Setred-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="Setred-212"><a href="#Setred-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="Setred-213"><a href="#Setred-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span>
</span><span id="Setred-214"><a href="#Setred-214"><span class="linenos">214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rejection_threshold</span> <span class="o">=</span> <span class="n">rejection_threshold</span>
</span><span id="Setred-215"><a href="#Setred-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph_neighbors</span> <span class="o">=</span> <span class="n">graph_neighbors</span>
</span><span id="Setred-216"><a href="#Setred-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="Setred-217"><a href="#Setred-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="Setred-218"><a href="#Setred-218"><span class="linenos">218</span></a>
</span><span id="Setred-219"><a href="#Setred-219"><span class="linenos">219</span></a>    <span class="k">def</span> <span class="nf">__create_neighborhood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="Setred-220"><a href="#Setred-220"><span class="linenos">220</span></a>        <span class="c1"># kneighbors_graph(X, 1, metric=self.distance, n_jobs=self.n_jobs).toarray()</span>
</span><span id="Setred-221"><a href="#Setred-221"><span class="linenos">221</span></a>        <span class="k">return</span> <span class="n">kneighbors_graph</span><span class="p">(</span>
</span><span id="Setred-222"><a href="#Setred-222"><span class="linenos">222</span></a>            <span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_neighbors</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">distance</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span>
</span><span id="Setred-223"><a href="#Setred-223"><span class="linenos">223</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
</span><span id="Setred-224"><a href="#Setred-224"><span class="linenos">224</span></a>
</span><span id="Setred-225"><a href="#Setred-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwars</span><span class="p">):</span>
</span><span id="Setred-226"><a href="#Setred-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a Setred classifier from the training set (X, y).</span>
</span><span id="Setred-227"><a href="#Setred-227"><span class="linenos">227</span></a>
</span><span id="Setred-228"><a href="#Setred-228"><span class="linenos">228</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-229"><a href="#Setred-229"><span class="linenos">229</span></a><span class="sd">        ----------</span>
</span><span id="Setred-230"><a href="#Setred-230"><span class="linenos">230</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred-231"><a href="#Setred-231"><span class="linenos">231</span></a><span class="sd">            The training input samples.</span>
</span><span id="Setred-232"><a href="#Setred-232"><span class="linenos">232</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Setred-233"><a href="#Setred-233"><span class="linenos">233</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="Setred-234"><a href="#Setred-234"><span class="linenos">234</span></a>
</span><span id="Setred-235"><a href="#Setred-235"><span class="linenos">235</span></a><span class="sd">        Returns</span>
</span><span id="Setred-236"><a href="#Setred-236"><span class="linenos">236</span></a><span class="sd">        -------</span>
</span><span id="Setred-237"><a href="#Setred-237"><span class="linenos">237</span></a><span class="sd">        self: Setred</span>
</span><span id="Setred-238"><a href="#Setred-238"><span class="linenos">238</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="Setred-239"><a href="#Setred-239"><span class="linenos">239</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="Setred-240"><a href="#Setred-240"><span class="linenos">240</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Setred-241"><a href="#Setred-241"><span class="linenos">241</span></a>
</span><span id="Setred-242"><a href="#Setred-242"><span class="linenos">242</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Setred-243"><a href="#Setred-243"><span class="linenos">243</span></a>
</span><span id="Setred-244"><a href="#Setred-244"><span class="linenos">244</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="Setred-245"><a href="#Setred-245"><span class="linenos">245</span></a>
</span><span id="Setred-246"><a href="#Setred-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Setred-247"><a href="#Setred-247"><span class="linenos">247</span></a>
</span><span id="Setred-248"><a href="#Setred-248"><span class="linenos">248</span></a>        <span class="n">each_iteration_candidates</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Setred-249"><a href="#Setred-249"><span class="linenos">249</span></a>
</span><span id="Setred-250"><a href="#Setred-250"><span class="linenos">250</span></a>        <span class="n">pool</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">)</span>
</span><span id="Setred-251"><a href="#Setred-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="Setred-252"><a href="#Setred-252"><span class="linenos">252</span></a>
</span><span id="Setred-253"><a href="#Setred-253"><span class="linenos">253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwars</span><span class="p">)</span>
</span><span id="Setred-254"><a href="#Setred-254"><span class="linenos">254</span></a>
</span><span id="Setred-255"><a href="#Setred-255"><span class="linenos">255</span></a>        <span class="n">y_probabilities</span> <span class="o">=</span> <span class="n">calculate_prior_probability</span><span class="p">(</span>
</span><span id="Setred-256"><a href="#Setred-256"><span class="linenos">256</span></a>            <span class="n">y_label</span>
</span><span id="Setred-257"><a href="#Setred-257"><span class="linenos">257</span></a>        <span class="p">)</span>  <span class="c1"># Should probabilities change every iteration or may it keep with the first L?</span>
</span><span id="Setred-258"><a href="#Setred-258"><span class="linenos">258</span></a>
</span><span id="Setred-259"><a href="#Setred-259"><span class="linenos">259</span></a>        <span class="n">sort_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Setred-260"><a href="#Setred-260"><span class="linenos">260</span></a>
</span><span id="Setred-261"><a href="#Setred-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Setred-262"><a href="#Setred-262"><span class="linenos">262</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Setred-263"><a href="#Setred-263"><span class="linenos">263</span></a>
</span><span id="Setred-264"><a href="#Setred-264"><span class="linenos">264</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">):</span>
</span><span id="Setred-265"><a href="#Setred-265"><span class="linenos">265</span></a>            <span class="n">U_</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="Setred-266"><a href="#Setred-266"><span class="linenos">266</span></a>                <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">pool</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
</span><span id="Setred-267"><a href="#Setred-267"><span class="linenos">267</span></a>            <span class="p">)</span>
</span><span id="Setred-268"><a href="#Setred-268"><span class="linenos">268</span></a>
</span><span id="Setred-269"><a href="#Setred-269"><span class="linenos">269</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-270"><a href="#Setred-270"><span class="linenos">270</span></a>                <span class="n">U_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">U_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Setred-271"><a href="#Setred-271"><span class="linenos">271</span></a>
</span><span id="Setred-272"><a href="#Setred-272"><span class="linenos">272</span></a>            <span class="n">raw_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">U_</span><span class="p">)</span>
</span><span id="Setred-273"><a href="#Setred-273"><span class="linenos">273</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-274"><a href="#Setred-274"><span class="linenos">274</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-275"><a href="#Setred-275"><span class="linenos">275</span></a>            <span class="c1"># Unless a better understanding is given, only the size of L will be used as maximal size of the candidate set.</span>
</span><span id="Setred-276"><a href="#Setred-276"><span class="linenos">276</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="n">each_iteration_candidates</span><span class="p">:]</span>
</span><span id="Setred-277"><a href="#Setred-277"><span class="linenos">277</span></a>
</span><span id="Setred-278"><a href="#Setred-278"><span class="linenos">278</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-279"><a href="#Setred-279"><span class="linenos">279</span></a>                <span class="n">L_</span> <span class="o">=</span> <span class="n">U_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
</span><span id="Setred-280"><a href="#Setred-280"><span class="linenos">280</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-281"><a href="#Setred-281"><span class="linenos">281</span></a>                <span class="n">L_</span> <span class="o">=</span> <span class="n">U_</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
</span><span id="Setred-282"><a href="#Setred-282"><span class="linenos">282</span></a>            <span class="n">y_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Setred-283"><a href="#Setred-283"><span class="linenos">283</span></a>                <span class="nb">list</span><span class="p">(</span>
</span><span id="Setred-284"><a href="#Setred-284"><span class="linenos">284</span></a>                    <span class="nb">map</span><span class="p">(</span>
</span><span id="Setred-285"><a href="#Setred-285"><span class="linenos">285</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">classes_</span><span class="p">[</span><span class="n">x</span><span class="p">],</span>
</span><span id="Setred-286"><a href="#Setred-286"><span class="linenos">286</span></a>                        <span class="n">class_predicted</span><span class="p">[</span><span class="n">indexes</span><span class="p">],</span>
</span><span id="Setred-287"><a href="#Setred-287"><span class="linenos">287</span></a>                    <span class="p">)</span>
</span><span id="Setred-288"><a href="#Setred-288"><span class="linenos">288</span></a>                <span class="p">)</span>
</span><span id="Setred-289"><a href="#Setred-289"><span class="linenos">289</span></a>            <span class="p">)</span>
</span><span id="Setred-290"><a href="#Setred-290"><span class="linenos">290</span></a>
</span><span id="Setred-291"><a href="#Setred-291"><span class="linenos">291</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-292"><a href="#Setred-292"><span class="linenos">292</span></a>                <span class="n">pre_L</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_</span><span class="p">])</span>
</span><span id="Setred-293"><a href="#Setred-293"><span class="linenos">293</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-294"><a href="#Setred-294"><span class="linenos">294</span></a>                <span class="n">pre_L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-295"><a href="#Setred-295"><span class="linenos">295</span></a>
</span><span id="Setred-296"><a href="#Setred-296"><span class="linenos">296</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_neighborhood</span><span class="p">(</span><span class="n">pre_L</span><span class="p">)</span>
</span><span id="Setred-297"><a href="#Setred-297"><span class="linenos">297</span></a>            <span class="c1">#  Keep only weights for L_</span>
</span><span id="Setred-298"><a href="#Setred-298"><span class="linenos">298</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="n">L_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:,</span> <span class="p">:]</span>
</span><span id="Setred-299"><a href="#Setred-299"><span class="linenos">299</span></a>
</span><span id="Setred-300"><a href="#Setred-300"><span class="linenos">300</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">y_</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="n">sort_idx</span><span class="p">)</span>
</span><span id="Setred-301"><a href="#Setred-301"><span class="linenos">301</span></a>            <span class="n">p_wrong</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">values</span><span class="p">())))[</span><span class="n">sort_idx</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Setred-302"><a href="#Setred-302"><span class="linenos">302</span></a>            <span class="c1">#  Must weights be the inverse of distance?</span>
</span><span id="Setred-303"><a href="#Setred-303"><span class="linenos">303</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">weights</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-304"><a href="#Setred-304"><span class="linenos">304</span></a>
</span><span id="Setred-305"><a href="#Setred-305"><span class="linenos">305</span></a>            <span class="n">weights_sum</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-306"><a href="#Setred-306"><span class="linenos">306</span></a>            <span class="n">weights_square_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-307"><a href="#Setred-307"><span class="linenos">307</span></a>
</span><span id="Setred-308"><a href="#Setred-308"><span class="linenos">308</span></a>            <span class="n">iid_random</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span>
</span><span id="Setred-309"><a href="#Setred-309"><span class="linenos">309</span></a>                <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">p_wrong</span><span class="p">,</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Setred-310"><a href="#Setred-310"><span class="linenos">310</span></a>            <span class="p">)</span>
</span><span id="Setred-311"><a href="#Setred-311"><span class="linenos">311</span></a>            <span class="n">ji</span> <span class="o">=</span> <span class="p">(</span><span class="n">iid_random</span> <span class="o">*</span> <span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-312"><a href="#Setred-312"><span class="linenos">312</span></a>
</span><span id="Setred-313"><a href="#Setred-313"><span class="linenos">313</span></a>            <span class="n">mu_h0</span> <span class="o">=</span> <span class="n">p_wrong</span> <span class="o">*</span> <span class="n">weights_sum</span>
</span><span id="Setred-314"><a href="#Setred-314"><span class="linenos">314</span></a>            <span class="n">sigma_h0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_wrong</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_wrong</span> <span class="o">*</span> <span class="n">weights_square_sum</span><span class="p">)</span>
</span><span id="Setred-315"><a href="#Setred-315"><span class="linenos">315</span></a>            
</span><span id="Setred-316"><a href="#Setred-316"><span class="linenos">316</span></a>            <span class="n">z_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">((</span><span class="n">ji</span> <span class="o">-</span> <span class="n">mu_h0</span><span class="p">),</span> <span class="n">sigma_h0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sigma_h0</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">sigma_h0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-317"><a href="#Setred-317"><span class="linenos">317</span></a>            <span class="c1"># z_score = (ji - mu_h0) / sigma_h0</span>
</span><span id="Setred-318"><a href="#Setred-318"><span class="linenos">318</span></a>            
</span><span id="Setred-319"><a href="#Setred-319"><span class="linenos">319</span></a>            <span class="n">oi</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z_score</span><span class="p">),</span> <span class="n">mu_h0</span><span class="p">,</span> <span class="n">sigma_h0</span><span class="p">)</span>
</span><span id="Setred-320"><a href="#Setred-320"><span class="linenos">320</span></a>            <span class="n">to_add</span> <span class="o">=</span> <span class="p">(</span><span class="n">oi</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rejection_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z_score</span> <span class="o">&lt;</span> <span class="n">mu_h0</span><span class="p">)</span>
</span><span id="Setred-321"><a href="#Setred-321"><span class="linenos">321</span></a>
</span><span id="Setred-322"><a href="#Setred-322"><span class="linenos">322</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-323"><a href="#Setred-323"><span class="linenos">323</span></a>                <span class="n">L_filtered</span> <span class="o">=</span> <span class="n">L_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Setred-324"><a href="#Setred-324"><span class="linenos">324</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-325"><a href="#Setred-325"><span class="linenos">325</span></a>                <span class="n">L_filtered</span> <span class="o">=</span> <span class="n">L_</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Setred-326"><a href="#Setred-326"><span class="linenos">326</span></a>            <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">y_</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="Setred-327"><a href="#Setred-327"><span class="linenos">327</span></a>            
</span><span id="Setred-328"><a href="#Setred-328"><span class="linenos">328</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-329"><a href="#Setred-329"><span class="linenos">329</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_filtered</span><span class="p">])</span>
</span><span id="Setred-330"><a href="#Setred-330"><span class="linenos">330</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-331"><a href="#Setred-331"><span class="linenos">331</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_filtered</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-332"><a href="#Setred-332"><span class="linenos">332</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">y_filtered</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-333"><a href="#Setred-333"><span class="linenos">333</span></a>
</span><span id="Setred-334"><a href="#Setred-334"><span class="linenos">334</span></a>            <span class="c1">#  Remove the instances from the unlabeled set.</span>
</span><span id="Setred-335"><a href="#Setred-335"><span class="linenos">335</span></a>            <span class="n">to_delete</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="Setred-336"><a href="#Setred-336"><span class="linenos">336</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-337"><a href="#Setred-337"><span class="linenos">337</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">to_delete</span><span class="p">])</span>
</span><span id="Setred-338"><a href="#Setred-338"><span class="linenos">338</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-339"><a href="#Setred-339"><span class="linenos">339</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-340"><a href="#Setred-340"><span class="linenos">340</span></a>
</span><span id="Setred-341"><a href="#Setred-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Setred-342"><a href="#Setred-342"><span class="linenos">342</span></a>
</span><span id="Setred-343"><a href="#Setred-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Setred-344"><a href="#Setred-344"><span class="linenos">344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class value for X.</span>
</span><span id="Setred-345"><a href="#Setred-345"><span class="linenos">345</span></a><span class="sd">        For a classification model, the predicted class for each sample in X is returned.</span>
</span><span id="Setred-346"><a href="#Setred-346"><span class="linenos">346</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-347"><a href="#Setred-347"><span class="linenos">347</span></a><span class="sd">        ----------</span>
</span><span id="Setred-348"><a href="#Setred-348"><span class="linenos">348</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred-349"><a href="#Setred-349"><span class="linenos">349</span></a><span class="sd">            The input samples.</span>
</span><span id="Setred-350"><a href="#Setred-350"><span class="linenos">350</span></a><span class="sd">        Returns</span>
</span><span id="Setred-351"><a href="#Setred-351"><span class="linenos">351</span></a><span class="sd">        -------</span>
</span><span id="Setred-352"><a href="#Setred-352"><span class="linenos">352</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Setred-353"><a href="#Setred-353"><span class="linenos">353</span></a><span class="sd">            The predicted classes</span>
</span><span id="Setred-354"><a href="#Setred-354"><span class="linenos">354</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred-355"><a href="#Setred-355"><span class="linenos">355</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Setred-356"><a href="#Setred-356"><span class="linenos">356</span></a>
</span><span id="Setred-357"><a href="#Setred-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Setred-358"><a href="#Setred-358"><span class="linenos">358</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class probabilities of the input samples X.</span>
</span><span id="Setred-359"><a href="#Setred-359"><span class="linenos">359</span></a><span class="sd">        The predicted class probability depends on the ensemble estimator.</span>
</span><span id="Setred-360"><a href="#Setred-360"><span class="linenos">360</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-361"><a href="#Setred-361"><span class="linenos">361</span></a><span class="sd">        ----------</span>
</span><span id="Setred-362"><a href="#Setred-362"><span class="linenos">362</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred-363"><a href="#Setred-363"><span class="linenos">363</span></a><span class="sd">            The input samples.</span>
</span><span id="Setred-364"><a href="#Setred-364"><span class="linenos">364</span></a><span class="sd">        Returns</span>
</span><span id="Setred-365"><a href="#Setred-365"><span class="linenos">365</span></a><span class="sd">        -------</span>
</span><span id="Setred-366"><a href="#Setred-366"><span class="linenos">366</span></a><span class="sd">        y : ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1</span>
</span><span id="Setred-367"><a href="#Setred-367"><span class="linenos">367</span></a><span class="sd">            The predicted classes</span>
</span><span id="Setred-368"><a href="#Setred-368"><span class="linenos">368</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred-369"><a href="#Setred-369"><span class="linenos">369</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Setred-370"><a href="#Setred-370"><span class="linenos">370</span></a>    
</span><span id="Setred-371"><a href="#Setred-371"><span class="linenos">371</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Setred-372"><a href="#Setred-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Setred-373"><a href="#Setred-373"><span class="linenos">373</span></a><span class="sd">        Return the mean accuracy on the given test data and labels.</span>
</span><span id="Setred-374"><a href="#Setred-374"><span class="linenos">374</span></a>
</span><span id="Setred-375"><a href="#Setred-375"><span class="linenos">375</span></a><span class="sd">        In multi-label classification, this is the subset accuracy</span>
</span><span id="Setred-376"><a href="#Setred-376"><span class="linenos">376</span></a><span class="sd">        which is a harsh metric since you require for each sample that</span>
</span><span id="Setred-377"><a href="#Setred-377"><span class="linenos">377</span></a><span class="sd">        each label set be correctly predicted.</span>
</span><span id="Setred-378"><a href="#Setred-378"><span class="linenos">378</span></a>
</span><span id="Setred-379"><a href="#Setred-379"><span class="linenos">379</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-380"><a href="#Setred-380"><span class="linenos">380</span></a><span class="sd">        ----------</span>
</span><span id="Setred-381"><a href="#Setred-381"><span class="linenos">381</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="Setred-382"><a href="#Setred-382"><span class="linenos">382</span></a><span class="sd">            Test samples.</span>
</span><span id="Setred-383"><a href="#Setred-383"><span class="linenos">383</span></a>
</span><span id="Setred-384"><a href="#Setred-384"><span class="linenos">384</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="Setred-385"><a href="#Setred-385"><span class="linenos">385</span></a><span class="sd">            True labels for `X`.</span>
</span><span id="Setred-386"><a href="#Setred-386"><span class="linenos">386</span></a>
</span><span id="Setred-387"><a href="#Setred-387"><span class="linenos">387</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), default=None</span>
</span><span id="Setred-388"><a href="#Setred-388"><span class="linenos">388</span></a><span class="sd">            Sample weights.</span>
</span><span id="Setred-389"><a href="#Setred-389"><span class="linenos">389</span></a>
</span><span id="Setred-390"><a href="#Setred-390"><span class="linenos">390</span></a><span class="sd">        Returns</span>
</span><span id="Setred-391"><a href="#Setred-391"><span class="linenos">391</span></a><span class="sd">        -------</span>
</span><span id="Setred-392"><a href="#Setred-392"><span class="linenos">392</span></a><span class="sd">        score : float</span>
</span><span id="Setred-393"><a href="#Setred-393"><span class="linenos">393</span></a><span class="sd">            Mean accuracy of ``self.predict(X)`` w.r.t. `y`.</span>
</span><span id="Setred-394"><a href="#Setred-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred-395"><a href="#Setred-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h2 id="self-training-with-editing"><strong>Self-training with Editing.</strong></h2>

<p>Create a SETRED classifier. It is a self-training algorithm that uses a rejection mechanism to avoid adding noisy samples to the training set.
The main process are:</p>

<ol>
<li>Train a classifier with the labeled data.</li>
<li>Create a pool of unlabeled data and select the most confident predictions.</li>
<li>Repeat until the maximum number of iterations is reached:
a. Select the most confident predictions from the unlabeled data.
b. Calculate the neighborhood graph of the labeled data and the selected instances from the unlabeled data.
c. Calculate the significance level of the selected instances.
d. Reject the instances that are not significant according their position in the neighborhood graph.
e. Add the selected instances to the labeled data and retrains the classifier.
f. Add new instances to the pool of unlabeled data.</li>
<li>Return the classifier trained with the labeled data.</li>
</ol>

<h2 id="example"><strong>Example</strong></h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn"><a href="model_selection.html">sslearn.model_selection</a></span> <span class="kn">import</span> <span class="n">artificial_ssl_dataset</span>
<span class="kn">from</span> <span class="nn"><a href="">sslearn.wrapper</a></span> <span class="kn">import</span> <span class="n">Setred</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">artificial_ssl_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">Setred</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="references"><strong>References</strong></h2>

<p>Li, Ming, and Zhi-Hua Zhou. (2005)<br>
SETRED: Self-training with editing,<br>
in <i>Advances in Knowledge Discovery and Data Mining.</i> <br>
Pacific-Asia Conference on Knowledge Discovery and Data Mining <br>
LNAI 3518, Springer, Berlin, Heidelberg, <br>
<a href="https://doi.org/10.1007/11430919_71">10.1007/11430919_71</a></p>
</div>


                            <div id="Setred.__init__" class="classattr">
                                        <input id="Setred.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Setred</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">40</span>,</span><span class="param">	<span class="n">distance</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span>,</span><span class="param">	<span class="n">poolsize</span><span class="o">=</span><span class="mf">0.25</span>,</span><span class="param">	<span class="n">rejection_threshold</span><span class="o">=</span><span class="mf">0.05</span>,</span><span class="param">	<span class="n">graph_neighbors</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Setred.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.__init__-173"><a href="#Setred.__init__-173"><span class="linenos">173</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Setred.__init__-174"><a href="#Setred.__init__-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Setred.__init__-175"><a href="#Setred.__init__-175"><span class="linenos">175</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
</span><span id="Setred.__init__-176"><a href="#Setred.__init__-176"><span class="linenos">176</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
</span><span id="Setred.__init__-177"><a href="#Setred.__init__-177"><span class="linenos">177</span></a>        <span class="n">distance</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span>
</span><span id="Setred.__init__-178"><a href="#Setred.__init__-178"><span class="linenos">178</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="Setred.__init__-179"><a href="#Setred.__init__-179"><span class="linenos">179</span></a>        <span class="n">rejection_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
</span><span id="Setred.__init__-180"><a href="#Setred.__init__-180"><span class="linenos">180</span></a>        <span class="n">graph_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Setred.__init__-181"><a href="#Setred.__init__-181"><span class="linenos">181</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Setred.__init__-182"><a href="#Setred.__init__-182"><span class="linenos">182</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Setred.__init__-183"><a href="#Setred.__init__-183"><span class="linenos">183</span></a>    <span class="p">):</span>
</span><span id="Setred.__init__-184"><a href="#Setred.__init__-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Setred.__init__-185"><a href="#Setred.__init__-185"><span class="linenos">185</span></a><span class="sd">        Create a SETRED classifier.</span>
</span><span id="Setred.__init__-186"><a href="#Setred.__init__-186"><span class="linenos">186</span></a><span class="sd">        It is a self-training algorithm that uses a rejection mechanism to avoid adding noisy samples to the training set.</span>
</span><span id="Setred.__init__-187"><a href="#Setred.__init__-187"><span class="linenos">187</span></a><span class="sd">        </span>
</span><span id="Setred.__init__-188"><a href="#Setred.__init__-188"><span class="linenos">188</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.__init__-189"><a href="#Setred.__init__-189"><span class="linenos">189</span></a><span class="sd">        ----------</span>
</span><span id="Setred.__init__-190"><a href="#Setred.__init__-190"><span class="linenos">190</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="Setred.__init__-191"><a href="#Setred.__init__-191"><span class="linenos">191</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default KNeighborsClassifier(n_neighbors=3)</span>
</span><span id="Setred.__init__-192"><a href="#Setred.__init__-192"><span class="linenos">192</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="Setred.__init__-193"><a href="#Setred.__init__-193"><span class="linenos">193</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0., by default 40</span>
</span><span id="Setred.__init__-194"><a href="#Setred.__init__-194"><span class="linenos">194</span></a><span class="sd">        distance : str, optional</span>
</span><span id="Setred.__init__-195"><a href="#Setred.__init__-195"><span class="linenos">195</span></a><span class="sd">            The distance metric to use for the graph.</span>
</span><span id="Setred.__init__-196"><a href="#Setred.__init__-196"><span class="linenos">196</span></a><span class="sd">            The default metric is euclidean, and with p=2 is equivalent to the standard Euclidean metric.</span>
</span><span id="Setred.__init__-197"><a href="#Setred.__init__-197"><span class="linenos">197</span></a><span class="sd">            For a list of available metrics, see the documentation of DistanceMetric and the metrics listed in sklearn.metrics.pairwise.PAIRWISE_DISTANCE_FUNCTIONS.</span>
</span><span id="Setred.__init__-198"><a href="#Setred.__init__-198"><span class="linenos">198</span></a><span class="sd">            Note that the `cosine` metric uses cosine_distances., by default `euclidean`</span>
</span><span id="Setred.__init__-199"><a href="#Setred.__init__-199"><span class="linenos">199</span></a><span class="sd">        poolsize : float, optional</span>
</span><span id="Setred.__init__-200"><a href="#Setred.__init__-200"><span class="linenos">200</span></a><span class="sd">            Max number of unlabel instances candidates to pseudolabel, by default 0.25</span>
</span><span id="Setred.__init__-201"><a href="#Setred.__init__-201"><span class="linenos">201</span></a><span class="sd">        rejection_threshold : float, optional</span>
</span><span id="Setred.__init__-202"><a href="#Setred.__init__-202"><span class="linenos">202</span></a><span class="sd">            significance level, by default 0.05</span>
</span><span id="Setred.__init__-203"><a href="#Setred.__init__-203"><span class="linenos">203</span></a><span class="sd">        graph_neighbors : int, optional</span>
</span><span id="Setred.__init__-204"><a href="#Setred.__init__-204"><span class="linenos">204</span></a><span class="sd">            Number of neighbors for each sample., by default 1</span>
</span><span id="Setred.__init__-205"><a href="#Setred.__init__-205"><span class="linenos">205</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="Setred.__init__-206"><a href="#Setred.__init__-206"><span class="linenos">206</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="Setred.__init__-207"><a href="#Setred.__init__-207"><span class="linenos">207</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="Setred.__init__-208"><a href="#Setred.__init__-208"><span class="linenos">208</span></a><span class="sd">            The number of parallel jobs to run for neighbors search. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors, by default None</span>
</span><span id="Setred.__init__-209"><a href="#Setred.__init__-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred.__init__-210"><a href="#Setred.__init__-210"><span class="linenos">210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">can_be_list</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Setred.__init__-211"><a href="#Setred.__init__-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="Setred.__init__-212"><a href="#Setred.__init__-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="Setred.__init__-213"><a href="#Setred.__init__-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span>
</span><span id="Setred.__init__-214"><a href="#Setred.__init__-214"><span class="linenos">214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rejection_threshold</span> <span class="o">=</span> <span class="n">rejection_threshold</span>
</span><span id="Setred.__init__-215"><a href="#Setred.__init__-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph_neighbors</span> <span class="o">=</span> <span class="n">graph_neighbors</span>
</span><span id="Setred.__init__-216"><a href="#Setred.__init__-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="Setred.__init__-217"><a href="#Setred.__init__-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span></pre></div>


            <div class="docstring"><p>Create a SETRED classifier.
It is a self-training algorithm that uses a rejection mechanism to avoid adding noisy samples to the training set.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default KNeighborsClassifier(n_neighbors=3)</li>
<li><strong>max_iterations</strong> (int, optional):
Maximum number of iterations allowed. Should be greater than or equal to 0., by default 40</li>
<li><strong>distance</strong> (str, optional):
The distance metric to use for the graph.
The default metric is euclidean, and with p=2 is equivalent to the standard Euclidean metric.
For a list of available metrics, see the documentation of DistanceMetric and the metrics listed in sklearn.metrics.pairwise.PAIRWISE_DISTANCE_FUNCTIONS.
Note that the <code>cosine</code> metric uses cosine_distances., by default <code>euclidean</code></li>
<li><strong>poolsize</strong> (float, optional):
Max number of unlabel instances candidates to pseudolabel, by default 0.25</li>
<li><strong>rejection_threshold</strong> (float, optional):
significance level, by default 0.05</li>
<li><strong>graph_neighbors</strong> (int, optional):
Number of neighbors for each sample., by default 1</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
<li><strong>n_jobs</strong> (int, optional):
The number of parallel jobs to run for neighbors search. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors, by default None</li>
</ul>
</div>


                            </div>
                            <div id="Setred.fit" class="classattr">
                                        <input id="Setred.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwars</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Setred.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.fit-225"><a href="#Setred.fit-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwars</span><span class="p">):</span>
</span><span id="Setred.fit-226"><a href="#Setred.fit-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a Setred classifier from the training set (X, y).</span>
</span><span id="Setred.fit-227"><a href="#Setred.fit-227"><span class="linenos">227</span></a>
</span><span id="Setred.fit-228"><a href="#Setred.fit-228"><span class="linenos">228</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.fit-229"><a href="#Setred.fit-229"><span class="linenos">229</span></a><span class="sd">        ----------</span>
</span><span id="Setred.fit-230"><a href="#Setred.fit-230"><span class="linenos">230</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred.fit-231"><a href="#Setred.fit-231"><span class="linenos">231</span></a><span class="sd">            The training input samples.</span>
</span><span id="Setred.fit-232"><a href="#Setred.fit-232"><span class="linenos">232</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Setred.fit-233"><a href="#Setred.fit-233"><span class="linenos">233</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="Setred.fit-234"><a href="#Setred.fit-234"><span class="linenos">234</span></a>
</span><span id="Setred.fit-235"><a href="#Setred.fit-235"><span class="linenos">235</span></a><span class="sd">        Returns</span>
</span><span id="Setred.fit-236"><a href="#Setred.fit-236"><span class="linenos">236</span></a><span class="sd">        -------</span>
</span><span id="Setred.fit-237"><a href="#Setred.fit-237"><span class="linenos">237</span></a><span class="sd">        self: Setred</span>
</span><span id="Setred.fit-238"><a href="#Setred.fit-238"><span class="linenos">238</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="Setred.fit-239"><a href="#Setred.fit-239"><span class="linenos">239</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="Setred.fit-240"><a href="#Setred.fit-240"><span class="linenos">240</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Setred.fit-241"><a href="#Setred.fit-241"><span class="linenos">241</span></a>
</span><span id="Setred.fit-242"><a href="#Setred.fit-242"><span class="linenos">242</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Setred.fit-243"><a href="#Setred.fit-243"><span class="linenos">243</span></a>
</span><span id="Setred.fit-244"><a href="#Setred.fit-244"><span class="linenos">244</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="Setred.fit-245"><a href="#Setred.fit-245"><span class="linenos">245</span></a>
</span><span id="Setred.fit-246"><a href="#Setred.fit-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Setred.fit-247"><a href="#Setred.fit-247"><span class="linenos">247</span></a>
</span><span id="Setred.fit-248"><a href="#Setred.fit-248"><span class="linenos">248</span></a>        <span class="n">each_iteration_candidates</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Setred.fit-249"><a href="#Setred.fit-249"><span class="linenos">249</span></a>
</span><span id="Setred.fit-250"><a href="#Setred.fit-250"><span class="linenos">250</span></a>        <span class="n">pool</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">)</span>
</span><span id="Setred.fit-251"><a href="#Setred.fit-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="Setred.fit-252"><a href="#Setred.fit-252"><span class="linenos">252</span></a>
</span><span id="Setred.fit-253"><a href="#Setred.fit-253"><span class="linenos">253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwars</span><span class="p">)</span>
</span><span id="Setred.fit-254"><a href="#Setred.fit-254"><span class="linenos">254</span></a>
</span><span id="Setred.fit-255"><a href="#Setred.fit-255"><span class="linenos">255</span></a>        <span class="n">y_probabilities</span> <span class="o">=</span> <span class="n">calculate_prior_probability</span><span class="p">(</span>
</span><span id="Setred.fit-256"><a href="#Setred.fit-256"><span class="linenos">256</span></a>            <span class="n">y_label</span>
</span><span id="Setred.fit-257"><a href="#Setred.fit-257"><span class="linenos">257</span></a>        <span class="p">)</span>  <span class="c1"># Should probabilities change every iteration or may it keep with the first L?</span>
</span><span id="Setred.fit-258"><a href="#Setred.fit-258"><span class="linenos">258</span></a>
</span><span id="Setred.fit-259"><a href="#Setred.fit-259"><span class="linenos">259</span></a>        <span class="n">sort_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Setred.fit-260"><a href="#Setred.fit-260"><span class="linenos">260</span></a>
</span><span id="Setred.fit-261"><a href="#Setred.fit-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Setred.fit-262"><a href="#Setred.fit-262"><span class="linenos">262</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Setred.fit-263"><a href="#Setred.fit-263"><span class="linenos">263</span></a>
</span><span id="Setred.fit-264"><a href="#Setred.fit-264"><span class="linenos">264</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">):</span>
</span><span id="Setred.fit-265"><a href="#Setred.fit-265"><span class="linenos">265</span></a>            <span class="n">U_</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="Setred.fit-266"><a href="#Setred.fit-266"><span class="linenos">266</span></a>                <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">pool</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
</span><span id="Setred.fit-267"><a href="#Setred.fit-267"><span class="linenos">267</span></a>            <span class="p">)</span>
</span><span id="Setred.fit-268"><a href="#Setred.fit-268"><span class="linenos">268</span></a>
</span><span id="Setred.fit-269"><a href="#Setred.fit-269"><span class="linenos">269</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-270"><a href="#Setred.fit-270"><span class="linenos">270</span></a>                <span class="n">U_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">U_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Setred.fit-271"><a href="#Setred.fit-271"><span class="linenos">271</span></a>
</span><span id="Setred.fit-272"><a href="#Setred.fit-272"><span class="linenos">272</span></a>            <span class="n">raw_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">U_</span><span class="p">)</span>
</span><span id="Setred.fit-273"><a href="#Setred.fit-273"><span class="linenos">273</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-274"><a href="#Setred.fit-274"><span class="linenos">274</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-275"><a href="#Setred.fit-275"><span class="linenos">275</span></a>            <span class="c1"># Unless a better understanding is given, only the size of L will be used as maximal size of the candidate set.</span>
</span><span id="Setred.fit-276"><a href="#Setred.fit-276"><span class="linenos">276</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="n">each_iteration_candidates</span><span class="p">:]</span>
</span><span id="Setred.fit-277"><a href="#Setred.fit-277"><span class="linenos">277</span></a>
</span><span id="Setred.fit-278"><a href="#Setred.fit-278"><span class="linenos">278</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-279"><a href="#Setred.fit-279"><span class="linenos">279</span></a>                <span class="n">L_</span> <span class="o">=</span> <span class="n">U_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
</span><span id="Setred.fit-280"><a href="#Setred.fit-280"><span class="linenos">280</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-281"><a href="#Setred.fit-281"><span class="linenos">281</span></a>                <span class="n">L_</span> <span class="o">=</span> <span class="n">U_</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
</span><span id="Setred.fit-282"><a href="#Setred.fit-282"><span class="linenos">282</span></a>            <span class="n">y_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Setred.fit-283"><a href="#Setred.fit-283"><span class="linenos">283</span></a>                <span class="nb">list</span><span class="p">(</span>
</span><span id="Setred.fit-284"><a href="#Setred.fit-284"><span class="linenos">284</span></a>                    <span class="nb">map</span><span class="p">(</span>
</span><span id="Setred.fit-285"><a href="#Setred.fit-285"><span class="linenos">285</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">classes_</span><span class="p">[</span><span class="n">x</span><span class="p">],</span>
</span><span id="Setred.fit-286"><a href="#Setred.fit-286"><span class="linenos">286</span></a>                        <span class="n">class_predicted</span><span class="p">[</span><span class="n">indexes</span><span class="p">],</span>
</span><span id="Setred.fit-287"><a href="#Setred.fit-287"><span class="linenos">287</span></a>                    <span class="p">)</span>
</span><span id="Setred.fit-288"><a href="#Setred.fit-288"><span class="linenos">288</span></a>                <span class="p">)</span>
</span><span id="Setred.fit-289"><a href="#Setred.fit-289"><span class="linenos">289</span></a>            <span class="p">)</span>
</span><span id="Setred.fit-290"><a href="#Setred.fit-290"><span class="linenos">290</span></a>
</span><span id="Setred.fit-291"><a href="#Setred.fit-291"><span class="linenos">291</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-292"><a href="#Setred.fit-292"><span class="linenos">292</span></a>                <span class="n">pre_L</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_</span><span class="p">])</span>
</span><span id="Setred.fit-293"><a href="#Setred.fit-293"><span class="linenos">293</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-294"><a href="#Setred.fit-294"><span class="linenos">294</span></a>                <span class="n">pre_L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-295"><a href="#Setred.fit-295"><span class="linenos">295</span></a>
</span><span id="Setred.fit-296"><a href="#Setred.fit-296"><span class="linenos">296</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_neighborhood</span><span class="p">(</span><span class="n">pre_L</span><span class="p">)</span>
</span><span id="Setred.fit-297"><a href="#Setred.fit-297"><span class="linenos">297</span></a>            <span class="c1">#  Keep only weights for L_</span>
</span><span id="Setred.fit-298"><a href="#Setred.fit-298"><span class="linenos">298</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="n">L_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:,</span> <span class="p">:]</span>
</span><span id="Setred.fit-299"><a href="#Setred.fit-299"><span class="linenos">299</span></a>
</span><span id="Setred.fit-300"><a href="#Setred.fit-300"><span class="linenos">300</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">y_</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="n">sort_idx</span><span class="p">)</span>
</span><span id="Setred.fit-301"><a href="#Setred.fit-301"><span class="linenos">301</span></a>            <span class="n">p_wrong</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">values</span><span class="p">())))[</span><span class="n">sort_idx</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Setred.fit-302"><a href="#Setred.fit-302"><span class="linenos">302</span></a>            <span class="c1">#  Must weights be the inverse of distance?</span>
</span><span id="Setred.fit-303"><a href="#Setred.fit-303"><span class="linenos">303</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">weights</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-304"><a href="#Setred.fit-304"><span class="linenos">304</span></a>
</span><span id="Setred.fit-305"><a href="#Setred.fit-305"><span class="linenos">305</span></a>            <span class="n">weights_sum</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-306"><a href="#Setred.fit-306"><span class="linenos">306</span></a>            <span class="n">weights_square_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-307"><a href="#Setred.fit-307"><span class="linenos">307</span></a>
</span><span id="Setred.fit-308"><a href="#Setred.fit-308"><span class="linenos">308</span></a>            <span class="n">iid_random</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span>
</span><span id="Setred.fit-309"><a href="#Setred.fit-309"><span class="linenos">309</span></a>                <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">p_wrong</span><span class="p">,</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Setred.fit-310"><a href="#Setred.fit-310"><span class="linenos">310</span></a>            <span class="p">)</span>
</span><span id="Setred.fit-311"><a href="#Setred.fit-311"><span class="linenos">311</span></a>            <span class="n">ji</span> <span class="o">=</span> <span class="p">(</span><span class="n">iid_random</span> <span class="o">*</span> <span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-312"><a href="#Setred.fit-312"><span class="linenos">312</span></a>
</span><span id="Setred.fit-313"><a href="#Setred.fit-313"><span class="linenos">313</span></a>            <span class="n">mu_h0</span> <span class="o">=</span> <span class="n">p_wrong</span> <span class="o">*</span> <span class="n">weights_sum</span>
</span><span id="Setred.fit-314"><a href="#Setred.fit-314"><span class="linenos">314</span></a>            <span class="n">sigma_h0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_wrong</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_wrong</span> <span class="o">*</span> <span class="n">weights_square_sum</span><span class="p">)</span>
</span><span id="Setred.fit-315"><a href="#Setred.fit-315"><span class="linenos">315</span></a>            
</span><span id="Setred.fit-316"><a href="#Setred.fit-316"><span class="linenos">316</span></a>            <span class="n">z_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">((</span><span class="n">ji</span> <span class="o">-</span> <span class="n">mu_h0</span><span class="p">),</span> <span class="n">sigma_h0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sigma_h0</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">sigma_h0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-317"><a href="#Setred.fit-317"><span class="linenos">317</span></a>            <span class="c1"># z_score = (ji - mu_h0) / sigma_h0</span>
</span><span id="Setred.fit-318"><a href="#Setred.fit-318"><span class="linenos">318</span></a>            
</span><span id="Setred.fit-319"><a href="#Setred.fit-319"><span class="linenos">319</span></a>            <span class="n">oi</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z_score</span><span class="p">),</span> <span class="n">mu_h0</span><span class="p">,</span> <span class="n">sigma_h0</span><span class="p">)</span>
</span><span id="Setred.fit-320"><a href="#Setred.fit-320"><span class="linenos">320</span></a>            <span class="n">to_add</span> <span class="o">=</span> <span class="p">(</span><span class="n">oi</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rejection_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z_score</span> <span class="o">&lt;</span> <span class="n">mu_h0</span><span class="p">)</span>
</span><span id="Setred.fit-321"><a href="#Setred.fit-321"><span class="linenos">321</span></a>
</span><span id="Setred.fit-322"><a href="#Setred.fit-322"><span class="linenos">322</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-323"><a href="#Setred.fit-323"><span class="linenos">323</span></a>                <span class="n">L_filtered</span> <span class="o">=</span> <span class="n">L_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Setred.fit-324"><a href="#Setred.fit-324"><span class="linenos">324</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-325"><a href="#Setred.fit-325"><span class="linenos">325</span></a>                <span class="n">L_filtered</span> <span class="o">=</span> <span class="n">L_</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Setred.fit-326"><a href="#Setred.fit-326"><span class="linenos">326</span></a>            <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">y_</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="Setred.fit-327"><a href="#Setred.fit-327"><span class="linenos">327</span></a>            
</span><span id="Setred.fit-328"><a href="#Setred.fit-328"><span class="linenos">328</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-329"><a href="#Setred.fit-329"><span class="linenos">329</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_filtered</span><span class="p">])</span>
</span><span id="Setred.fit-330"><a href="#Setred.fit-330"><span class="linenos">330</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-331"><a href="#Setred.fit-331"><span class="linenos">331</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_filtered</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-332"><a href="#Setred.fit-332"><span class="linenos">332</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">y_filtered</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-333"><a href="#Setred.fit-333"><span class="linenos">333</span></a>
</span><span id="Setred.fit-334"><a href="#Setred.fit-334"><span class="linenos">334</span></a>            <span class="c1">#  Remove the instances from the unlabeled set.</span>
</span><span id="Setred.fit-335"><a href="#Setred.fit-335"><span class="linenos">335</span></a>            <span class="n">to_delete</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="Setred.fit-336"><a href="#Setred.fit-336"><span class="linenos">336</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-337"><a href="#Setred.fit-337"><span class="linenos">337</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">to_delete</span><span class="p">])</span>
</span><span id="Setred.fit-338"><a href="#Setred.fit-338"><span class="linenos">338</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-339"><a href="#Setred.fit-339"><span class="linenos">339</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-340"><a href="#Setred.fit-340"><span class="linenos">340</span></a>
</span><span id="Setred.fit-341"><a href="#Setred.fit-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a Setred classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabeled.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (Setred):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="Setred.predict" class="classattr">
                                        <input id="Setred.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Setred.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.predict-343"><a href="#Setred.predict-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Setred.predict-344"><a href="#Setred.predict-344"><span class="linenos">344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class value for X.</span>
</span><span id="Setred.predict-345"><a href="#Setred.predict-345"><span class="linenos">345</span></a><span class="sd">        For a classification model, the predicted class for each sample in X is returned.</span>
</span><span id="Setred.predict-346"><a href="#Setred.predict-346"><span class="linenos">346</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.predict-347"><a href="#Setred.predict-347"><span class="linenos">347</span></a><span class="sd">        ----------</span>
</span><span id="Setred.predict-348"><a href="#Setred.predict-348"><span class="linenos">348</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred.predict-349"><a href="#Setred.predict-349"><span class="linenos">349</span></a><span class="sd">            The input samples.</span>
</span><span id="Setred.predict-350"><a href="#Setred.predict-350"><span class="linenos">350</span></a><span class="sd">        Returns</span>
</span><span id="Setred.predict-351"><a href="#Setred.predict-351"><span class="linenos">351</span></a><span class="sd">        -------</span>
</span><span id="Setred.predict-352"><a href="#Setred.predict-352"><span class="linenos">352</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Setred.predict-353"><a href="#Setred.predict-353"><span class="linenos">353</span></a><span class="sd">            The predicted classes</span>
</span><span id="Setred.predict-354"><a href="#Setred.predict-354"><span class="linenos">354</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred.predict-355"><a href="#Setred.predict-355"><span class="linenos">355</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict class value for X.
For a classification model, the predicted class for each sample in X is returned.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The input samples.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The predicted classes</li>
</ul>
</div>


                            </div>
                            <div id="Setred.predict_proba" class="classattr">
                                        <input id="Setred.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Setred.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.predict_proba-357"><a href="#Setred.predict_proba-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Setred.predict_proba-358"><a href="#Setred.predict_proba-358"><span class="linenos">358</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class probabilities of the input samples X.</span>
</span><span id="Setred.predict_proba-359"><a href="#Setred.predict_proba-359"><span class="linenos">359</span></a><span class="sd">        The predicted class probability depends on the ensemble estimator.</span>
</span><span id="Setred.predict_proba-360"><a href="#Setred.predict_proba-360"><span class="linenos">360</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.predict_proba-361"><a href="#Setred.predict_proba-361"><span class="linenos">361</span></a><span class="sd">        ----------</span>
</span><span id="Setred.predict_proba-362"><a href="#Setred.predict_proba-362"><span class="linenos">362</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred.predict_proba-363"><a href="#Setred.predict_proba-363"><span class="linenos">363</span></a><span class="sd">            The input samples.</span>
</span><span id="Setred.predict_proba-364"><a href="#Setred.predict_proba-364"><span class="linenos">364</span></a><span class="sd">        Returns</span>
</span><span id="Setred.predict_proba-365"><a href="#Setred.predict_proba-365"><span class="linenos">365</span></a><span class="sd">        -------</span>
</span><span id="Setred.predict_proba-366"><a href="#Setred.predict_proba-366"><span class="linenos">366</span></a><span class="sd">        y : ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1</span>
</span><span id="Setred.predict_proba-367"><a href="#Setred.predict_proba-367"><span class="linenos">367</span></a><span class="sd">            The predicted classes</span>
</span><span id="Setred.predict_proba-368"><a href="#Setred.predict_proba-368"><span class="linenos">368</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred.predict_proba-369"><a href="#Setred.predict_proba-369"><span class="linenos">369</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict class probabilities of the input samples X.
The predicted class probability depends on the ensemble estimator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The input samples.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1):
The predicted classes</li>
</ul>
</div>


                            </div>
                            <div id="Setred.score" class="classattr">
                                        <input id="Setred.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Setred.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.score-371"><a href="#Setred.score-371"><span class="linenos">371</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Setred.score-372"><a href="#Setred.score-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Setred.score-373"><a href="#Setred.score-373"><span class="linenos">373</span></a><span class="sd">        Return the mean accuracy on the given test data and labels.</span>
</span><span id="Setred.score-374"><a href="#Setred.score-374"><span class="linenos">374</span></a>
</span><span id="Setred.score-375"><a href="#Setred.score-375"><span class="linenos">375</span></a><span class="sd">        In multi-label classification, this is the subset accuracy</span>
</span><span id="Setred.score-376"><a href="#Setred.score-376"><span class="linenos">376</span></a><span class="sd">        which is a harsh metric since you require for each sample that</span>
</span><span id="Setred.score-377"><a href="#Setred.score-377"><span class="linenos">377</span></a><span class="sd">        each label set be correctly predicted.</span>
</span><span id="Setred.score-378"><a href="#Setred.score-378"><span class="linenos">378</span></a>
</span><span id="Setred.score-379"><a href="#Setred.score-379"><span class="linenos">379</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.score-380"><a href="#Setred.score-380"><span class="linenos">380</span></a><span class="sd">        ----------</span>
</span><span id="Setred.score-381"><a href="#Setred.score-381"><span class="linenos">381</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="Setred.score-382"><a href="#Setred.score-382"><span class="linenos">382</span></a><span class="sd">            Test samples.</span>
</span><span id="Setred.score-383"><a href="#Setred.score-383"><span class="linenos">383</span></a>
</span><span id="Setred.score-384"><a href="#Setred.score-384"><span class="linenos">384</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="Setred.score-385"><a href="#Setred.score-385"><span class="linenos">385</span></a><span class="sd">            True labels for `X`.</span>
</span><span id="Setred.score-386"><a href="#Setred.score-386"><span class="linenos">386</span></a>
</span><span id="Setred.score-387"><a href="#Setred.score-387"><span class="linenos">387</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), default=None</span>
</span><span id="Setred.score-388"><a href="#Setred.score-388"><span class="linenos">388</span></a><span class="sd">            Sample weights.</span>
</span><span id="Setred.score-389"><a href="#Setred.score-389"><span class="linenos">389</span></a>
</span><span id="Setred.score-390"><a href="#Setred.score-390"><span class="linenos">390</span></a><span class="sd">        Returns</span>
</span><span id="Setred.score-391"><a href="#Setred.score-391"><span class="linenos">391</span></a><span class="sd">        -------</span>
</span><span id="Setred.score-392"><a href="#Setred.score-392"><span class="linenos">392</span></a><span class="sd">        score : float</span>
</span><span id="Setred.score-393"><a href="#Setred.score-393"><span class="linenos">393</span></a><span class="sd">            Mean accuracy of ``self.predict(X)`` w.r.t. `y`.</span>
</span><span id="Setred.score-394"><a href="#Setred.score-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred.score-395"><a href="#Setred.score-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the mean accuracy on the given test data and labels.</p>

<p>In multi-label classification, this is the subset accuracy
which is a harsh metric since you require for each sample that
each label set be correctly predicted.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (array-like of shape (n_samples, n_features)):
Test samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,) or (n_samples, n_outputs)):
True labels for <code>X</code>.</li>
<li><strong>sample_weight</strong> (array-like of shape (n_samples,), default=None):
Sample weights.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>score</strong> (float):
Mean accuracy of <code>self.predict(X)</code> w.r.t. <code>y</code>.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="Setred.get_params" class="function">get_params</dd>
                <dd id="Setred.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CoTraining">
                            <input id="CoTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CoTraining</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="CoTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining-451"><a href="#CoTraining-451"><span class="linenos">451</span></a><span class="k">class</span> <span class="nc">CoTraining</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="CoTraining-452"><a href="#CoTraining-452"><span class="linenos">452</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining-453"><a href="#CoTraining-453"><span class="linenos">453</span></a><span class="sd">    **CoTraining classifier. Multi-view learning algorithm that uses two classifiers to label instances.**</span>
</span><span id="CoTraining-454"><a href="#CoTraining-454"><span class="linenos">454</span></a><span class="sd">    --------------------------------------------</span>
</span><span id="CoTraining-455"><a href="#CoTraining-455"><span class="linenos">455</span></a>
</span><span id="CoTraining-456"><a href="#CoTraining-456"><span class="linenos">456</span></a><span class="sd">    The main process is:</span>
</span><span id="CoTraining-457"><a href="#CoTraining-457"><span class="linenos">457</span></a><span class="sd">    1. Train each classifier with the labeled instances and their respective view.</span>
</span><span id="CoTraining-458"><a href="#CoTraining-458"><span class="linenos">458</span></a><span class="sd">    2. While max iterations is not reached or any instance is unlabeled:</span>
</span><span id="CoTraining-459"><a href="#CoTraining-459"><span class="linenos">459</span></a><span class="sd">        1. Predict the instances from the unlabeled set.</span>
</span><span id="CoTraining-460"><a href="#CoTraining-460"><span class="linenos">460</span></a><span class="sd">        2. Select the instances that have the same prediction and the predictions are above the threshold.</span>
</span><span id="CoTraining-461"><a href="#CoTraining-461"><span class="linenos">461</span></a><span class="sd">        3. Label the instances with the highest probability, keeping the balance of the classes.</span>
</span><span id="CoTraining-462"><a href="#CoTraining-462"><span class="linenos">462</span></a><span class="sd">        4. Retrain the classifier with the new instances.</span>
</span><span id="CoTraining-463"><a href="#CoTraining-463"><span class="linenos">463</span></a><span class="sd">    3. Combine the probabilities of each classifier.</span>
</span><span id="CoTraining-464"><a href="#CoTraining-464"><span class="linenos">464</span></a>
</span><span id="CoTraining-465"><a href="#CoTraining-465"><span class="linenos">465</span></a><span class="sd">    **Methods**</span>
</span><span id="CoTraining-466"><a href="#CoTraining-466"><span class="linenos">466</span></a><span class="sd">    -------</span>
</span><span id="CoTraining-467"><a href="#CoTraining-467"><span class="linenos">467</span></a><span class="sd">    - `fit`: Fit the model with the labeled instances.</span>
</span><span id="CoTraining-468"><a href="#CoTraining-468"><span class="linenos">468</span></a><span class="sd">    - `predict` : Predict the class for each instance.</span>
</span><span id="CoTraining-469"><a href="#CoTraining-469"><span class="linenos">469</span></a><span class="sd">    - `predict_proba`: Predict the probability for each class.</span>
</span><span id="CoTraining-470"><a href="#CoTraining-470"><span class="linenos">470</span></a><span class="sd">    - `score`: Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTraining-471"><a href="#CoTraining-471"><span class="linenos">471</span></a>
</span><span id="CoTraining-472"><a href="#CoTraining-472"><span class="linenos">472</span></a><span class="sd">    **Example**</span>
</span><span id="CoTraining-473"><a href="#CoTraining-473"><span class="linenos">473</span></a><span class="sd">    -------</span>
</span><span id="CoTraining-474"><a href="#CoTraining-474"><span class="linenos">474</span></a><span class="sd">    ```python</span>
</span><span id="CoTraining-475"><a href="#CoTraining-475"><span class="linenos">475</span></a><span class="sd">    from sklearn.datasets import load_iris</span>
</span><span id="CoTraining-476"><a href="#CoTraining-476"><span class="linenos">476</span></a><span class="sd">    from sklearn.tree import DecisionTreeClassifier</span>
</span><span id="CoTraining-477"><a href="#CoTraining-477"><span class="linenos">477</span></a><span class="sd">    from sslearn.wrapper import CoTraining</span>
</span><span id="CoTraining-478"><a href="#CoTraining-478"><span class="linenos">478</span></a><span class="sd">    from sslearn.model_selection import artificial_ssl_dataset</span>
</span><span id="CoTraining-479"><a href="#CoTraining-479"><span class="linenos">479</span></a>
</span><span id="CoTraining-480"><a href="#CoTraining-480"><span class="linenos">480</span></a><span class="sd">    X, y = load_iris(return_X_y=True)</span>
</span><span id="CoTraining-481"><a href="#CoTraining-481"><span class="linenos">481</span></a><span class="sd">    X, y, X_unlabel, y_unlabel, _, _ = artificial_ssl_dataset(X, y, label_rate=0.1, random_state=0)</span>
</span><span id="CoTraining-482"><a href="#CoTraining-482"><span class="linenos">482</span></a><span class="sd">    cotraining = CoTraining(DecisionTreeClassifier())</span>
</span><span id="CoTraining-483"><a href="#CoTraining-483"><span class="linenos">483</span></a><span class="sd">    X1 = X[:, [0, 1]]</span>
</span><span id="CoTraining-484"><a href="#CoTraining-484"><span class="linenos">484</span></a><span class="sd">    X2 = X[:, [2, 3]]</span>
</span><span id="CoTraining-485"><a href="#CoTraining-485"><span class="linenos">485</span></a><span class="sd">    cotraining.fit(X1, y, X2) </span>
</span><span id="CoTraining-486"><a href="#CoTraining-486"><span class="linenos">486</span></a><span class="sd">    # or</span>
</span><span id="CoTraining-487"><a href="#CoTraining-487"><span class="linenos">487</span></a><span class="sd">    cotraining.fit(X, y, features=[[0, 1], [2, 3]])</span>
</span><span id="CoTraining-488"><a href="#CoTraining-488"><span class="linenos">488</span></a><span class="sd">    # or</span>
</span><span id="CoTraining-489"><a href="#CoTraining-489"><span class="linenos">489</span></a><span class="sd">    cotraining = CoTraining(DecisionTreeClassifier(), force_second_view=False)</span>
</span><span id="CoTraining-490"><a href="#CoTraining-490"><span class="linenos">490</span></a><span class="sd">    cotraining.fit(X, y)</span>
</span><span id="CoTraining-491"><a href="#CoTraining-491"><span class="linenos">491</span></a><span class="sd">    ``` </span>
</span><span id="CoTraining-492"><a href="#CoTraining-492"><span class="linenos">492</span></a>
</span><span id="CoTraining-493"><a href="#CoTraining-493"><span class="linenos">493</span></a><span class="sd">    **References**</span>
</span><span id="CoTraining-494"><a href="#CoTraining-494"><span class="linenos">494</span></a><span class="sd">    ----------</span>
</span><span id="CoTraining-495"><a href="#CoTraining-495"><span class="linenos">495</span></a><span class="sd">    Avrim Blum and Tom Mitchell. (1998).&lt;br&gt;</span>
</span><span id="CoTraining-496"><a href="#CoTraining-496"><span class="linenos">496</span></a><span class="sd">    Combining labeled and unlabeled data with co-training&lt;br&gt;</span>
</span><span id="CoTraining-497"><a href="#CoTraining-497"><span class="linenos">497</span></a><span class="sd">    in &lt;i&gt;Proceedings of the eleventh annual conference on Computational learning theory (COLT&#39; 98)&lt;/i&gt;.&lt;br&gt;</span>
</span><span id="CoTraining-498"><a href="#CoTraining-498"><span class="linenos">498</span></a><span class="sd">    Association for Computing Machinery, New York, NY, USA, 92-100.&lt;br&gt;</span>
</span><span id="CoTraining-499"><a href="#CoTraining-499"><span class="linenos">499</span></a><span class="sd">    [10.1145/279943.279962](https://doi.org/10.1145/279943.279962)</span>
</span><span id="CoTraining-500"><a href="#CoTraining-500"><span class="linenos">500</span></a>
</span><span id="CoTraining-501"><a href="#CoTraining-501"><span class="linenos">501</span></a><span class="sd">    Han, Xian-Hua, Yen-wei Chen, and Xiang Ruan. (2011). &lt;br&gt;</span>
</span><span id="CoTraining-502"><a href="#CoTraining-502"><span class="linenos">502</span></a><span class="sd">    Multi-Class Co-Training Learning for Object and Scene Recognition,&lt;br&gt;</span>
</span><span id="CoTraining-503"><a href="#CoTraining-503"><span class="linenos">503</span></a><span class="sd">    pp. 67-70 in. Nara, Japan. &lt;br&gt;</span>
</span><span id="CoTraining-504"><a href="#CoTraining-504"><span class="linenos">504</span></a><span class="sd">    [http://www.mva-org.jp/Proceedings/2011CD/papers/04-08.pdf](http://www.mva-org.jp/Proceedings/2011CD/papers/04-08.pdf)&lt;br&gt;</span>
</span><span id="CoTraining-505"><a href="#CoTraining-505"><span class="linenos">505</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CoTraining-506"><a href="#CoTraining-506"><span class="linenos">506</span></a>
</span><span id="CoTraining-507"><a href="#CoTraining-507"><span class="linenos">507</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CoTraining-508"><a href="#CoTraining-508"><span class="linenos">508</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CoTraining-509"><a href="#CoTraining-509"><span class="linenos">509</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="CoTraining-510"><a href="#CoTraining-510"><span class="linenos">510</span></a>        <span class="n">second_base_estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CoTraining-511"><a href="#CoTraining-511"><span class="linenos">511</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="CoTraining-512"><a href="#CoTraining-512"><span class="linenos">512</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
</span><span id="CoTraining-513"><a href="#CoTraining-513"><span class="linenos">513</span></a>        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="CoTraining-514"><a href="#CoTraining-514"><span class="linenos">514</span></a>        <span class="n">force_second_view</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CoTraining-515"><a href="#CoTraining-515"><span class="linenos">515</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>
</span><span id="CoTraining-516"><a href="#CoTraining-516"><span class="linenos">516</span></a>    <span class="p">):</span>
</span><span id="CoTraining-517"><a href="#CoTraining-517"><span class="linenos">517</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining-518"><a href="#CoTraining-518"><span class="linenos">518</span></a><span class="sd">        Create a CoTraining classifier. </span>
</span><span id="CoTraining-519"><a href="#CoTraining-519"><span class="linenos">519</span></a><span class="sd">        Multi-view learning algorithm that uses two classifiers to label instances.</span>
</span><span id="CoTraining-520"><a href="#CoTraining-520"><span class="linenos">520</span></a>
</span><span id="CoTraining-521"><a href="#CoTraining-521"><span class="linenos">521</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-522"><a href="#CoTraining-522"><span class="linenos">522</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-523"><a href="#CoTraining-523"><span class="linenos">523</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="CoTraining-524"><a href="#CoTraining-524"><span class="linenos">524</span></a><span class="sd">            The classifier that will be used in the cotraining algorithm on the feature set, by default DecisionTreeClassifier()</span>
</span><span id="CoTraining-525"><a href="#CoTraining-525"><span class="linenos">525</span></a><span class="sd">        second_base_estimator : ClassifierMixin, optional</span>
</span><span id="CoTraining-526"><a href="#CoTraining-526"><span class="linenos">526</span></a><span class="sd">            The classifier that will be used in the cotraining algorithm on another feature set, if none are a clone of base_estimator, by default None</span>
</span><span id="CoTraining-527"><a href="#CoTraining-527"><span class="linenos">527</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="CoTraining-528"><a href="#CoTraining-528"><span class="linenos">528</span></a><span class="sd">            The number of iterations, by default 30</span>
</span><span id="CoTraining-529"><a href="#CoTraining-529"><span class="linenos">529</span></a><span class="sd">        poolsize : int, optional</span>
</span><span id="CoTraining-530"><a href="#CoTraining-530"><span class="linenos">530</span></a><span class="sd">            The size of the pool of unlabeled samples from which the classifier can choose, by default 75</span>
</span><span id="CoTraining-531"><a href="#CoTraining-531"><span class="linenos">531</span></a><span class="sd">        threshold : float, optional</span>
</span><span id="CoTraining-532"><a href="#CoTraining-532"><span class="linenos">532</span></a><span class="sd">            The threshold for label instances, by default 0.5</span>
</span><span id="CoTraining-533"><a href="#CoTraining-533"><span class="linenos">533</span></a><span class="sd">        force_second_view : bool, optional</span>
</span><span id="CoTraining-534"><a href="#CoTraining-534"><span class="linenos">534</span></a><span class="sd">            The second classifier needs a different view of the data. If False then a second view will be same as the first, by default True</span>
</span><span id="CoTraining-535"><a href="#CoTraining-535"><span class="linenos">535</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoTraining-536"><a href="#CoTraining-536"><span class="linenos">536</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoTraining-537"><a href="#CoTraining-537"><span class="linenos">537</span></a>
</span><span id="CoTraining-538"><a href="#CoTraining-538"><span class="linenos">538</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-539"><a href="#CoTraining-539"><span class="linenos">539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTraining-540"><a href="#CoTraining-540"><span class="linenos">540</span></a>        <span class="k">if</span> <span class="n">second_base_estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining-541"><a href="#CoTraining-541"><span class="linenos">541</span></a>            <span class="n">second_base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">second_base_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTraining-542"><a href="#CoTraining-542"><span class="linenos">542</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span> <span class="o">=</span> <span class="n">second_base_estimator</span>
</span><span id="CoTraining-543"><a href="#CoTraining-543"><span class="linenos">543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="CoTraining-544"><a href="#CoTraining-544"><span class="linenos">544</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="CoTraining-545"><a href="#CoTraining-545"><span class="linenos">545</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="CoTraining-546"><a href="#CoTraining-546"><span class="linenos">546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">force_second_view</span> <span class="o">=</span> <span class="n">force_second_view</span>
</span><span id="CoTraining-547"><a href="#CoTraining-547"><span class="linenos">547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoTraining-548"><a href="#CoTraining-548"><span class="linenos">548</span></a>
</span><span id="CoTraining-549"><a href="#CoTraining-549"><span class="linenos">549</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number_per_class</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining-550"><a href="#CoTraining-550"><span class="linenos">550</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining-551"><a href="#CoTraining-551"><span class="linenos">551</span></a><span class="sd">        Build a CoTraining classifier from the training set.</span>
</span><span id="CoTraining-552"><a href="#CoTraining-552"><span class="linenos">552</span></a>
</span><span id="CoTraining-553"><a href="#CoTraining-553"><span class="linenos">553</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-554"><a href="#CoTraining-554"><span class="linenos">554</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-555"><a href="#CoTraining-555"><span class="linenos">555</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining-556"><a href="#CoTraining-556"><span class="linenos">556</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining-557"><a href="#CoTraining-557"><span class="linenos">557</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTraining-558"><a href="#CoTraining-558"><span class="linenos">558</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="CoTraining-559"><a href="#CoTraining-559"><span class="linenos">559</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining-560"><a href="#CoTraining-560"><span class="linenos">560</span></a><span class="sd">            Array representing the data from another view, not compatible with `features`, by default None</span>
</span><span id="CoTraining-561"><a href="#CoTraining-561"><span class="linenos">561</span></a><span class="sd">        features : {list, tuple}, optional</span>
</span><span id="CoTraining-562"><a href="#CoTraining-562"><span class="linenos">562</span></a><span class="sd">            list or tuple of two arrays with `feature` index for each subspace view, not compatible with `X2`, by default None</span>
</span><span id="CoTraining-563"><a href="#CoTraining-563"><span class="linenos">563</span></a><span class="sd">        number_per_class : {dict}, optional</span>
</span><span id="CoTraining-564"><a href="#CoTraining-564"><span class="linenos">564</span></a><span class="sd">            dict of class name:integer with the max ammount of instances to label in this class in each iteration, by default None</span>
</span><span id="CoTraining-565"><a href="#CoTraining-565"><span class="linenos">565</span></a>
</span><span id="CoTraining-566"><a href="#CoTraining-566"><span class="linenos">566</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining-567"><a href="#CoTraining-567"><span class="linenos">567</span></a><span class="sd">        -------</span>
</span><span id="CoTraining-568"><a href="#CoTraining-568"><span class="linenos">568</span></a><span class="sd">        self: CoTraining</span>
</span><span id="CoTraining-569"><a href="#CoTraining-569"><span class="linenos">569</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoTraining-570"><a href="#CoTraining-570"><span class="linenos">570</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-571"><a href="#CoTraining-571"><span class="linenos">571</span></a>        <span class="n">rs</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoTraining-572"><a href="#CoTraining-572"><span class="linenos">572</span></a>
</span><span id="CoTraining-573"><a href="#CoTraining-573"><span class="linenos">573</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTraining-574"><a href="#CoTraining-574"><span class="linenos">574</span></a>
</span><span id="CoTraining-575"><a href="#CoTraining-575"><span class="linenos">575</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoTraining-576"><a href="#CoTraining-576"><span class="linenos">576</span></a>
</span><span id="CoTraining-577"><a href="#CoTraining-577"><span class="linenos">577</span></a>        <span class="k">if</span> <span class="n">X2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining-578"><a href="#CoTraining-578"><span class="linenos">578</span></a>            <span class="n">X2_label</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTraining-579"><a href="#CoTraining-579"><span class="linenos">579</span></a>        <span class="k">elif</span> <span class="n">features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining-580"><a href="#CoTraining-580"><span class="linenos">580</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoTraining-581"><a href="#CoTraining-581"><span class="linenos">581</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining-582"><a href="#CoTraining-582"><span class="linenos">582</span></a>                <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining-583"><a href="#CoTraining-583"><span class="linenos">583</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining-584"><a href="#CoTraining-584"><span class="linenos">584</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining-585"><a href="#CoTraining-585"><span class="linenos">585</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-586"><a href="#CoTraining-586"><span class="linenos">586</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining-587"><a href="#CoTraining-587"><span class="linenos">587</span></a>                <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining-588"><a href="#CoTraining-588"><span class="linenos">588</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining-589"><a href="#CoTraining-589"><span class="linenos">589</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining-590"><a href="#CoTraining-590"><span class="linenos">590</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="n">features</span>
</span><span id="CoTraining-591"><a href="#CoTraining-591"><span class="linenos">591</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_second_view</span><span class="p">:</span>
</span><span id="CoTraining-592"><a href="#CoTraining-592"><span class="linenos">592</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Either X2 or features must be defined. CoTraining need another view to train the second classifier&quot;</span><span class="p">)</span>
</span><span id="CoTraining-593"><a href="#CoTraining-593"><span class="linenos">593</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-594"><a href="#CoTraining-594"><span class="linenos">594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="CoTraining-595"><a href="#CoTraining-595"><span class="linenos">595</span></a>            <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining-596"><a href="#CoTraining-596"><span class="linenos">596</span></a>            <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining-597"><a href="#CoTraining-597"><span class="linenos">597</span></a>
</span><span id="CoTraining-598"><a href="#CoTraining-598"><span class="linenos">598</span></a>        <span class="k">if</span> <span class="n">is_df</span> <span class="ow">and</span> <span class="n">X2_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="CoTraining-599"><a href="#CoTraining-599"><span class="linenos">599</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;X and X2 must be both pandas DataFrame or numpy arrays&quot;</span><span class="p">)</span>
</span><span id="CoTraining-600"><a href="#CoTraining-600"><span class="linenos">600</span></a>
</span><span id="CoTraining-601"><a href="#CoTraining-601"><span class="linenos">601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CoTraining-602"><a href="#CoTraining-602"><span class="linenos">602</span></a>            <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">),</span>
</span><span id="CoTraining-603"><a href="#CoTraining-603"><span class="linenos">603</span></a>            <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span><span class="p">)</span>
</span><span id="CoTraining-604"><a href="#CoTraining-604"><span class="linenos">604</span></a>        <span class="p">]</span>
</span><span id="CoTraining-605"><a href="#CoTraining-605"><span class="linenos">605</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="CoTraining-606"><a href="#CoTraining-606"><span class="linenos">606</span></a>            <span class="n">X2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">features</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="CoTraining-607"><a href="#CoTraining-607"><span class="linenos">607</span></a>        <span class="p">),</span> <span class="s2">&quot;The list of features and X2 cannot be defined at the same time&quot;</span>
</span><span id="CoTraining-608"><a href="#CoTraining-608"><span class="linenos">608</span></a>
</span><span id="CoTraining-609"><a href="#CoTraining-609"><span class="linenos">609</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-610"><a href="#CoTraining-610"><span class="linenos">610</span></a>        <span class="k">if</span> <span class="n">number_per_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining-611"><a href="#CoTraining-611"><span class="linenos">611</span></a>            <span class="n">number_per_class</span> <span class="o">=</span> <span class="n">calc_number_per_class</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-612"><a href="#CoTraining-612"><span class="linenos">612</span></a>
</span><span id="CoTraining-613"><a href="#CoTraining-613"><span class="linenos">613</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">:</span>
</span><span id="CoTraining-614"><a href="#CoTraining-614"><span class="linenos">614</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Poolsize (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="si">}</span><span class="s2">) is bigger than U (</span><span class="si">{</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="CoTraining-615"><a href="#CoTraining-615"><span class="linenos">615</span></a>
</span><span id="CoTraining-616"><a href="#CoTraining-616"><span class="linenos">616</span></a>        <span class="n">permutation</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">))</span>
</span><span id="CoTraining-617"><a href="#CoTraining-617"><span class="linenos">617</span></a>
</span><span id="CoTraining-618"><a href="#CoTraining-618"><span class="linenos">618</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-619"><a href="#CoTraining-619"><span class="linenos">619</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-620"><a href="#CoTraining-620"><span class="linenos">620</span></a>
</span><span id="CoTraining-621"><a href="#CoTraining-621"><span class="linenos">621</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CoTraining-622"><a href="#CoTraining-622"><span class="linenos">622</span></a>        <span class="k">while</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">permutation</span><span class="p">):</span>
</span><span id="CoTraining-623"><a href="#CoTraining-623"><span class="linenos">623</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CoTraining-624"><a href="#CoTraining-624"><span class="linenos">624</span></a>
</span><span id="CoTraining-625"><a href="#CoTraining-625"><span class="linenos">625</span></a>            <span class="n">get_index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]</span>
</span><span id="CoTraining-626"><a href="#CoTraining-626"><span class="linenos">626</span></a>            <span class="n">y1_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">[</span><span class="n">get_index</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">get_index</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="CoTraining-627"><a href="#CoTraining-627"><span class="linenos">627</span></a>            <span class="n">y2_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2_unlabel</span><span class="p">[</span><span class="n">get_index</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X2_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">get_index</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="CoTraining-628"><a href="#CoTraining-628"><span class="linenos">628</span></a>
</span><span id="CoTraining-629"><a href="#CoTraining-629"><span class="linenos">629</span></a>            <span class="n">predictions1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y1_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining-630"><a href="#CoTraining-630"><span class="linenos">630</span></a>            <span class="n">class_predicted1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y1_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining-631"><a href="#CoTraining-631"><span class="linenos">631</span></a>
</span><span id="CoTraining-632"><a href="#CoTraining-632"><span class="linenos">632</span></a>            <span class="n">predictions2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y2_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining-633"><a href="#CoTraining-633"><span class="linenos">633</span></a>            <span class="n">class_predicted2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y2_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining-634"><a href="#CoTraining-634"><span class="linenos">634</span></a>
</span><span id="CoTraining-635"><a href="#CoTraining-635"><span class="linenos">635</span></a>            <span class="c1"># If two classifier select same instance and bring different predictions then the instance is not labeled</span>
</span><span id="CoTraining-636"><a href="#CoTraining-636"><span class="linenos">636</span></a>            <span class="n">candidates1</span> <span class="o">=</span> <span class="n">predictions1</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoTraining-637"><a href="#CoTraining-637"><span class="linenos">637</span></a>            <span class="n">candidates2</span> <span class="o">=</span> <span class="n">predictions2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoTraining-638"><a href="#CoTraining-638"><span class="linenos">638</span></a>            <span class="n">aggreement</span> <span class="o">=</span> <span class="n">class_predicted1</span> <span class="o">==</span> <span class="n">class_predicted2</span>
</span><span id="CoTraining-639"><a href="#CoTraining-639"><span class="linenos">639</span></a>
</span><span id="CoTraining-640"><a href="#CoTraining-640"><span class="linenos">640</span></a>            <span class="n">full_candidates</span> <span class="o">=</span> <span class="n">candidates1</span> <span class="o">^</span> <span class="n">candidates2</span>
</span><span id="CoTraining-641"><a href="#CoTraining-641"><span class="linenos">641</span></a>            <span class="n">medium_candidates</span> <span class="o">=</span> <span class="n">candidates1</span> <span class="o">&amp;</span> <span class="n">candidates2</span> <span class="o">&amp;</span> <span class="n">aggreement</span>
</span><span id="CoTraining-642"><a href="#CoTraining-642"><span class="linenos">642</span></a>            <span class="n">true_candidates1</span> <span class="o">=</span> <span class="n">full_candidates</span> <span class="o">&amp;</span> <span class="n">candidates1</span>
</span><span id="CoTraining-643"><a href="#CoTraining-643"><span class="linenos">643</span></a>            <span class="n">true_candidates2</span> <span class="o">=</span> <span class="n">full_candidates</span> <span class="o">&amp;</span> <span class="n">candidates2</span>
</span><span id="CoTraining-644"><a href="#CoTraining-644"><span class="linenos">644</span></a>
</span><span id="CoTraining-645"><a href="#CoTraining-645"><span class="linenos">645</span></a>            <span class="c1"># Fill probas and candidate classes.</span>
</span><span id="CoTraining-646"><a href="#CoTraining-646"><span class="linenos">646</span></a>            <span class="n">y_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions1</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoTraining-647"><a href="#CoTraining-647"><span class="linenos">647</span></a>            <span class="n">y_class</span> <span class="o">=</span> <span class="n">class_predicted1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining-648"><a href="#CoTraining-648"><span class="linenos">648</span></a>
</span><span id="CoTraining-649"><a href="#CoTraining-649"><span class="linenos">649</span></a>            <span class="n">temp_probas1</span> <span class="o">=</span> <span class="n">predictions1</span><span class="p">[</span><span class="n">true_candidates1</span><span class="p">]</span>
</span><span id="CoTraining-650"><a href="#CoTraining-650"><span class="linenos">650</span></a>            <span class="n">temp_probas2</span> <span class="o">=</span> <span class="n">predictions2</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span>
</span><span id="CoTraining-651"><a href="#CoTraining-651"><span class="linenos">651</span></a>            <span class="n">temp_probasB</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions1</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">]</span><span class="o">+</span><span class="n">predictions2</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
</span><span id="CoTraining-652"><a href="#CoTraining-652"><span class="linenos">652</span></a>
</span><span id="CoTraining-653"><a href="#CoTraining-653"><span class="linenos">653</span></a>            <span class="n">temp_classes2</span> <span class="o">=</span> <span class="n">class_predicted2</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span>
</span><span id="CoTraining-654"><a href="#CoTraining-654"><span class="linenos">654</span></a>
</span><span id="CoTraining-655"><a href="#CoTraining-655"><span class="linenos">655</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">true_candidates1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probas1</span>
</span><span id="CoTraining-656"><a href="#CoTraining-656"><span class="linenos">656</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probas2</span>
</span><span id="CoTraining-657"><a href="#CoTraining-657"><span class="linenos">657</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probasB</span>
</span><span id="CoTraining-658"><a href="#CoTraining-658"><span class="linenos">658</span></a>            <span class="n">y_class</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_classes2</span>
</span><span id="CoTraining-659"><a href="#CoTraining-659"><span class="linenos">659</span></a>
</span><span id="CoTraining-660"><a href="#CoTraining-660"><span class="linenos">660</span></a>            <span class="c1"># Select the best candidates</span>
</span><span id="CoTraining-661"><a href="#CoTraining-661"><span class="linenos">661</span></a>            <span class="n">final_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="CoTraining-662"><a href="#CoTraining-662"><span class="linenos">662</span></a>            <span class="n">best_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">y_probas</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CoTraining-663"><a href="#CoTraining-663"><span class="linenos">663</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="CoTraining-664"><a href="#CoTraining-664"><span class="linenos">664</span></a>                <span class="n">final_instances</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">best_candidates</span><span class="p">[</span><span class="n">y_class</span><span class="p">[</span><span class="n">best_candidates</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">])[:</span><span class="n">number_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span>
</span><span id="CoTraining-665"><a href="#CoTraining-665"><span class="linenos">665</span></a>
</span><span id="CoTraining-666"><a href="#CoTraining-666"><span class="linenos">666</span></a>            <span class="c1"># Fill the new labeled instances</span>
</span><span id="CoTraining-667"><a href="#CoTraining-667"><span class="linenos">667</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="n">y_class</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="CoTraining-668"><a href="#CoTraining-668"><span class="linenos">668</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">pseudoy</span><span class="p">)</span>
</span><span id="CoTraining-669"><a href="#CoTraining-669"><span class="linenos">669</span></a>
</span><span id="CoTraining-670"><a href="#CoTraining-670"><span class="linenos">670</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">][</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="CoTraining-671"><a href="#CoTraining-671"><span class="linenos">671</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoTraining-672"><a href="#CoTraining-672"><span class="linenos">672</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoTraining-673"><a href="#CoTraining-673"><span class="linenos">673</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoTraining-674"><a href="#CoTraining-674"><span class="linenos">674</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-675"><a href="#CoTraining-675"><span class="linenos">675</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoTraining-676"><a href="#CoTraining-676"><span class="linenos">676</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoTraining-677"><a href="#CoTraining-677"><span class="linenos">677</span></a>
</span><span id="CoTraining-678"><a href="#CoTraining-678"><span class="linenos">678</span></a>            <span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">,</span> <span class="n">permutation</span><span class="p">))]</span>
</span><span id="CoTraining-679"><a href="#CoTraining-679"><span class="linenos">679</span></a>
</span><span id="CoTraining-680"><a href="#CoTraining-680"><span class="linenos">680</span></a>            <span class="c1"># Poolsize increments in order double of max instances candidates:</span>
</span><span id="CoTraining-681"><a href="#CoTraining-681"><span class="linenos">681</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">number_per_class</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="CoTraining-682"><a href="#CoTraining-682"><span class="linenos">682</span></a>
</span><span id="CoTraining-683"><a href="#CoTraining-683"><span class="linenos">683</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-684"><a href="#CoTraining-684"><span class="linenos">684</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-685"><a href="#CoTraining-685"><span class="linenos">685</span></a>
</span><span id="CoTraining-686"><a href="#CoTraining-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span>
</span><span id="CoTraining-687"><a href="#CoTraining-687"><span class="linenos">687</span></a>
</span><span id="CoTraining-688"><a href="#CoTraining-688"><span class="linenos">688</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="CoTraining-689"><a href="#CoTraining-689"><span class="linenos">689</span></a>
</span><span id="CoTraining-690"><a href="#CoTraining-690"><span class="linenos">690</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining-691"><a href="#CoTraining-691"><span class="linenos">691</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probability for each possible outcome.</span>
</span><span id="CoTraining-692"><a href="#CoTraining-692"><span class="linenos">692</span></a>
</span><span id="CoTraining-693"><a href="#CoTraining-693"><span class="linenos">693</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-694"><a href="#CoTraining-694"><span class="linenos">694</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-695"><a href="#CoTraining-695"><span class="linenos">695</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining-696"><a href="#CoTraining-696"><span class="linenos">696</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining-697"><a href="#CoTraining-697"><span class="linenos">697</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining-698"><a href="#CoTraining-698"><span class="linenos">698</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining-699"><a href="#CoTraining-699"><span class="linenos">699</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining-700"><a href="#CoTraining-700"><span class="linenos">700</span></a><span class="sd">        -------</span>
</span><span id="CoTraining-701"><a href="#CoTraining-701"><span class="linenos">701</span></a><span class="sd">        class probabilities: ndarray of shape (n_samples, n_classes)</span>
</span><span id="CoTraining-702"><a href="#CoTraining-702"><span class="linenos">702</span></a><span class="sd">            Array with prediction probabilities.</span>
</span><span id="CoTraining-703"><a href="#CoTraining-703"><span class="linenos">703</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-704"><a href="#CoTraining-704"><span class="linenos">704</span></a>        <span class="k">if</span> <span class="s2">&quot;columns_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining-705"><a href="#CoTraining-705"><span class="linenos">705</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining-706"><a href="#CoTraining-706"><span class="linenos">706</span></a>        <span class="k">elif</span> <span class="s2">&quot;h_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining-707"><a href="#CoTraining-707"><span class="linenos">707</span></a>            <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoTraining-708"><a href="#CoTraining-708"><span class="linenos">708</span></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">))</span>
</span><span id="CoTraining-709"><a href="#CoTraining-709"><span class="linenos">709</span></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">))</span>
</span><span id="CoTraining-710"><a href="#CoTraining-710"><span class="linenos">710</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span><span id="CoTraining-711"><a href="#CoTraining-711"><span class="linenos">711</span></a>            <span class="k">return</span> <span class="n">y</span>
</span><span id="CoTraining-712"><a href="#CoTraining-712"><span class="linenos">712</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-713"><a href="#CoTraining-713"><span class="linenos">713</span></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span><span class="s2">&quot;Classifier not fitted&quot;</span><span class="p">)</span>
</span><span id="CoTraining-714"><a href="#CoTraining-714"><span class="linenos">714</span></a>
</span><span id="CoTraining-715"><a href="#CoTraining-715"><span class="linenos">715</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining-716"><a href="#CoTraining-716"><span class="linenos">716</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict the classes of X.</span>
</span><span id="CoTraining-717"><a href="#CoTraining-717"><span class="linenos">717</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-718"><a href="#CoTraining-718"><span class="linenos">718</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-719"><a href="#CoTraining-719"><span class="linenos">719</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining-720"><a href="#CoTraining-720"><span class="linenos">720</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining-721"><a href="#CoTraining-721"><span class="linenos">721</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining-722"><a href="#CoTraining-722"><span class="linenos">722</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining-723"><a href="#CoTraining-723"><span class="linenos">723</span></a>
</span><span id="CoTraining-724"><a href="#CoTraining-724"><span class="linenos">724</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining-725"><a href="#CoTraining-725"><span class="linenos">725</span></a><span class="sd">        -------</span>
</span><span id="CoTraining-726"><a href="#CoTraining-726"><span class="linenos">726</span></a><span class="sd">        y : ndarray of shape (n_samples,)</span>
</span><span id="CoTraining-727"><a href="#CoTraining-727"><span class="linenos">727</span></a><span class="sd">            Array with predicted labels.</span>
</span><span id="CoTraining-728"><a href="#CoTraining-728"><span class="linenos">728</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-729"><a href="#CoTraining-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="s2">&quot;columns_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining-730"><a href="#CoTraining-730"><span class="linenos">730</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining-731"><a href="#CoTraining-731"><span class="linenos">731</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-732"><a href="#CoTraining-732"><span class="linenos">732</span></a>            <span class="n">predicted_probabilitiy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining-733"><a href="#CoTraining-733"><span class="linenos">733</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span>
</span><span id="CoTraining-734"><a href="#CoTraining-734"><span class="linenos">734</span></a>                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predicted_probabilitiy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
</span><span id="CoTraining-735"><a href="#CoTraining-735"><span class="linenos">735</span></a>            <span class="p">)</span>
</span><span id="CoTraining-736"><a href="#CoTraining-736"><span class="linenos">736</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="CoTraining-737"><a href="#CoTraining-737"><span class="linenos">737</span></a>
</span><span id="CoTraining-738"><a href="#CoTraining-738"><span class="linenos">738</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining-739"><a href="#CoTraining-739"><span class="linenos">739</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining-740"><a href="#CoTraining-740"><span class="linenos">740</span></a><span class="sd">        Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTraining-741"><a href="#CoTraining-741"><span class="linenos">741</span></a><span class="sd">        In multi-label classification, this is the subset accuracy</span>
</span><span id="CoTraining-742"><a href="#CoTraining-742"><span class="linenos">742</span></a><span class="sd">        which is a harsh metric since you require for each sample that</span>
</span><span id="CoTraining-743"><a href="#CoTraining-743"><span class="linenos">743</span></a><span class="sd">        each label set be correctly predicted.</span>
</span><span id="CoTraining-744"><a href="#CoTraining-744"><span class="linenos">744</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-745"><a href="#CoTraining-745"><span class="linenos">745</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-746"><a href="#CoTraining-746"><span class="linenos">746</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="CoTraining-747"><a href="#CoTraining-747"><span class="linenos">747</span></a><span class="sd">            Test samples.</span>
</span><span id="CoTraining-748"><a href="#CoTraining-748"><span class="linenos">748</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="CoTraining-749"><a href="#CoTraining-749"><span class="linenos">749</span></a><span class="sd">            True labels for `X`.</span>
</span><span id="CoTraining-750"><a href="#CoTraining-750"><span class="linenos">750</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), default=None</span>
</span><span id="CoTraining-751"><a href="#CoTraining-751"><span class="linenos">751</span></a><span class="sd">            Sample weights.</span>
</span><span id="CoTraining-752"><a href="#CoTraining-752"><span class="linenos">752</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining-753"><a href="#CoTraining-753"><span class="linenos">753</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining-754"><a href="#CoTraining-754"><span class="linenos">754</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining-755"><a href="#CoTraining-755"><span class="linenos">755</span></a><span class="sd">        -------</span>
</span><span id="CoTraining-756"><a href="#CoTraining-756"><span class="linenos">756</span></a><span class="sd">        score : float</span>
</span><span id="CoTraining-757"><a href="#CoTraining-757"><span class="linenos">757</span></a><span class="sd">            Mean accuracy of ``self.predict(X)`` wrt. `y`.</span>
</span><span id="CoTraining-758"><a href="#CoTraining-758"><span class="linenos">758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-759"><a href="#CoTraining-759"><span class="linenos">759</span></a>        <span class="k">if</span> <span class="s2">&quot;X2&quot;</span> <span class="ow">in</span> <span class="n">kwards</span><span class="p">:</span>
</span><span id="CoTraining-760"><a href="#CoTraining-760"><span class="linenos">760</span></a>            <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">kwards</span><span class="p">[</span><span class="s2">&quot;X2&quot;</span><span class="p">]),</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="CoTraining-761"><a href="#CoTraining-761"><span class="linenos">761</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-762"><a href="#CoTraining-762"><span class="linenos">762</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h2 id="cotraining-classifier-multi-view-learning-algorithm-that-uses-two-classifiers-to-label-instances"><strong>CoTraining classifier. Multi-view learning algorithm that uses two classifiers to label instances.</strong></h2>

<p>The main process is:</p>

<ol>
<li>Train each classifier with the labeled instances and their respective view.</li>
<li>While max iterations is not reached or any instance is unlabeled:
<ol>
<li>Predict the instances from the unlabeled set.</li>
<li>Select the instances that have the same prediction and the predictions are above the threshold.</li>
<li>Label the instances with the highest probability, keeping the balance of the classes.</li>
<li>Retrain the classifier with the new instances.</li>
</ol></li>
<li>Combine the probabilities of each classifier.</li>
</ol>

<h2 id="methods"><strong>Methods</strong></h2>

<ul>
<li><code><a href="#CoTraining.fit">fit</a></code>: Fit the model with the labeled instances.</li>
<li><code><a href="#CoTraining.predict">predict</a></code> : Predict the class for each instance.</li>
<li><code><a href="#CoTraining.predict_proba">predict_proba</a></code>: Predict the probability for each class.</li>
<li><code><a href="#CoTraining.score">score</a></code>: Return the mean accuracy on the given test data and labels.</li>
</ul>

<h2 id="example"><strong>Example</strong></h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn"><a href="">sslearn.wrapper</a></span> <span class="kn">import</span> <span class="n">CoTraining</span>
<span class="kn">from</span> <span class="nn"><a href="model_selection.html">sslearn.model_selection</a></span> <span class="kn">import</span> <span class="n">artificial_ssl_dataset</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">artificial_ssl_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cotraining</span> <span class="o">=</span> <span class="n">CoTraining</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">())</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="n">cotraining</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span> 
<span class="c1"># or</span>
<span class="n">cotraining</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="c1"># or</span>
<span class="n">cotraining</span> <span class="o">=</span> <span class="n">CoTraining</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">force_second_view</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cotraining</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="references"><strong>References</strong></h2>

<p>Avrim Blum and Tom Mitchell. (1998).<br>
Combining labeled and unlabeled data with co-training<br>
in <i>Proceedings of the eleventh annual conference on Computational learning theory (COLT' 98)</i>.<br>
Association for Computing Machinery, New York, NY, USA, 92-100.<br>
<a href="https://doi.org/10.1145/279943.279962">10.1145/279943.279962</a></p>

<p>Han, Xian-Hua, Yen-wei Chen, and Xiang Ruan. (2011). <br>
Multi-Class Co-Training Learning for Object and Scene Recognition,<br>
pp. 67-70 in. Nara, Japan. <br>
<a href="http://www.mva-org.jp/Proceedings/2011CD/papers/04-08.pdf">http://www.mva-org.jp/Proceedings/2011CD/papers/04-08.pdf</a><br></p>
</div>


                            <div id="CoTraining.__init__" class="classattr">
                                        <input id="CoTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CoTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">second_base_estimator</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">30</span>,</span><span class="param">	<span class="n">poolsize</span><span class="o">=</span><span class="mi">75</span>,</span><span class="param">	<span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span>,</span><span class="param">	<span class="n">force_second_view</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="CoTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.__init__-507"><a href="#CoTraining.__init__-507"><span class="linenos">507</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CoTraining.__init__-508"><a href="#CoTraining.__init__-508"><span class="linenos">508</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CoTraining.__init__-509"><a href="#CoTraining.__init__-509"><span class="linenos">509</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="CoTraining.__init__-510"><a href="#CoTraining.__init__-510"><span class="linenos">510</span></a>        <span class="n">second_base_estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CoTraining.__init__-511"><a href="#CoTraining.__init__-511"><span class="linenos">511</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="CoTraining.__init__-512"><a href="#CoTraining.__init__-512"><span class="linenos">512</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
</span><span id="CoTraining.__init__-513"><a href="#CoTraining.__init__-513"><span class="linenos">513</span></a>        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="CoTraining.__init__-514"><a href="#CoTraining.__init__-514"><span class="linenos">514</span></a>        <span class="n">force_second_view</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CoTraining.__init__-515"><a href="#CoTraining.__init__-515"><span class="linenos">515</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>
</span><span id="CoTraining.__init__-516"><a href="#CoTraining.__init__-516"><span class="linenos">516</span></a>    <span class="p">):</span>
</span><span id="CoTraining.__init__-517"><a href="#CoTraining.__init__-517"><span class="linenos">517</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining.__init__-518"><a href="#CoTraining.__init__-518"><span class="linenos">518</span></a><span class="sd">        Create a CoTraining classifier. </span>
</span><span id="CoTraining.__init__-519"><a href="#CoTraining.__init__-519"><span class="linenos">519</span></a><span class="sd">        Multi-view learning algorithm that uses two classifiers to label instances.</span>
</span><span id="CoTraining.__init__-520"><a href="#CoTraining.__init__-520"><span class="linenos">520</span></a>
</span><span id="CoTraining.__init__-521"><a href="#CoTraining.__init__-521"><span class="linenos">521</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.__init__-522"><a href="#CoTraining.__init__-522"><span class="linenos">522</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.__init__-523"><a href="#CoTraining.__init__-523"><span class="linenos">523</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="CoTraining.__init__-524"><a href="#CoTraining.__init__-524"><span class="linenos">524</span></a><span class="sd">            The classifier that will be used in the cotraining algorithm on the feature set, by default DecisionTreeClassifier()</span>
</span><span id="CoTraining.__init__-525"><a href="#CoTraining.__init__-525"><span class="linenos">525</span></a><span class="sd">        second_base_estimator : ClassifierMixin, optional</span>
</span><span id="CoTraining.__init__-526"><a href="#CoTraining.__init__-526"><span class="linenos">526</span></a><span class="sd">            The classifier that will be used in the cotraining algorithm on another feature set, if none are a clone of base_estimator, by default None</span>
</span><span id="CoTraining.__init__-527"><a href="#CoTraining.__init__-527"><span class="linenos">527</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="CoTraining.__init__-528"><a href="#CoTraining.__init__-528"><span class="linenos">528</span></a><span class="sd">            The number of iterations, by default 30</span>
</span><span id="CoTraining.__init__-529"><a href="#CoTraining.__init__-529"><span class="linenos">529</span></a><span class="sd">        poolsize : int, optional</span>
</span><span id="CoTraining.__init__-530"><a href="#CoTraining.__init__-530"><span class="linenos">530</span></a><span class="sd">            The size of the pool of unlabeled samples from which the classifier can choose, by default 75</span>
</span><span id="CoTraining.__init__-531"><a href="#CoTraining.__init__-531"><span class="linenos">531</span></a><span class="sd">        threshold : float, optional</span>
</span><span id="CoTraining.__init__-532"><a href="#CoTraining.__init__-532"><span class="linenos">532</span></a><span class="sd">            The threshold for label instances, by default 0.5</span>
</span><span id="CoTraining.__init__-533"><a href="#CoTraining.__init__-533"><span class="linenos">533</span></a><span class="sd">        force_second_view : bool, optional</span>
</span><span id="CoTraining.__init__-534"><a href="#CoTraining.__init__-534"><span class="linenos">534</span></a><span class="sd">            The second classifier needs a different view of the data. If False then a second view will be same as the first, by default True</span>
</span><span id="CoTraining.__init__-535"><a href="#CoTraining.__init__-535"><span class="linenos">535</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoTraining.__init__-536"><a href="#CoTraining.__init__-536"><span class="linenos">536</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoTraining.__init__-537"><a href="#CoTraining.__init__-537"><span class="linenos">537</span></a>
</span><span id="CoTraining.__init__-538"><a href="#CoTraining.__init__-538"><span class="linenos">538</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.__init__-539"><a href="#CoTraining.__init__-539"><span class="linenos">539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTraining.__init__-540"><a href="#CoTraining.__init__-540"><span class="linenos">540</span></a>        <span class="k">if</span> <span class="n">second_base_estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining.__init__-541"><a href="#CoTraining.__init__-541"><span class="linenos">541</span></a>            <span class="n">second_base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">second_base_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTraining.__init__-542"><a href="#CoTraining.__init__-542"><span class="linenos">542</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span> <span class="o">=</span> <span class="n">second_base_estimator</span>
</span><span id="CoTraining.__init__-543"><a href="#CoTraining.__init__-543"><span class="linenos">543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="CoTraining.__init__-544"><a href="#CoTraining.__init__-544"><span class="linenos">544</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="CoTraining.__init__-545"><a href="#CoTraining.__init__-545"><span class="linenos">545</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="CoTraining.__init__-546"><a href="#CoTraining.__init__-546"><span class="linenos">546</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">force_second_view</span> <span class="o">=</span> <span class="n">force_second_view</span>
</span><span id="CoTraining.__init__-547"><a href="#CoTraining.__init__-547"><span class="linenos">547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span></pre></div>


            <div class="docstring"><p>Create a CoTraining classifier. 
Multi-view learning algorithm that uses two classifiers to label instances.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
The classifier that will be used in the cotraining algorithm on the feature set, by default DecisionTreeClassifier()</li>
<li><strong>second_base_estimator</strong> (ClassifierMixin, optional):
The classifier that will be used in the cotraining algorithm on another feature set, if none are a clone of base_estimator, by default None</li>
<li><strong>max_iterations</strong> (int, optional):
The number of iterations, by default 30</li>
<li><strong>poolsize</strong> (int, optional):
The size of the pool of unlabeled samples from which the classifier can choose, by default 75</li>
<li><strong>threshold</strong> (float, optional):
The threshold for label instances, by default 0.5</li>
<li><strong>force_second_view</strong> (bool, optional):
The second classifier needs a different view of the data. If False then a second view will be same as the first, by default True</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>
</div>


                            </div>
                            <div id="CoTraining.fit" class="classattr">
                                        <input id="CoTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">X</span>,</span><span class="param">	<span class="n">y</span>,</span><span class="param">	<span class="n">X2</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">features</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">number_per_class</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.fit-549"><a href="#CoTraining.fit-549"><span class="linenos">549</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number_per_class</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining.fit-550"><a href="#CoTraining.fit-550"><span class="linenos">550</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining.fit-551"><a href="#CoTraining.fit-551"><span class="linenos">551</span></a><span class="sd">        Build a CoTraining classifier from the training set.</span>
</span><span id="CoTraining.fit-552"><a href="#CoTraining.fit-552"><span class="linenos">552</span></a>
</span><span id="CoTraining.fit-553"><a href="#CoTraining.fit-553"><span class="linenos">553</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.fit-554"><a href="#CoTraining.fit-554"><span class="linenos">554</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.fit-555"><a href="#CoTraining.fit-555"><span class="linenos">555</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining.fit-556"><a href="#CoTraining.fit-556"><span class="linenos">556</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining.fit-557"><a href="#CoTraining.fit-557"><span class="linenos">557</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTraining.fit-558"><a href="#CoTraining.fit-558"><span class="linenos">558</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="CoTraining.fit-559"><a href="#CoTraining.fit-559"><span class="linenos">559</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining.fit-560"><a href="#CoTraining.fit-560"><span class="linenos">560</span></a><span class="sd">            Array representing the data from another view, not compatible with `features`, by default None</span>
</span><span id="CoTraining.fit-561"><a href="#CoTraining.fit-561"><span class="linenos">561</span></a><span class="sd">        features : {list, tuple}, optional</span>
</span><span id="CoTraining.fit-562"><a href="#CoTraining.fit-562"><span class="linenos">562</span></a><span class="sd">            list or tuple of two arrays with `feature` index for each subspace view, not compatible with `X2`, by default None</span>
</span><span id="CoTraining.fit-563"><a href="#CoTraining.fit-563"><span class="linenos">563</span></a><span class="sd">        number_per_class : {dict}, optional</span>
</span><span id="CoTraining.fit-564"><a href="#CoTraining.fit-564"><span class="linenos">564</span></a><span class="sd">            dict of class name:integer with the max ammount of instances to label in this class in each iteration, by default None</span>
</span><span id="CoTraining.fit-565"><a href="#CoTraining.fit-565"><span class="linenos">565</span></a>
</span><span id="CoTraining.fit-566"><a href="#CoTraining.fit-566"><span class="linenos">566</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining.fit-567"><a href="#CoTraining.fit-567"><span class="linenos">567</span></a><span class="sd">        -------</span>
</span><span id="CoTraining.fit-568"><a href="#CoTraining.fit-568"><span class="linenos">568</span></a><span class="sd">        self: CoTraining</span>
</span><span id="CoTraining.fit-569"><a href="#CoTraining.fit-569"><span class="linenos">569</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoTraining.fit-570"><a href="#CoTraining.fit-570"><span class="linenos">570</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.fit-571"><a href="#CoTraining.fit-571"><span class="linenos">571</span></a>        <span class="n">rs</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoTraining.fit-572"><a href="#CoTraining.fit-572"><span class="linenos">572</span></a>
</span><span id="CoTraining.fit-573"><a href="#CoTraining.fit-573"><span class="linenos">573</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTraining.fit-574"><a href="#CoTraining.fit-574"><span class="linenos">574</span></a>
</span><span id="CoTraining.fit-575"><a href="#CoTraining.fit-575"><span class="linenos">575</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoTraining.fit-576"><a href="#CoTraining.fit-576"><span class="linenos">576</span></a>
</span><span id="CoTraining.fit-577"><a href="#CoTraining.fit-577"><span class="linenos">577</span></a>        <span class="k">if</span> <span class="n">X2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining.fit-578"><a href="#CoTraining.fit-578"><span class="linenos">578</span></a>            <span class="n">X2_label</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTraining.fit-579"><a href="#CoTraining.fit-579"><span class="linenos">579</span></a>        <span class="k">elif</span> <span class="n">features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining.fit-580"><a href="#CoTraining.fit-580"><span class="linenos">580</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoTraining.fit-581"><a href="#CoTraining.fit-581"><span class="linenos">581</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining.fit-582"><a href="#CoTraining.fit-582"><span class="linenos">582</span></a>                <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining.fit-583"><a href="#CoTraining.fit-583"><span class="linenos">583</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining.fit-584"><a href="#CoTraining.fit-584"><span class="linenos">584</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining.fit-585"><a href="#CoTraining.fit-585"><span class="linenos">585</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.fit-586"><a href="#CoTraining.fit-586"><span class="linenos">586</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining.fit-587"><a href="#CoTraining.fit-587"><span class="linenos">587</span></a>                <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining.fit-588"><a href="#CoTraining.fit-588"><span class="linenos">588</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining.fit-589"><a href="#CoTraining.fit-589"><span class="linenos">589</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining.fit-590"><a href="#CoTraining.fit-590"><span class="linenos">590</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="n">features</span>
</span><span id="CoTraining.fit-591"><a href="#CoTraining.fit-591"><span class="linenos">591</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_second_view</span><span class="p">:</span>
</span><span id="CoTraining.fit-592"><a href="#CoTraining.fit-592"><span class="linenos">592</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Either X2 or features must be defined. CoTraining need another view to train the second classifier&quot;</span><span class="p">)</span>
</span><span id="CoTraining.fit-593"><a href="#CoTraining.fit-593"><span class="linenos">593</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.fit-594"><a href="#CoTraining.fit-594"><span class="linenos">594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="CoTraining.fit-595"><a href="#CoTraining.fit-595"><span class="linenos">595</span></a>            <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining.fit-596"><a href="#CoTraining.fit-596"><span class="linenos">596</span></a>            <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining.fit-597"><a href="#CoTraining.fit-597"><span class="linenos">597</span></a>
</span><span id="CoTraining.fit-598"><a href="#CoTraining.fit-598"><span class="linenos">598</span></a>        <span class="k">if</span> <span class="n">is_df</span> <span class="ow">and</span> <span class="n">X2_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="CoTraining.fit-599"><a href="#CoTraining.fit-599"><span class="linenos">599</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;X and X2 must be both pandas DataFrame or numpy arrays&quot;</span><span class="p">)</span>
</span><span id="CoTraining.fit-600"><a href="#CoTraining.fit-600"><span class="linenos">600</span></a>
</span><span id="CoTraining.fit-601"><a href="#CoTraining.fit-601"><span class="linenos">601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CoTraining.fit-602"><a href="#CoTraining.fit-602"><span class="linenos">602</span></a>            <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">),</span>
</span><span id="CoTraining.fit-603"><a href="#CoTraining.fit-603"><span class="linenos">603</span></a>            <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span><span class="p">)</span>
</span><span id="CoTraining.fit-604"><a href="#CoTraining.fit-604"><span class="linenos">604</span></a>        <span class="p">]</span>
</span><span id="CoTraining.fit-605"><a href="#CoTraining.fit-605"><span class="linenos">605</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="CoTraining.fit-606"><a href="#CoTraining.fit-606"><span class="linenos">606</span></a>            <span class="n">X2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">features</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="CoTraining.fit-607"><a href="#CoTraining.fit-607"><span class="linenos">607</span></a>        <span class="p">),</span> <span class="s2">&quot;The list of features and X2 cannot be defined at the same time&quot;</span>
</span><span id="CoTraining.fit-608"><a href="#CoTraining.fit-608"><span class="linenos">608</span></a>
</span><span id="CoTraining.fit-609"><a href="#CoTraining.fit-609"><span class="linenos">609</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-610"><a href="#CoTraining.fit-610"><span class="linenos">610</span></a>        <span class="k">if</span> <span class="n">number_per_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining.fit-611"><a href="#CoTraining.fit-611"><span class="linenos">611</span></a>            <span class="n">number_per_class</span> <span class="o">=</span> <span class="n">calc_number_per_class</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-612"><a href="#CoTraining.fit-612"><span class="linenos">612</span></a>
</span><span id="CoTraining.fit-613"><a href="#CoTraining.fit-613"><span class="linenos">613</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">:</span>
</span><span id="CoTraining.fit-614"><a href="#CoTraining.fit-614"><span class="linenos">614</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Poolsize (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="si">}</span><span class="s2">) is bigger than U (</span><span class="si">{</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="CoTraining.fit-615"><a href="#CoTraining.fit-615"><span class="linenos">615</span></a>
</span><span id="CoTraining.fit-616"><a href="#CoTraining.fit-616"><span class="linenos">616</span></a>        <span class="n">permutation</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">))</span>
</span><span id="CoTraining.fit-617"><a href="#CoTraining.fit-617"><span class="linenos">617</span></a>
</span><span id="CoTraining.fit-618"><a href="#CoTraining.fit-618"><span class="linenos">618</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-619"><a href="#CoTraining.fit-619"><span class="linenos">619</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-620"><a href="#CoTraining.fit-620"><span class="linenos">620</span></a>
</span><span id="CoTraining.fit-621"><a href="#CoTraining.fit-621"><span class="linenos">621</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CoTraining.fit-622"><a href="#CoTraining.fit-622"><span class="linenos">622</span></a>        <span class="k">while</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">permutation</span><span class="p">):</span>
</span><span id="CoTraining.fit-623"><a href="#CoTraining.fit-623"><span class="linenos">623</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CoTraining.fit-624"><a href="#CoTraining.fit-624"><span class="linenos">624</span></a>
</span><span id="CoTraining.fit-625"><a href="#CoTraining.fit-625"><span class="linenos">625</span></a>            <span class="n">get_index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]</span>
</span><span id="CoTraining.fit-626"><a href="#CoTraining.fit-626"><span class="linenos">626</span></a>            <span class="n">y1_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">[</span><span class="n">get_index</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">get_index</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="CoTraining.fit-627"><a href="#CoTraining.fit-627"><span class="linenos">627</span></a>            <span class="n">y2_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2_unlabel</span><span class="p">[</span><span class="n">get_index</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X2_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">get_index</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="CoTraining.fit-628"><a href="#CoTraining.fit-628"><span class="linenos">628</span></a>
</span><span id="CoTraining.fit-629"><a href="#CoTraining.fit-629"><span class="linenos">629</span></a>            <span class="n">predictions1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y1_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining.fit-630"><a href="#CoTraining.fit-630"><span class="linenos">630</span></a>            <span class="n">class_predicted1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y1_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining.fit-631"><a href="#CoTraining.fit-631"><span class="linenos">631</span></a>
</span><span id="CoTraining.fit-632"><a href="#CoTraining.fit-632"><span class="linenos">632</span></a>            <span class="n">predictions2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y2_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining.fit-633"><a href="#CoTraining.fit-633"><span class="linenos">633</span></a>            <span class="n">class_predicted2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y2_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining.fit-634"><a href="#CoTraining.fit-634"><span class="linenos">634</span></a>
</span><span id="CoTraining.fit-635"><a href="#CoTraining.fit-635"><span class="linenos">635</span></a>            <span class="c1"># If two classifier select same instance and bring different predictions then the instance is not labeled</span>
</span><span id="CoTraining.fit-636"><a href="#CoTraining.fit-636"><span class="linenos">636</span></a>            <span class="n">candidates1</span> <span class="o">=</span> <span class="n">predictions1</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoTraining.fit-637"><a href="#CoTraining.fit-637"><span class="linenos">637</span></a>            <span class="n">candidates2</span> <span class="o">=</span> <span class="n">predictions2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoTraining.fit-638"><a href="#CoTraining.fit-638"><span class="linenos">638</span></a>            <span class="n">aggreement</span> <span class="o">=</span> <span class="n">class_predicted1</span> <span class="o">==</span> <span class="n">class_predicted2</span>
</span><span id="CoTraining.fit-639"><a href="#CoTraining.fit-639"><span class="linenos">639</span></a>
</span><span id="CoTraining.fit-640"><a href="#CoTraining.fit-640"><span class="linenos">640</span></a>            <span class="n">full_candidates</span> <span class="o">=</span> <span class="n">candidates1</span> <span class="o">^</span> <span class="n">candidates2</span>
</span><span id="CoTraining.fit-641"><a href="#CoTraining.fit-641"><span class="linenos">641</span></a>            <span class="n">medium_candidates</span> <span class="o">=</span> <span class="n">candidates1</span> <span class="o">&amp;</span> <span class="n">candidates2</span> <span class="o">&amp;</span> <span class="n">aggreement</span>
</span><span id="CoTraining.fit-642"><a href="#CoTraining.fit-642"><span class="linenos">642</span></a>            <span class="n">true_candidates1</span> <span class="o">=</span> <span class="n">full_candidates</span> <span class="o">&amp;</span> <span class="n">candidates1</span>
</span><span id="CoTraining.fit-643"><a href="#CoTraining.fit-643"><span class="linenos">643</span></a>            <span class="n">true_candidates2</span> <span class="o">=</span> <span class="n">full_candidates</span> <span class="o">&amp;</span> <span class="n">candidates2</span>
</span><span id="CoTraining.fit-644"><a href="#CoTraining.fit-644"><span class="linenos">644</span></a>
</span><span id="CoTraining.fit-645"><a href="#CoTraining.fit-645"><span class="linenos">645</span></a>            <span class="c1"># Fill probas and candidate classes.</span>
</span><span id="CoTraining.fit-646"><a href="#CoTraining.fit-646"><span class="linenos">646</span></a>            <span class="n">y_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions1</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoTraining.fit-647"><a href="#CoTraining.fit-647"><span class="linenos">647</span></a>            <span class="n">y_class</span> <span class="o">=</span> <span class="n">class_predicted1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining.fit-648"><a href="#CoTraining.fit-648"><span class="linenos">648</span></a>
</span><span id="CoTraining.fit-649"><a href="#CoTraining.fit-649"><span class="linenos">649</span></a>            <span class="n">temp_probas1</span> <span class="o">=</span> <span class="n">predictions1</span><span class="p">[</span><span class="n">true_candidates1</span><span class="p">]</span>
</span><span id="CoTraining.fit-650"><a href="#CoTraining.fit-650"><span class="linenos">650</span></a>            <span class="n">temp_probas2</span> <span class="o">=</span> <span class="n">predictions2</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span>
</span><span id="CoTraining.fit-651"><a href="#CoTraining.fit-651"><span class="linenos">651</span></a>            <span class="n">temp_probasB</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions1</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">]</span><span class="o">+</span><span class="n">predictions2</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
</span><span id="CoTraining.fit-652"><a href="#CoTraining.fit-652"><span class="linenos">652</span></a>
</span><span id="CoTraining.fit-653"><a href="#CoTraining.fit-653"><span class="linenos">653</span></a>            <span class="n">temp_classes2</span> <span class="o">=</span> <span class="n">class_predicted2</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span>
</span><span id="CoTraining.fit-654"><a href="#CoTraining.fit-654"><span class="linenos">654</span></a>
</span><span id="CoTraining.fit-655"><a href="#CoTraining.fit-655"><span class="linenos">655</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">true_candidates1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probas1</span>
</span><span id="CoTraining.fit-656"><a href="#CoTraining.fit-656"><span class="linenos">656</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probas2</span>
</span><span id="CoTraining.fit-657"><a href="#CoTraining.fit-657"><span class="linenos">657</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probasB</span>
</span><span id="CoTraining.fit-658"><a href="#CoTraining.fit-658"><span class="linenos">658</span></a>            <span class="n">y_class</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_classes2</span>
</span><span id="CoTraining.fit-659"><a href="#CoTraining.fit-659"><span class="linenos">659</span></a>
</span><span id="CoTraining.fit-660"><a href="#CoTraining.fit-660"><span class="linenos">660</span></a>            <span class="c1"># Select the best candidates</span>
</span><span id="CoTraining.fit-661"><a href="#CoTraining.fit-661"><span class="linenos">661</span></a>            <span class="n">final_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="CoTraining.fit-662"><a href="#CoTraining.fit-662"><span class="linenos">662</span></a>            <span class="n">best_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">y_probas</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CoTraining.fit-663"><a href="#CoTraining.fit-663"><span class="linenos">663</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="CoTraining.fit-664"><a href="#CoTraining.fit-664"><span class="linenos">664</span></a>                <span class="n">final_instances</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">best_candidates</span><span class="p">[</span><span class="n">y_class</span><span class="p">[</span><span class="n">best_candidates</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">])[:</span><span class="n">number_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span>
</span><span id="CoTraining.fit-665"><a href="#CoTraining.fit-665"><span class="linenos">665</span></a>
</span><span id="CoTraining.fit-666"><a href="#CoTraining.fit-666"><span class="linenos">666</span></a>            <span class="c1"># Fill the new labeled instances</span>
</span><span id="CoTraining.fit-667"><a href="#CoTraining.fit-667"><span class="linenos">667</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="n">y_class</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="CoTraining.fit-668"><a href="#CoTraining.fit-668"><span class="linenos">668</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">pseudoy</span><span class="p">)</span>
</span><span id="CoTraining.fit-669"><a href="#CoTraining.fit-669"><span class="linenos">669</span></a>
</span><span id="CoTraining.fit-670"><a href="#CoTraining.fit-670"><span class="linenos">670</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">][</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="CoTraining.fit-671"><a href="#CoTraining.fit-671"><span class="linenos">671</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoTraining.fit-672"><a href="#CoTraining.fit-672"><span class="linenos">672</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoTraining.fit-673"><a href="#CoTraining.fit-673"><span class="linenos">673</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoTraining.fit-674"><a href="#CoTraining.fit-674"><span class="linenos">674</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.fit-675"><a href="#CoTraining.fit-675"><span class="linenos">675</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoTraining.fit-676"><a href="#CoTraining.fit-676"><span class="linenos">676</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoTraining.fit-677"><a href="#CoTraining.fit-677"><span class="linenos">677</span></a>
</span><span id="CoTraining.fit-678"><a href="#CoTraining.fit-678"><span class="linenos">678</span></a>            <span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">,</span> <span class="n">permutation</span><span class="p">))]</span>
</span><span id="CoTraining.fit-679"><a href="#CoTraining.fit-679"><span class="linenos">679</span></a>
</span><span id="CoTraining.fit-680"><a href="#CoTraining.fit-680"><span class="linenos">680</span></a>            <span class="c1"># Poolsize increments in order double of max instances candidates:</span>
</span><span id="CoTraining.fit-681"><a href="#CoTraining.fit-681"><span class="linenos">681</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">number_per_class</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="CoTraining.fit-682"><a href="#CoTraining.fit-682"><span class="linenos">682</span></a>
</span><span id="CoTraining.fit-683"><a href="#CoTraining.fit-683"><span class="linenos">683</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-684"><a href="#CoTraining.fit-684"><span class="linenos">684</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-685"><a href="#CoTraining.fit-685"><span class="linenos">685</span></a>
</span><span id="CoTraining.fit-686"><a href="#CoTraining.fit-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span>
</span><span id="CoTraining.fit-687"><a href="#CoTraining.fit-687"><span class="linenos">687</span></a>
</span><span id="CoTraining.fit-688"><a href="#CoTraining.fit-688"><span class="linenos">688</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a CoTraining classifier from the training set.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabeled.</li>
<li><strong>X2</strong> ({array-like, sparse matrix} of shape (n_samples, n_features), optional):
Array representing the data from another view, not compatible with <code>features</code>, by default None</li>
<li><strong>features</strong> ({list, tuple}, optional):
list or tuple of two arrays with <code>feature</code> index for each subspace view, not compatible with <code>X2</code>, by default None</li>
<li><strong>number_per_class</strong> ({dict}, optional):
dict of class name:integer with the max ammount of instances to label in this class in each iteration, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (CoTraining):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="CoTraining.predict_proba" class="classattr">
                                        <input id="CoTraining.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">X2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTraining.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.predict_proba-690"><a href="#CoTraining.predict_proba-690"><span class="linenos">690</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining.predict_proba-691"><a href="#CoTraining.predict_proba-691"><span class="linenos">691</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probability for each possible outcome.</span>
</span><span id="CoTraining.predict_proba-692"><a href="#CoTraining.predict_proba-692"><span class="linenos">692</span></a>
</span><span id="CoTraining.predict_proba-693"><a href="#CoTraining.predict_proba-693"><span class="linenos">693</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.predict_proba-694"><a href="#CoTraining.predict_proba-694"><span class="linenos">694</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.predict_proba-695"><a href="#CoTraining.predict_proba-695"><span class="linenos">695</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining.predict_proba-696"><a href="#CoTraining.predict_proba-696"><span class="linenos">696</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining.predict_proba-697"><a href="#CoTraining.predict_proba-697"><span class="linenos">697</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining.predict_proba-698"><a href="#CoTraining.predict_proba-698"><span class="linenos">698</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining.predict_proba-699"><a href="#CoTraining.predict_proba-699"><span class="linenos">699</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining.predict_proba-700"><a href="#CoTraining.predict_proba-700"><span class="linenos">700</span></a><span class="sd">        -------</span>
</span><span id="CoTraining.predict_proba-701"><a href="#CoTraining.predict_proba-701"><span class="linenos">701</span></a><span class="sd">        class probabilities: ndarray of shape (n_samples, n_classes)</span>
</span><span id="CoTraining.predict_proba-702"><a href="#CoTraining.predict_proba-702"><span class="linenos">702</span></a><span class="sd">            Array with prediction probabilities.</span>
</span><span id="CoTraining.predict_proba-703"><a href="#CoTraining.predict_proba-703"><span class="linenos">703</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.predict_proba-704"><a href="#CoTraining.predict_proba-704"><span class="linenos">704</span></a>        <span class="k">if</span> <span class="s2">&quot;columns_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining.predict_proba-705"><a href="#CoTraining.predict_proba-705"><span class="linenos">705</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining.predict_proba-706"><a href="#CoTraining.predict_proba-706"><span class="linenos">706</span></a>        <span class="k">elif</span> <span class="s2">&quot;h_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining.predict_proba-707"><a href="#CoTraining.predict_proba-707"><span class="linenos">707</span></a>            <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoTraining.predict_proba-708"><a href="#CoTraining.predict_proba-708"><span class="linenos">708</span></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">))</span>
</span><span id="CoTraining.predict_proba-709"><a href="#CoTraining.predict_proba-709"><span class="linenos">709</span></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">))</span>
</span><span id="CoTraining.predict_proba-710"><a href="#CoTraining.predict_proba-710"><span class="linenos">710</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span><span id="CoTraining.predict_proba-711"><a href="#CoTraining.predict_proba-711"><span class="linenos">711</span></a>            <span class="k">return</span> <span class="n">y</span>
</span><span id="CoTraining.predict_proba-712"><a href="#CoTraining.predict_proba-712"><span class="linenos">712</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.predict_proba-713"><a href="#CoTraining.predict_proba-713"><span class="linenos">713</span></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span><span class="s2">&quot;Classifier not fitted&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict probability for each possible outcome.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
<li><strong>X2</strong> ({array-like, sparse matrix} of shape (n_samples, n_features), optional):
Array representing the data from another view, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>class probabilities</strong> (ndarray of shape (n_samples, n_classes)):
Array with prediction probabilities.</li>
</ul>
</div>


                            </div>
                            <div id="CoTraining.predict" class="classattr">
                                        <input id="CoTraining.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">X2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTraining.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.predict-715"><a href="#CoTraining.predict-715"><span class="linenos">715</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining.predict-716"><a href="#CoTraining.predict-716"><span class="linenos">716</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict the classes of X.</span>
</span><span id="CoTraining.predict-717"><a href="#CoTraining.predict-717"><span class="linenos">717</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.predict-718"><a href="#CoTraining.predict-718"><span class="linenos">718</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.predict-719"><a href="#CoTraining.predict-719"><span class="linenos">719</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining.predict-720"><a href="#CoTraining.predict-720"><span class="linenos">720</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining.predict-721"><a href="#CoTraining.predict-721"><span class="linenos">721</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining.predict-722"><a href="#CoTraining.predict-722"><span class="linenos">722</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining.predict-723"><a href="#CoTraining.predict-723"><span class="linenos">723</span></a>
</span><span id="CoTraining.predict-724"><a href="#CoTraining.predict-724"><span class="linenos">724</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining.predict-725"><a href="#CoTraining.predict-725"><span class="linenos">725</span></a><span class="sd">        -------</span>
</span><span id="CoTraining.predict-726"><a href="#CoTraining.predict-726"><span class="linenos">726</span></a><span class="sd">        y : ndarray of shape (n_samples,)</span>
</span><span id="CoTraining.predict-727"><a href="#CoTraining.predict-727"><span class="linenos">727</span></a><span class="sd">            Array with predicted labels.</span>
</span><span id="CoTraining.predict-728"><a href="#CoTraining.predict-728"><span class="linenos">728</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.predict-729"><a href="#CoTraining.predict-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="s2">&quot;columns_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining.predict-730"><a href="#CoTraining.predict-730"><span class="linenos">730</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining.predict-731"><a href="#CoTraining.predict-731"><span class="linenos">731</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.predict-732"><a href="#CoTraining.predict-732"><span class="linenos">732</span></a>            <span class="n">predicted_probabilitiy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining.predict-733"><a href="#CoTraining.predict-733"><span class="linenos">733</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span>
</span><span id="CoTraining.predict-734"><a href="#CoTraining.predict-734"><span class="linenos">734</span></a>                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predicted_probabilitiy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
</span><span id="CoTraining.predict-735"><a href="#CoTraining.predict-735"><span class="linenos">735</span></a>            <span class="p">)</span>
</span><span id="CoTraining.predict-736"><a href="#CoTraining.predict-736"><span class="linenos">736</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Predict the classes of X.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
<li><strong>X2</strong> ({array-like, sparse matrix} of shape (n_samples, n_features), optional):
Array representing the data from another view, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (ndarray of shape (n_samples,)):
Array with predicted labels.</li>
</ul>
</div>


                            </div>
                            <div id="CoTraining.score" class="classattr">
                                        <input id="CoTraining.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTraining.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.score-738"><a href="#CoTraining.score-738"><span class="linenos">738</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining.score-739"><a href="#CoTraining.score-739"><span class="linenos">739</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining.score-740"><a href="#CoTraining.score-740"><span class="linenos">740</span></a><span class="sd">        Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTraining.score-741"><a href="#CoTraining.score-741"><span class="linenos">741</span></a><span class="sd">        In multi-label classification, this is the subset accuracy</span>
</span><span id="CoTraining.score-742"><a href="#CoTraining.score-742"><span class="linenos">742</span></a><span class="sd">        which is a harsh metric since you require for each sample that</span>
</span><span id="CoTraining.score-743"><a href="#CoTraining.score-743"><span class="linenos">743</span></a><span class="sd">        each label set be correctly predicted.</span>
</span><span id="CoTraining.score-744"><a href="#CoTraining.score-744"><span class="linenos">744</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.score-745"><a href="#CoTraining.score-745"><span class="linenos">745</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.score-746"><a href="#CoTraining.score-746"><span class="linenos">746</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="CoTraining.score-747"><a href="#CoTraining.score-747"><span class="linenos">747</span></a><span class="sd">            Test samples.</span>
</span><span id="CoTraining.score-748"><a href="#CoTraining.score-748"><span class="linenos">748</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="CoTraining.score-749"><a href="#CoTraining.score-749"><span class="linenos">749</span></a><span class="sd">            True labels for `X`.</span>
</span><span id="CoTraining.score-750"><a href="#CoTraining.score-750"><span class="linenos">750</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), default=None</span>
</span><span id="CoTraining.score-751"><a href="#CoTraining.score-751"><span class="linenos">751</span></a><span class="sd">            Sample weights.</span>
</span><span id="CoTraining.score-752"><a href="#CoTraining.score-752"><span class="linenos">752</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining.score-753"><a href="#CoTraining.score-753"><span class="linenos">753</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining.score-754"><a href="#CoTraining.score-754"><span class="linenos">754</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining.score-755"><a href="#CoTraining.score-755"><span class="linenos">755</span></a><span class="sd">        -------</span>
</span><span id="CoTraining.score-756"><a href="#CoTraining.score-756"><span class="linenos">756</span></a><span class="sd">        score : float</span>
</span><span id="CoTraining.score-757"><a href="#CoTraining.score-757"><span class="linenos">757</span></a><span class="sd">            Mean accuracy of ``self.predict(X)`` wrt. `y`.</span>
</span><span id="CoTraining.score-758"><a href="#CoTraining.score-758"><span class="linenos">758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.score-759"><a href="#CoTraining.score-759"><span class="linenos">759</span></a>        <span class="k">if</span> <span class="s2">&quot;X2&quot;</span> <span class="ow">in</span> <span class="n">kwards</span><span class="p">:</span>
</span><span id="CoTraining.score-760"><a href="#CoTraining.score-760"><span class="linenos">760</span></a>            <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">kwards</span><span class="p">[</span><span class="s2">&quot;X2&quot;</span><span class="p">]),</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="CoTraining.score-761"><a href="#CoTraining.score-761"><span class="linenos">761</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.score-762"><a href="#CoTraining.score-762"><span class="linenos">762</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the mean accuracy on the given test data and labels.
In multi-label classification, this is the subset accuracy
which is a harsh metric since you require for each sample that
each label set be correctly predicted.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (array-like of shape (n_samples, n_features)):
Test samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,) or (n_samples, n_outputs)):
True labels for <code>X</code>.</li>
<li><strong>sample_weight</strong> (array-like of shape (n_samples,), default=None):
Sample weights.</li>
<li><strong>X2</strong> ({array-like, sparse matrix} of shape (n_samples, n_features), optional):
Array representing the data from another view, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>score</strong> (float):
Mean accuracy of <code>self.predict(X)</code> wrt. <code>y</code>.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="CoTraining.get_params" class="function">get_params</dd>
                <dd id="CoTraining.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CoTrainingByCommittee">
                            <input id="CoTrainingByCommittee-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CoTrainingByCommittee</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="CoTrainingByCommittee-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee-1058"><a href="#CoTrainingByCommittee-1058"><span class="linenos">1058</span></a><span class="k">class</span> <span class="nc">CoTrainingByCommittee</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1059"><a href="#CoTrainingByCommittee-1059"><span class="linenos">1059</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1060"><a href="#CoTrainingByCommittee-1060"><span class="linenos">1060</span></a><span class="sd">    **Co-Training by Committee classifier.**</span>
</span><span id="CoTrainingByCommittee-1061"><a href="#CoTrainingByCommittee-1061"><span class="linenos">1061</span></a><span class="sd">    --------------------------------------------</span>
</span><span id="CoTrainingByCommittee-1062"><a href="#CoTrainingByCommittee-1062"><span class="linenos">1062</span></a>
</span><span id="CoTrainingByCommittee-1063"><a href="#CoTrainingByCommittee-1063"><span class="linenos">1063</span></a><span class="sd">    Create a committee trained by co-training based on the diversity of the classifiers</span>
</span><span id="CoTrainingByCommittee-1064"><a href="#CoTrainingByCommittee-1064"><span class="linenos">1064</span></a>
</span><span id="CoTrainingByCommittee-1065"><a href="#CoTrainingByCommittee-1065"><span class="linenos">1065</span></a><span class="sd">    The main process is:</span>
</span><span id="CoTrainingByCommittee-1066"><a href="#CoTrainingByCommittee-1066"><span class="linenos">1066</span></a><span class="sd">    1. Train a committee of classifiers.</span>
</span><span id="CoTrainingByCommittee-1067"><a href="#CoTrainingByCommittee-1067"><span class="linenos">1067</span></a><span class="sd">    2. Create a pool of unlabeled instances.</span>
</span><span id="CoTrainingByCommittee-1068"><a href="#CoTrainingByCommittee-1068"><span class="linenos">1068</span></a><span class="sd">    3. While max iterations is not reached or any instance is unlabeled:</span>
</span><span id="CoTrainingByCommittee-1069"><a href="#CoTrainingByCommittee-1069"><span class="linenos">1069</span></a><span class="sd">        1. Predict the instances from the unlabeled set.</span>
</span><span id="CoTrainingByCommittee-1070"><a href="#CoTrainingByCommittee-1070"><span class="linenos">1070</span></a><span class="sd">        2. Select the instances with the highest probability.</span>
</span><span id="CoTrainingByCommittee-1071"><a href="#CoTrainingByCommittee-1071"><span class="linenos">1071</span></a><span class="sd">        3. Label the instances with the highest probability, keeping the balance of the classes but ensuring that at least n instances of each class are added.</span>
</span><span id="CoTrainingByCommittee-1072"><a href="#CoTrainingByCommittee-1072"><span class="linenos">1072</span></a><span class="sd">        4. Retrain the classifier with the new instances.</span>
</span><span id="CoTrainingByCommittee-1073"><a href="#CoTrainingByCommittee-1073"><span class="linenos">1073</span></a><span class="sd">    4. Combine the probabilities of each classifier.</span>
</span><span id="CoTrainingByCommittee-1074"><a href="#CoTrainingByCommittee-1074"><span class="linenos">1074</span></a>
</span><span id="CoTrainingByCommittee-1075"><a href="#CoTrainingByCommittee-1075"><span class="linenos">1075</span></a><span class="sd">    **Methods**</span>
</span><span id="CoTrainingByCommittee-1076"><a href="#CoTrainingByCommittee-1076"><span class="linenos">1076</span></a><span class="sd">    -------</span>
</span><span id="CoTrainingByCommittee-1077"><a href="#CoTrainingByCommittee-1077"><span class="linenos">1077</span></a><span class="sd">    - `fit`: Fit the model with the labeled instances.</span>
</span><span id="CoTrainingByCommittee-1078"><a href="#CoTrainingByCommittee-1078"><span class="linenos">1078</span></a><span class="sd">    - `predict` : Predict the class for each instance.</span>
</span><span id="CoTrainingByCommittee-1079"><a href="#CoTrainingByCommittee-1079"><span class="linenos">1079</span></a><span class="sd">    - `predict_proba`: Predict the probability for each class.</span>
</span><span id="CoTrainingByCommittee-1080"><a href="#CoTrainingByCommittee-1080"><span class="linenos">1080</span></a><span class="sd">    - `score`: Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTrainingByCommittee-1081"><a href="#CoTrainingByCommittee-1081"><span class="linenos">1081</span></a>
</span><span id="CoTrainingByCommittee-1082"><a href="#CoTrainingByCommittee-1082"><span class="linenos">1082</span></a><span class="sd">    **Example**</span>
</span><span id="CoTrainingByCommittee-1083"><a href="#CoTrainingByCommittee-1083"><span class="linenos">1083</span></a><span class="sd">    -------</span>
</span><span id="CoTrainingByCommittee-1084"><a href="#CoTrainingByCommittee-1084"><span class="linenos">1084</span></a><span class="sd">    ```python</span>
</span><span id="CoTrainingByCommittee-1085"><a href="#CoTrainingByCommittee-1085"><span class="linenos">1085</span></a><span class="sd">    from sklearn.datasets import load_iris</span>
</span><span id="CoTrainingByCommittee-1086"><a href="#CoTrainingByCommittee-1086"><span class="linenos">1086</span></a><span class="sd">    from sslearn.wrapper import CoTrainingByCommittee</span>
</span><span id="CoTrainingByCommittee-1087"><a href="#CoTrainingByCommittee-1087"><span class="linenos">1087</span></a><span class="sd">    from sslearn.model_selection import artificial_ssl_dataset</span>
</span><span id="CoTrainingByCommittee-1088"><a href="#CoTrainingByCommittee-1088"><span class="linenos">1088</span></a>
</span><span id="CoTrainingByCommittee-1089"><a href="#CoTrainingByCommittee-1089"><span class="linenos">1089</span></a><span class="sd">    X, y = load_iris(return_X_y=True)</span>
</span><span id="CoTrainingByCommittee-1090"><a href="#CoTrainingByCommittee-1090"><span class="linenos">1090</span></a><span class="sd">    X, y, X_unlabel, y_unlabel, _, _ = artificial_ssl_dataset(X, y, label_rate=0.1, random_state=0)</span>
</span><span id="CoTrainingByCommittee-1091"><a href="#CoTrainingByCommittee-1091"><span class="linenos">1091</span></a><span class="sd">    cotraining = CoTrainingByCommittee()</span>
</span><span id="CoTrainingByCommittee-1092"><a href="#CoTrainingByCommittee-1092"><span class="linenos">1092</span></a><span class="sd">    cotraining.fit(X, y)</span>
</span><span id="CoTrainingByCommittee-1093"><a href="#CoTrainingByCommittee-1093"><span class="linenos">1093</span></a><span class="sd">    cotraining.score(X_unlabel, y_unlabel)</span>
</span><span id="CoTrainingByCommittee-1094"><a href="#CoTrainingByCommittee-1094"><span class="linenos">1094</span></a><span class="sd">    ```</span>
</span><span id="CoTrainingByCommittee-1095"><a href="#CoTrainingByCommittee-1095"><span class="linenos">1095</span></a>
</span><span id="CoTrainingByCommittee-1096"><a href="#CoTrainingByCommittee-1096"><span class="linenos">1096</span></a><span class="sd">    **References**</span>
</span><span id="CoTrainingByCommittee-1097"><a href="#CoTrainingByCommittee-1097"><span class="linenos">1097</span></a><span class="sd">    ----------</span>
</span><span id="CoTrainingByCommittee-1098"><a href="#CoTrainingByCommittee-1098"><span class="linenos">1098</span></a><span class="sd">    M. F. A. Hady and F. Schwenker,&lt;br&gt;</span>
</span><span id="CoTrainingByCommittee-1099"><a href="#CoTrainingByCommittee-1099"><span class="linenos">1099</span></a><span class="sd">    Co-training by Committee: A New Semi-supervised Learning Framework,&lt;br&gt;</span>
</span><span id="CoTrainingByCommittee-1100"><a href="#CoTrainingByCommittee-1100"><span class="linenos">1100</span></a><span class="sd">    in &lt;i&gt;2008 IEEE International Conference on Data Mining Workshops&lt;/i&gt;,&lt;br&gt;</span>
</span><span id="CoTrainingByCommittee-1101"><a href="#CoTrainingByCommittee-1101"><span class="linenos">1101</span></a><span class="sd">    Pisa, 2008, pp. 563-572,  [10.1109/ICDMW.2008.27](https://doi.org/10.1109/ICDMW.2008.27)</span>
</span><span id="CoTrainingByCommittee-1102"><a href="#CoTrainingByCommittee-1102"><span class="linenos">1102</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1103"><a href="#CoTrainingByCommittee-1103"><span class="linenos">1103</span></a>
</span><span id="CoTrainingByCommittee-1104"><a href="#CoTrainingByCommittee-1104"><span class="linenos">1104</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-1105"><a href="#CoTrainingByCommittee-1105"><span class="linenos">1105</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-1106"><a href="#CoTrainingByCommittee-1106"><span class="linenos">1106</span></a>        <span class="n">ensemble_estimator</span><span class="o">=</span><span class="n">BaggingClassifier</span><span class="p">(),</span>
</span><span id="CoTrainingByCommittee-1107"><a href="#CoTrainingByCommittee-1107"><span class="linenos">1107</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-1108"><a href="#CoTrainingByCommittee-1108"><span class="linenos">1108</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-1109"><a href="#CoTrainingByCommittee-1109"><span class="linenos">1109</span></a>        <span class="n">min_instances_for_class</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-1110"><a href="#CoTrainingByCommittee-1110"><span class="linenos">1110</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-1111"><a href="#CoTrainingByCommittee-1111"><span class="linenos">1111</span></a>    <span class="p">):</span>
</span><span id="CoTrainingByCommittee-1112"><a href="#CoTrainingByCommittee-1112"><span class="linenos">1112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1113"><a href="#CoTrainingByCommittee-1113"><span class="linenos">1113</span></a><span class="sd">        Create a committee trained by cotraining based on</span>
</span><span id="CoTrainingByCommittee-1114"><a href="#CoTrainingByCommittee-1114"><span class="linenos">1114</span></a><span class="sd">        the diversity of classifiers.</span>
</span><span id="CoTrainingByCommittee-1115"><a href="#CoTrainingByCommittee-1115"><span class="linenos">1115</span></a>
</span><span id="CoTrainingByCommittee-1116"><a href="#CoTrainingByCommittee-1116"><span class="linenos">1116</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-1117"><a href="#CoTrainingByCommittee-1117"><span class="linenos">1117</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-1118"><a href="#CoTrainingByCommittee-1118"><span class="linenos">1118</span></a><span class="sd">        ensemble_estimator : ClassifierMixin, optional</span>
</span><span id="CoTrainingByCommittee-1119"><a href="#CoTrainingByCommittee-1119"><span class="linenos">1119</span></a><span class="sd">            ensemble method, works without a ensemble as</span>
</span><span id="CoTrainingByCommittee-1120"><a href="#CoTrainingByCommittee-1120"><span class="linenos">1120</span></a><span class="sd">            self training with pool, by default BaggingClassifier().</span>
</span><span id="CoTrainingByCommittee-1121"><a href="#CoTrainingByCommittee-1121"><span class="linenos">1121</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="CoTrainingByCommittee-1122"><a href="#CoTrainingByCommittee-1122"><span class="linenos">1122</span></a><span class="sd">            number of iterations of training, -1 if no max iterations, by default 100</span>
</span><span id="CoTrainingByCommittee-1123"><a href="#CoTrainingByCommittee-1123"><span class="linenos">1123</span></a><span class="sd">        poolsize : int, optional</span>
</span><span id="CoTrainingByCommittee-1124"><a href="#CoTrainingByCommittee-1124"><span class="linenos">1124</span></a><span class="sd">            max number of unlabeled instances candidates to pseudolabel, by default 100</span>
</span><span id="CoTrainingByCommittee-1125"><a href="#CoTrainingByCommittee-1125"><span class="linenos">1125</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoTrainingByCommittee-1126"><a href="#CoTrainingByCommittee-1126"><span class="linenos">1126</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoTrainingByCommittee-1127"><a href="#CoTrainingByCommittee-1127"><span class="linenos">1127</span></a>
</span><span id="CoTrainingByCommittee-1128"><a href="#CoTrainingByCommittee-1128"><span class="linenos">1128</span></a>
</span><span id="CoTrainingByCommittee-1129"><a href="#CoTrainingByCommittee-1129"><span class="linenos">1129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1130"><a href="#CoTrainingByCommittee-1130"><span class="linenos">1130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">ensemble_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1131"><a href="#CoTrainingByCommittee-1131"><span class="linenos">1131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="CoTrainingByCommittee-1132"><a href="#CoTrainingByCommittee-1132"><span class="linenos">1132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="CoTrainingByCommittee-1133"><a href="#CoTrainingByCommittee-1133"><span class="linenos">1133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoTrainingByCommittee-1134"><a href="#CoTrainingByCommittee-1134"><span class="linenos">1134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span> <span class="o">=</span> <span class="n">min_instances_for_class</span>
</span><span id="CoTrainingByCommittee-1135"><a href="#CoTrainingByCommittee-1135"><span class="linenos">1135</span></a>
</span><span id="CoTrainingByCommittee-1136"><a href="#CoTrainingByCommittee-1136"><span class="linenos">1136</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1137"><a href="#CoTrainingByCommittee-1137"><span class="linenos">1137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a CoTrainingByCommittee classifier from the training set (X, y).</span>
</span><span id="CoTrainingByCommittee-1138"><a href="#CoTrainingByCommittee-1138"><span class="linenos">1138</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-1139"><a href="#CoTrainingByCommittee-1139"><span class="linenos">1139</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-1140"><a href="#CoTrainingByCommittee-1140"><span class="linenos">1140</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee-1141"><a href="#CoTrainingByCommittee-1141"><span class="linenos">1141</span></a><span class="sd">            The training input samples.</span>
</span><span id="CoTrainingByCommittee-1142"><a href="#CoTrainingByCommittee-1142"><span class="linenos">1142</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTrainingByCommittee-1143"><a href="#CoTrainingByCommittee-1143"><span class="linenos">1143</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="CoTrainingByCommittee-1144"><a href="#CoTrainingByCommittee-1144"><span class="linenos">1144</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee-1145"><a href="#CoTrainingByCommittee-1145"><span class="linenos">1145</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee-1146"><a href="#CoTrainingByCommittee-1146"><span class="linenos">1146</span></a><span class="sd">        self : CoTrainingByCommittee</span>
</span><span id="CoTrainingByCommittee-1147"><a href="#CoTrainingByCommittee-1147"><span class="linenos">1147</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoTrainingByCommittee-1148"><a href="#CoTrainingByCommittee-1148"><span class="linenos">1148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1149"><a href="#CoTrainingByCommittee-1149"><span class="linenos">1149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1150"><a href="#CoTrainingByCommittee-1150"><span class="linenos">1150</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1151"><a href="#CoTrainingByCommittee-1151"><span class="linenos">1151</span></a>
</span><span id="CoTrainingByCommittee-1152"><a href="#CoTrainingByCommittee-1152"><span class="linenos">1152</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_prev</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1153"><a href="#CoTrainingByCommittee-1153"><span class="linenos">1153</span></a>
</span><span id="CoTrainingByCommittee-1154"><a href="#CoTrainingByCommittee-1154"><span class="linenos">1154</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1155"><a href="#CoTrainingByCommittee-1155"><span class="linenos">1155</span></a>
</span><span id="CoTrainingByCommittee-1156"><a href="#CoTrainingByCommittee-1156"><span class="linenos">1156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="CoTrainingByCommittee-1157"><a href="#CoTrainingByCommittee-1157"><span class="linenos">1157</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_prev</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1158"><a href="#CoTrainingByCommittee-1158"><span class="linenos">1158</span></a>
</span><span id="CoTrainingByCommittee-1159"><a href="#CoTrainingByCommittee-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span>
</span><span id="CoTrainingByCommittee-1160"><a href="#CoTrainingByCommittee-1160"><span class="linenos">1160</span></a>
</span><span id="CoTrainingByCommittee-1161"><a href="#CoTrainingByCommittee-1161"><span class="linenos">1161</span></a>        <span class="n">prior</span> <span class="o">=</span> <span class="n">calculate_prior_probability</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1162"><a href="#CoTrainingByCommittee-1162"><span class="linenos">1162</span></a>        <span class="n">permutation</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">))</span>
</span><span id="CoTrainingByCommittee-1163"><a href="#CoTrainingByCommittee-1163"><span class="linenos">1163</span></a>
</span><span id="CoTrainingByCommittee-1164"><a href="#CoTrainingByCommittee-1164"><span class="linenos">1164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1165"><a href="#CoTrainingByCommittee-1165"><span class="linenos">1165</span></a>
</span><span id="CoTrainingByCommittee-1166"><a href="#CoTrainingByCommittee-1166"><span class="linenos">1166</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-1167"><a href="#CoTrainingByCommittee-1167"><span class="linenos">1167</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="CoTrainingByCommittee-1168"><a href="#CoTrainingByCommittee-1168"><span class="linenos">1168</span></a>
</span><span id="CoTrainingByCommittee-1169"><a href="#CoTrainingByCommittee-1169"><span class="linenos">1169</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1170"><a href="#CoTrainingByCommittee-1170"><span class="linenos">1170</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">permutation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-1171"><a href="#CoTrainingByCommittee-1171"><span class="linenos">1171</span></a>                <span class="k">break</span>
</span><span id="CoTrainingByCommittee-1172"><a href="#CoTrainingByCommittee-1172"><span class="linenos">1172</span></a>            <span class="n">raw_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-1173"><a href="#CoTrainingByCommittee-1173"><span class="linenos">1173</span></a>                <span class="n">X_unlabel</span><span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]]</span>
</span><span id="CoTrainingByCommittee-1174"><a href="#CoTrainingByCommittee-1174"><span class="linenos">1174</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee-1175"><a href="#CoTrainingByCommittee-1175"><span class="linenos">1175</span></a>
</span><span id="CoTrainingByCommittee-1176"><a href="#CoTrainingByCommittee-1176"><span class="linenos">1176</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1177"><a href="#CoTrainingByCommittee-1177"><span class="linenos">1177</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1178"><a href="#CoTrainingByCommittee-1178"><span class="linenos">1178</span></a>
</span><span id="CoTrainingByCommittee-1179"><a href="#CoTrainingByCommittee-1179"><span class="linenos">1179</span></a>            <span class="n">added</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1180"><a href="#CoTrainingByCommittee-1180"><span class="linenos">1180</span></a>            <span class="c1"># First the n (or less) most confidence instances will be selected</span>
</span><span id="CoTrainingByCommittee-1181"><a href="#CoTrainingByCommittee-1181"><span class="linenos">1181</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-1182"><a href="#CoTrainingByCommittee-1182"><span class="linenos">1182</span></a>                <span class="n">condition</span> <span class="o">=</span> <span class="n">class_predicted</span> <span class="o">==</span> <span class="n">c</span>
</span><span id="CoTrainingByCommittee-1183"><a href="#CoTrainingByCommittee-1183"><span class="linenos">1183</span></a>
</span><span id="CoTrainingByCommittee-1184"><a href="#CoTrainingByCommittee-1184"><span class="linenos">1184</span></a>                <span class="n">candidates</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee-1185"><a href="#CoTrainingByCommittee-1185"><span class="linenos">1185</span></a>                <span class="n">candidates_bool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1186"><a href="#CoTrainingByCommittee-1186"><span class="linenos">1186</span></a>                <span class="n">candidates_sub_set</span> <span class="o">=</span> <span class="n">candidates_bool</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee-1187"><a href="#CoTrainingByCommittee-1187"><span class="linenos">1187</span></a>
</span><span id="CoTrainingByCommittee-1188"><a href="#CoTrainingByCommittee-1188"><span class="linenos">1188</span></a>                <span class="n">instances_index_selected</span> <span class="o">=</span> <span class="n">candidates</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[</span>
</span><span id="CoTrainingByCommittee-1189"><a href="#CoTrainingByCommittee-1189"><span class="linenos">1189</span></a>                    <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-1190"><a href="#CoTrainingByCommittee-1190"><span class="linenos">1190</span></a>                <span class="p">]</span>
</span><span id="CoTrainingByCommittee-1191"><a href="#CoTrainingByCommittee-1191"><span class="linenos">1191</span></a>
</span><span id="CoTrainingByCommittee-1192"><a href="#CoTrainingByCommittee-1192"><span class="linenos">1192</span></a>                <span class="n">candidates_sub_set</span><span class="p">[</span><span class="n">instances_index_selected</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee-1193"><a href="#CoTrainingByCommittee-1193"><span class="linenos">1193</span></a>                <span class="n">candidates_bool</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span> <span class="o">+=</span> <span class="n">candidates_sub_set</span>
</span><span id="CoTrainingByCommittee-1194"><a href="#CoTrainingByCommittee-1194"><span class="linenos">1194</span></a>
</span><span id="CoTrainingByCommittee-1195"><a href="#CoTrainingByCommittee-1195"><span class="linenos">1195</span></a>                <span class="n">added</span><span class="p">[</span><span class="n">candidates_bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee-1196"><a href="#CoTrainingByCommittee-1196"><span class="linenos">1196</span></a>
</span><span id="CoTrainingByCommittee-1197"><a href="#CoTrainingByCommittee-1197"><span class="linenos">1197</span></a>            <span class="c1"># Bajo esta interpretación se garantiza que al menos existen n elemento de cada clase por iteración</span>
</span><span id="CoTrainingByCommittee-1198"><a href="#CoTrainingByCommittee-1198"><span class="linenos">1198</span></a>            <span class="c1"># Pero si se añaden ya en el proceso de proporción no se duplica.</span>
</span><span id="CoTrainingByCommittee-1199"><a href="#CoTrainingByCommittee-1199"><span class="linenos">1199</span></a>
</span><span id="CoTrainingByCommittee-1200"><a href="#CoTrainingByCommittee-1200"><span class="linenos">1200</span></a>            <span class="c1"># Con esta otra interpretación ignora las n primeras instancias de cada clase</span>
</span><span id="CoTrainingByCommittee-1201"><a href="#CoTrainingByCommittee-1201"><span class="linenos">1201</span></a>            <span class="n">to_label</span> <span class="o">=</span> <span class="n">choice_with_proportion</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-1202"><a href="#CoTrainingByCommittee-1202"><span class="linenos">1202</span></a>                <span class="n">predictions</span><span class="p">,</span> <span class="n">class_predicted</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span>
</span><span id="CoTrainingByCommittee-1203"><a href="#CoTrainingByCommittee-1203"><span class="linenos">1203</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee-1204"><a href="#CoTrainingByCommittee-1204"><span class="linenos">1204</span></a>            <span class="n">added</span><span class="p">[</span><span class="n">to_label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee-1205"><a href="#CoTrainingByCommittee-1205"><span class="linenos">1205</span></a>
</span><span id="CoTrainingByCommittee-1206"><a href="#CoTrainingByCommittee-1206"><span class="linenos">1206</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">][</span><span class="n">added</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee-1207"><a href="#CoTrainingByCommittee-1207"><span class="linenos">1207</span></a>            <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-1208"><a href="#CoTrainingByCommittee-1208"><span class="linenos">1208</span></a>                <span class="p">[</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]]</span>
</span><span id="CoTrainingByCommittee-1209"><a href="#CoTrainingByCommittee-1209"><span class="linenos">1209</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee-1210"><a href="#CoTrainingByCommittee-1210"><span class="linenos">1210</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="n">class_predicted</span><span class="p">[</span><span class="n">added</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee-1211"><a href="#CoTrainingByCommittee-1211"><span class="linenos">1211</span></a>
</span><span id="CoTrainingByCommittee-1212"><a href="#CoTrainingByCommittee-1212"><span class="linenos">1212</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">pseudoy</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1213"><a href="#CoTrainingByCommittee-1213"><span class="linenos">1213</span></a>            <span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">,</span> <span class="n">permutation</span><span class="p">))]</span>
</span><span id="CoTrainingByCommittee-1214"><a href="#CoTrainingByCommittee-1214"><span class="linenos">1214</span></a>
</span><span id="CoTrainingByCommittee-1215"><a href="#CoTrainingByCommittee-1215"><span class="linenos">1215</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1216"><a href="#CoTrainingByCommittee-1216"><span class="linenos">1216</span></a>
</span><span id="CoTrainingByCommittee-1217"><a href="#CoTrainingByCommittee-1217"><span class="linenos">1217</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="CoTrainingByCommittee-1218"><a href="#CoTrainingByCommittee-1218"><span class="linenos">1218</span></a>
</span><span id="CoTrainingByCommittee-1219"><a href="#CoTrainingByCommittee-1219"><span class="linenos">1219</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1220"><a href="#CoTrainingByCommittee-1220"><span class="linenos">1220</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class value for X.</span>
</span><span id="CoTrainingByCommittee-1221"><a href="#CoTrainingByCommittee-1221"><span class="linenos">1221</span></a><span class="sd">        For a classification model, the predicted class for each sample in X is returned.</span>
</span><span id="CoTrainingByCommittee-1222"><a href="#CoTrainingByCommittee-1222"><span class="linenos">1222</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-1223"><a href="#CoTrainingByCommittee-1223"><span class="linenos">1223</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-1224"><a href="#CoTrainingByCommittee-1224"><span class="linenos">1224</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee-1225"><a href="#CoTrainingByCommittee-1225"><span class="linenos">1225</span></a><span class="sd">            The input samples.</span>
</span><span id="CoTrainingByCommittee-1226"><a href="#CoTrainingByCommittee-1226"><span class="linenos">1226</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee-1227"><a href="#CoTrainingByCommittee-1227"><span class="linenos">1227</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee-1228"><a href="#CoTrainingByCommittee-1228"><span class="linenos">1228</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTrainingByCommittee-1229"><a href="#CoTrainingByCommittee-1229"><span class="linenos">1229</span></a><span class="sd">            The predicted classes</span>
</span><span id="CoTrainingByCommittee-1230"><a href="#CoTrainingByCommittee-1230"><span class="linenos">1230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1231"><a href="#CoTrainingByCommittee-1231"><span class="linenos">1231</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1232"><a href="#CoTrainingByCommittee-1232"><span class="linenos">1232</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span><span id="CoTrainingByCommittee-1233"><a href="#CoTrainingByCommittee-1233"><span class="linenos">1233</span></a>
</span><span id="CoTrainingByCommittee-1234"><a href="#CoTrainingByCommittee-1234"><span class="linenos">1234</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1235"><a href="#CoTrainingByCommittee-1235"><span class="linenos">1235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class probabilities of the input samples X.</span>
</span><span id="CoTrainingByCommittee-1236"><a href="#CoTrainingByCommittee-1236"><span class="linenos">1236</span></a><span class="sd">        The predicted class probability depends on the ensemble estimator.</span>
</span><span id="CoTrainingByCommittee-1237"><a href="#CoTrainingByCommittee-1237"><span class="linenos">1237</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-1238"><a href="#CoTrainingByCommittee-1238"><span class="linenos">1238</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-1239"><a href="#CoTrainingByCommittee-1239"><span class="linenos">1239</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee-1240"><a href="#CoTrainingByCommittee-1240"><span class="linenos">1240</span></a><span class="sd">            The input samples.</span>
</span><span id="CoTrainingByCommittee-1241"><a href="#CoTrainingByCommittee-1241"><span class="linenos">1241</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee-1242"><a href="#CoTrainingByCommittee-1242"><span class="linenos">1242</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee-1243"><a href="#CoTrainingByCommittee-1243"><span class="linenos">1243</span></a><span class="sd">        y : ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1</span>
</span><span id="CoTrainingByCommittee-1244"><a href="#CoTrainingByCommittee-1244"><span class="linenos">1244</span></a><span class="sd">            The predicted classes</span>
</span><span id="CoTrainingByCommittee-1245"><a href="#CoTrainingByCommittee-1245"><span class="linenos">1245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1246"><a href="#CoTrainingByCommittee-1246"><span class="linenos">1246</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1247"><a href="#CoTrainingByCommittee-1247"><span class="linenos">1247</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1248"><a href="#CoTrainingByCommittee-1248"><span class="linenos">1248</span></a>
</span><span id="CoTrainingByCommittee-1249"><a href="#CoTrainingByCommittee-1249"><span class="linenos">1249</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1250"><a href="#CoTrainingByCommittee-1250"><span class="linenos">1250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTrainingByCommittee-1251"><a href="#CoTrainingByCommittee-1251"><span class="linenos">1251</span></a><span class="sd">        In multi-label classification, this is the subset accuracy which is a harsh metric since you require for each sample that each label set be correctly predicted.</span>
</span><span id="CoTrainingByCommittee-1252"><a href="#CoTrainingByCommittee-1252"><span class="linenos">1252</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-1253"><a href="#CoTrainingByCommittee-1253"><span class="linenos">1253</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-1254"><a href="#CoTrainingByCommittee-1254"><span class="linenos">1254</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee-1255"><a href="#CoTrainingByCommittee-1255"><span class="linenos">1255</span></a><span class="sd">            Test samples.</span>
</span><span id="CoTrainingByCommittee-1256"><a href="#CoTrainingByCommittee-1256"><span class="linenos">1256</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="CoTrainingByCommittee-1257"><a href="#CoTrainingByCommittee-1257"><span class="linenos">1257</span></a><span class="sd">            True labels for X.</span>
</span><span id="CoTrainingByCommittee-1258"><a href="#CoTrainingByCommittee-1258"><span class="linenos">1258</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), optional</span>
</span><span id="CoTrainingByCommittee-1259"><a href="#CoTrainingByCommittee-1259"><span class="linenos">1259</span></a><span class="sd">            Sample weights., by default None</span>
</span><span id="CoTrainingByCommittee-1260"><a href="#CoTrainingByCommittee-1260"><span class="linenos">1260</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee-1261"><a href="#CoTrainingByCommittee-1261"><span class="linenos">1261</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee-1262"><a href="#CoTrainingByCommittee-1262"><span class="linenos">1262</span></a><span class="sd">        score: float</span>
</span><span id="CoTrainingByCommittee-1263"><a href="#CoTrainingByCommittee-1263"><span class="linenos">1263</span></a><span class="sd">            Mean accuracy of self.predict(X) wrt. y.</span>
</span><span id="CoTrainingByCommittee-1264"><a href="#CoTrainingByCommittee-1264"><span class="linenos">1264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1265"><a href="#CoTrainingByCommittee-1265"><span class="linenos">1265</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-1266"><a href="#CoTrainingByCommittee-1266"><span class="linenos">1266</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1267"><a href="#CoTrainingByCommittee-1267"><span class="linenos">1267</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-1268"><a href="#CoTrainingByCommittee-1268"><span class="linenos">1268</span></a>            <span class="k">if</span> <span class="s2">&quot;le_dict_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1269"><a href="#CoTrainingByCommittee-1269"><span class="linenos">1269</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">le_dict_</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-1270"><a href="#CoTrainingByCommittee-1270"><span class="linenos">1270</span></a>                    <span class="nb">zip</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-1271"><a href="#CoTrainingByCommittee-1271"><span class="linenos">1271</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-1272"><a href="#CoTrainingByCommittee-1272"><span class="linenos">1272</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span><span class="p">),</span>
</span><span id="CoTrainingByCommittee-1273"><a href="#CoTrainingByCommittee-1273"><span class="linenos">1273</span></a>                    <span class="p">)</span>
</span><span id="CoTrainingByCommittee-1274"><a href="#CoTrainingByCommittee-1274"><span class="linenos">1274</span></a>                <span class="p">)</span>
</span><span id="CoTrainingByCommittee-1275"><a href="#CoTrainingByCommittee-1275"><span class="linenos">1275</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">le_dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1276"><a href="#CoTrainingByCommittee-1276"><span class="linenos">1276</span></a>
</span><span id="CoTrainingByCommittee-1277"><a href="#CoTrainingByCommittee-1277"><span class="linenos">1277</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h2 id="co-training-by-committee-classifier"><strong>Co-Training by Committee classifier.</strong></h2>

<p>Create a committee trained by co-training based on the diversity of the classifiers</p>

<p>The main process is:</p>

<ol>
<li>Train a committee of classifiers.</li>
<li>Create a pool of unlabeled instances.</li>
<li>While max iterations is not reached or any instance is unlabeled:
<ol>
<li>Predict the instances from the unlabeled set.</li>
<li>Select the instances with the highest probability.</li>
<li>Label the instances with the highest probability, keeping the balance of the classes but ensuring that at least n instances of each class are added.</li>
<li>Retrain the classifier with the new instances.</li>
</ol></li>
<li>Combine the probabilities of each classifier.</li>
</ol>

<h2 id="methods"><strong>Methods</strong></h2>

<ul>
<li><code><a href="#CoTrainingByCommittee.fit">fit</a></code>: Fit the model with the labeled instances.</li>
<li><code><a href="#CoTrainingByCommittee.predict">predict</a></code> : Predict the class for each instance.</li>
<li><code><a href="#CoTrainingByCommittee.predict_proba">predict_proba</a></code>: Predict the probability for each class.</li>
<li><code><a href="#CoTrainingByCommittee.score">score</a></code>: Return the mean accuracy on the given test data and labels.</li>
</ul>

<h2 id="example"><strong>Example</strong></h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn"><a href="">sslearn.wrapper</a></span> <span class="kn">import</span> <span class="n">CoTrainingByCommittee</span>
<span class="kn">from</span> <span class="nn"><a href="model_selection.html">sslearn.model_selection</a></span> <span class="kn">import</span> <span class="n">artificial_ssl_dataset</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">artificial_ssl_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cotraining</span> <span class="o">=</span> <span class="n">CoTrainingByCommittee</span><span class="p">()</span>
<span class="n">cotraining</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">cotraining</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="references"><strong>References</strong></h2>

<p>M. F. A. Hady and F. Schwenker,<br>
Co-training by Committee: A New Semi-supervised Learning Framework,<br>
in <i>2008 IEEE International Conference on Data Mining Workshops</i>,<br>
Pisa, 2008, pp. 563-572,  <a href="https://doi.org/10.1109/ICDMW.2008.27">10.1109/ICDMW.2008.27</a></p>
</div>


                            <div id="CoTrainingByCommittee.__init__" class="classattr">
                                        <input id="CoTrainingByCommittee.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CoTrainingByCommittee</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">ensemble_estimator</span><span class="o">=</span><span class="n">BaggingClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">poolsize</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">min_instances_for_class</span><span class="o">=</span><span class="mi">3</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="CoTrainingByCommittee.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.__init__-1104"><a href="#CoTrainingByCommittee.__init__-1104"><span class="linenos">1104</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.__init__-1105"><a href="#CoTrainingByCommittee.__init__-1105"><span class="linenos">1105</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-1106"><a href="#CoTrainingByCommittee.__init__-1106"><span class="linenos">1106</span></a>        <span class="n">ensemble_estimator</span><span class="o">=</span><span class="n">BaggingClassifier</span><span class="p">(),</span>
</span><span id="CoTrainingByCommittee.__init__-1107"><a href="#CoTrainingByCommittee.__init__-1107"><span class="linenos">1107</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-1108"><a href="#CoTrainingByCommittee.__init__-1108"><span class="linenos">1108</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-1109"><a href="#CoTrainingByCommittee.__init__-1109"><span class="linenos">1109</span></a>        <span class="n">min_instances_for_class</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-1110"><a href="#CoTrainingByCommittee.__init__-1110"><span class="linenos">1110</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-1111"><a href="#CoTrainingByCommittee.__init__-1111"><span class="linenos">1111</span></a>    <span class="p">):</span>
</span><span id="CoTrainingByCommittee.__init__-1112"><a href="#CoTrainingByCommittee.__init__-1112"><span class="linenos">1112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.__init__-1113"><a href="#CoTrainingByCommittee.__init__-1113"><span class="linenos">1113</span></a><span class="sd">        Create a committee trained by cotraining based on</span>
</span><span id="CoTrainingByCommittee.__init__-1114"><a href="#CoTrainingByCommittee.__init__-1114"><span class="linenos">1114</span></a><span class="sd">        the diversity of classifiers.</span>
</span><span id="CoTrainingByCommittee.__init__-1115"><a href="#CoTrainingByCommittee.__init__-1115"><span class="linenos">1115</span></a>
</span><span id="CoTrainingByCommittee.__init__-1116"><a href="#CoTrainingByCommittee.__init__-1116"><span class="linenos">1116</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.__init__-1117"><a href="#CoTrainingByCommittee.__init__-1117"><span class="linenos">1117</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.__init__-1118"><a href="#CoTrainingByCommittee.__init__-1118"><span class="linenos">1118</span></a><span class="sd">        ensemble_estimator : ClassifierMixin, optional</span>
</span><span id="CoTrainingByCommittee.__init__-1119"><a href="#CoTrainingByCommittee.__init__-1119"><span class="linenos">1119</span></a><span class="sd">            ensemble method, works without a ensemble as</span>
</span><span id="CoTrainingByCommittee.__init__-1120"><a href="#CoTrainingByCommittee.__init__-1120"><span class="linenos">1120</span></a><span class="sd">            self training with pool, by default BaggingClassifier().</span>
</span><span id="CoTrainingByCommittee.__init__-1121"><a href="#CoTrainingByCommittee.__init__-1121"><span class="linenos">1121</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="CoTrainingByCommittee.__init__-1122"><a href="#CoTrainingByCommittee.__init__-1122"><span class="linenos">1122</span></a><span class="sd">            number of iterations of training, -1 if no max iterations, by default 100</span>
</span><span id="CoTrainingByCommittee.__init__-1123"><a href="#CoTrainingByCommittee.__init__-1123"><span class="linenos">1123</span></a><span class="sd">        poolsize : int, optional</span>
</span><span id="CoTrainingByCommittee.__init__-1124"><a href="#CoTrainingByCommittee.__init__-1124"><span class="linenos">1124</span></a><span class="sd">            max number of unlabeled instances candidates to pseudolabel, by default 100</span>
</span><span id="CoTrainingByCommittee.__init__-1125"><a href="#CoTrainingByCommittee.__init__-1125"><span class="linenos">1125</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoTrainingByCommittee.__init__-1126"><a href="#CoTrainingByCommittee.__init__-1126"><span class="linenos">1126</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoTrainingByCommittee.__init__-1127"><a href="#CoTrainingByCommittee.__init__-1127"><span class="linenos">1127</span></a>
</span><span id="CoTrainingByCommittee.__init__-1128"><a href="#CoTrainingByCommittee.__init__-1128"><span class="linenos">1128</span></a>
</span><span id="CoTrainingByCommittee.__init__-1129"><a href="#CoTrainingByCommittee.__init__-1129"><span class="linenos">1129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.__init__-1130"><a href="#CoTrainingByCommittee.__init__-1130"><span class="linenos">1130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">ensemble_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.__init__-1131"><a href="#CoTrainingByCommittee.__init__-1131"><span class="linenos">1131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="CoTrainingByCommittee.__init__-1132"><a href="#CoTrainingByCommittee.__init__-1132"><span class="linenos">1132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="CoTrainingByCommittee.__init__-1133"><a href="#CoTrainingByCommittee.__init__-1133"><span class="linenos">1133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoTrainingByCommittee.__init__-1134"><a href="#CoTrainingByCommittee.__init__-1134"><span class="linenos">1134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span> <span class="o">=</span> <span class="n">min_instances_for_class</span>
</span></pre></div>


            <div class="docstring"><p>Create a committee trained by cotraining based on
the diversity of classifiers.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ensemble_estimator</strong> (ClassifierMixin, optional):
ensemble method, works without a ensemble as
self training with pool, by default BaggingClassifier().</li>
<li><strong>max_iterations</strong> (int, optional):
number of iterations of training, -1 if no max iterations, by default 100</li>
<li><strong>poolsize</strong> (int, optional):
max number of unlabeled instances candidates to pseudolabel, by default 100</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.fit" class="classattr">
                                        <input id="CoTrainingByCommittee.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTrainingByCommittee.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.fit-1136"><a href="#CoTrainingByCommittee.fit-1136"><span class="linenos">1136</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.fit-1137"><a href="#CoTrainingByCommittee.fit-1137"><span class="linenos">1137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a CoTrainingByCommittee classifier from the training set (X, y).</span>
</span><span id="CoTrainingByCommittee.fit-1138"><a href="#CoTrainingByCommittee.fit-1138"><span class="linenos">1138</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.fit-1139"><a href="#CoTrainingByCommittee.fit-1139"><span class="linenos">1139</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.fit-1140"><a href="#CoTrainingByCommittee.fit-1140"><span class="linenos">1140</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee.fit-1141"><a href="#CoTrainingByCommittee.fit-1141"><span class="linenos">1141</span></a><span class="sd">            The training input samples.</span>
</span><span id="CoTrainingByCommittee.fit-1142"><a href="#CoTrainingByCommittee.fit-1142"><span class="linenos">1142</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTrainingByCommittee.fit-1143"><a href="#CoTrainingByCommittee.fit-1143"><span class="linenos">1143</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="CoTrainingByCommittee.fit-1144"><a href="#CoTrainingByCommittee.fit-1144"><span class="linenos">1144</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee.fit-1145"><a href="#CoTrainingByCommittee.fit-1145"><span class="linenos">1145</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee.fit-1146"><a href="#CoTrainingByCommittee.fit-1146"><span class="linenos">1146</span></a><span class="sd">        self : CoTrainingByCommittee</span>
</span><span id="CoTrainingByCommittee.fit-1147"><a href="#CoTrainingByCommittee.fit-1147"><span class="linenos">1147</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoTrainingByCommittee.fit-1148"><a href="#CoTrainingByCommittee.fit-1148"><span class="linenos">1148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.fit-1149"><a href="#CoTrainingByCommittee.fit-1149"><span class="linenos">1149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1150"><a href="#CoTrainingByCommittee.fit-1150"><span class="linenos">1150</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1151"><a href="#CoTrainingByCommittee.fit-1151"><span class="linenos">1151</span></a>
</span><span id="CoTrainingByCommittee.fit-1152"><a href="#CoTrainingByCommittee.fit-1152"><span class="linenos">1152</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_prev</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1153"><a href="#CoTrainingByCommittee.fit-1153"><span class="linenos">1153</span></a>
</span><span id="CoTrainingByCommittee.fit-1154"><a href="#CoTrainingByCommittee.fit-1154"><span class="linenos">1154</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1155"><a href="#CoTrainingByCommittee.fit-1155"><span class="linenos">1155</span></a>
</span><span id="CoTrainingByCommittee.fit-1156"><a href="#CoTrainingByCommittee.fit-1156"><span class="linenos">1156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="CoTrainingByCommittee.fit-1157"><a href="#CoTrainingByCommittee.fit-1157"><span class="linenos">1157</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_prev</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1158"><a href="#CoTrainingByCommittee.fit-1158"><span class="linenos">1158</span></a>
</span><span id="CoTrainingByCommittee.fit-1159"><a href="#CoTrainingByCommittee.fit-1159"><span class="linenos">1159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span>
</span><span id="CoTrainingByCommittee.fit-1160"><a href="#CoTrainingByCommittee.fit-1160"><span class="linenos">1160</span></a>
</span><span id="CoTrainingByCommittee.fit-1161"><a href="#CoTrainingByCommittee.fit-1161"><span class="linenos">1161</span></a>        <span class="n">prior</span> <span class="o">=</span> <span class="n">calculate_prior_probability</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1162"><a href="#CoTrainingByCommittee.fit-1162"><span class="linenos">1162</span></a>        <span class="n">permutation</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">))</span>
</span><span id="CoTrainingByCommittee.fit-1163"><a href="#CoTrainingByCommittee.fit-1163"><span class="linenos">1163</span></a>
</span><span id="CoTrainingByCommittee.fit-1164"><a href="#CoTrainingByCommittee.fit-1164"><span class="linenos">1164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1165"><a href="#CoTrainingByCommittee.fit-1165"><span class="linenos">1165</span></a>
</span><span id="CoTrainingByCommittee.fit-1166"><a href="#CoTrainingByCommittee.fit-1166"><span class="linenos">1166</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.fit-1167"><a href="#CoTrainingByCommittee.fit-1167"><span class="linenos">1167</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="CoTrainingByCommittee.fit-1168"><a href="#CoTrainingByCommittee.fit-1168"><span class="linenos">1168</span></a>
</span><span id="CoTrainingByCommittee.fit-1169"><a href="#CoTrainingByCommittee.fit-1169"><span class="linenos">1169</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.fit-1170"><a href="#CoTrainingByCommittee.fit-1170"><span class="linenos">1170</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">permutation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.fit-1171"><a href="#CoTrainingByCommittee.fit-1171"><span class="linenos">1171</span></a>                <span class="k">break</span>
</span><span id="CoTrainingByCommittee.fit-1172"><a href="#CoTrainingByCommittee.fit-1172"><span class="linenos">1172</span></a>            <span class="n">raw_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.fit-1173"><a href="#CoTrainingByCommittee.fit-1173"><span class="linenos">1173</span></a>                <span class="n">X_unlabel</span><span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]]</span>
</span><span id="CoTrainingByCommittee.fit-1174"><a href="#CoTrainingByCommittee.fit-1174"><span class="linenos">1174</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1175"><a href="#CoTrainingByCommittee.fit-1175"><span class="linenos">1175</span></a>
</span><span id="CoTrainingByCommittee.fit-1176"><a href="#CoTrainingByCommittee.fit-1176"><span class="linenos">1176</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1177"><a href="#CoTrainingByCommittee.fit-1177"><span class="linenos">1177</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1178"><a href="#CoTrainingByCommittee.fit-1178"><span class="linenos">1178</span></a>
</span><span id="CoTrainingByCommittee.fit-1179"><a href="#CoTrainingByCommittee.fit-1179"><span class="linenos">1179</span></a>            <span class="n">added</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1180"><a href="#CoTrainingByCommittee.fit-1180"><span class="linenos">1180</span></a>            <span class="c1"># First the n (or less) most confidence instances will be selected</span>
</span><span id="CoTrainingByCommittee.fit-1181"><a href="#CoTrainingByCommittee.fit-1181"><span class="linenos">1181</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.fit-1182"><a href="#CoTrainingByCommittee.fit-1182"><span class="linenos">1182</span></a>                <span class="n">condition</span> <span class="o">=</span> <span class="n">class_predicted</span> <span class="o">==</span> <span class="n">c</span>
</span><span id="CoTrainingByCommittee.fit-1183"><a href="#CoTrainingByCommittee.fit-1183"><span class="linenos">1183</span></a>
</span><span id="CoTrainingByCommittee.fit-1184"><a href="#CoTrainingByCommittee.fit-1184"><span class="linenos">1184</span></a>                <span class="n">candidates</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-1185"><a href="#CoTrainingByCommittee.fit-1185"><span class="linenos">1185</span></a>                <span class="n">candidates_bool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1186"><a href="#CoTrainingByCommittee.fit-1186"><span class="linenos">1186</span></a>                <span class="n">candidates_sub_set</span> <span class="o">=</span> <span class="n">candidates_bool</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-1187"><a href="#CoTrainingByCommittee.fit-1187"><span class="linenos">1187</span></a>
</span><span id="CoTrainingByCommittee.fit-1188"><a href="#CoTrainingByCommittee.fit-1188"><span class="linenos">1188</span></a>                <span class="n">instances_index_selected</span> <span class="o">=</span> <span class="n">candidates</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[</span>
</span><span id="CoTrainingByCommittee.fit-1189"><a href="#CoTrainingByCommittee.fit-1189"><span class="linenos">1189</span></a>                    <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.fit-1190"><a href="#CoTrainingByCommittee.fit-1190"><span class="linenos">1190</span></a>                <span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-1191"><a href="#CoTrainingByCommittee.fit-1191"><span class="linenos">1191</span></a>
</span><span id="CoTrainingByCommittee.fit-1192"><a href="#CoTrainingByCommittee.fit-1192"><span class="linenos">1192</span></a>                <span class="n">candidates_sub_set</span><span class="p">[</span><span class="n">instances_index_selected</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee.fit-1193"><a href="#CoTrainingByCommittee.fit-1193"><span class="linenos">1193</span></a>                <span class="n">candidates_bool</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span> <span class="o">+=</span> <span class="n">candidates_sub_set</span>
</span><span id="CoTrainingByCommittee.fit-1194"><a href="#CoTrainingByCommittee.fit-1194"><span class="linenos">1194</span></a>
</span><span id="CoTrainingByCommittee.fit-1195"><a href="#CoTrainingByCommittee.fit-1195"><span class="linenos">1195</span></a>                <span class="n">added</span><span class="p">[</span><span class="n">candidates_bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee.fit-1196"><a href="#CoTrainingByCommittee.fit-1196"><span class="linenos">1196</span></a>
</span><span id="CoTrainingByCommittee.fit-1197"><a href="#CoTrainingByCommittee.fit-1197"><span class="linenos">1197</span></a>            <span class="c1"># Bajo esta interpretación se garantiza que al menos existen n elemento de cada clase por iteración</span>
</span><span id="CoTrainingByCommittee.fit-1198"><a href="#CoTrainingByCommittee.fit-1198"><span class="linenos">1198</span></a>            <span class="c1"># Pero si se añaden ya en el proceso de proporción no se duplica.</span>
</span><span id="CoTrainingByCommittee.fit-1199"><a href="#CoTrainingByCommittee.fit-1199"><span class="linenos">1199</span></a>
</span><span id="CoTrainingByCommittee.fit-1200"><a href="#CoTrainingByCommittee.fit-1200"><span class="linenos">1200</span></a>            <span class="c1"># Con esta otra interpretación ignora las n primeras instancias de cada clase</span>
</span><span id="CoTrainingByCommittee.fit-1201"><a href="#CoTrainingByCommittee.fit-1201"><span class="linenos">1201</span></a>            <span class="n">to_label</span> <span class="o">=</span> <span class="n">choice_with_proportion</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.fit-1202"><a href="#CoTrainingByCommittee.fit-1202"><span class="linenos">1202</span></a>                <span class="n">predictions</span><span class="p">,</span> <span class="n">class_predicted</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span>
</span><span id="CoTrainingByCommittee.fit-1203"><a href="#CoTrainingByCommittee.fit-1203"><span class="linenos">1203</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1204"><a href="#CoTrainingByCommittee.fit-1204"><span class="linenos">1204</span></a>            <span class="n">added</span><span class="p">[</span><span class="n">to_label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee.fit-1205"><a href="#CoTrainingByCommittee.fit-1205"><span class="linenos">1205</span></a>
</span><span id="CoTrainingByCommittee.fit-1206"><a href="#CoTrainingByCommittee.fit-1206"><span class="linenos">1206</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">][</span><span class="n">added</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-1207"><a href="#CoTrainingByCommittee.fit-1207"><span class="linenos">1207</span></a>            <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.fit-1208"><a href="#CoTrainingByCommittee.fit-1208"><span class="linenos">1208</span></a>                <span class="p">[</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]]</span>
</span><span id="CoTrainingByCommittee.fit-1209"><a href="#CoTrainingByCommittee.fit-1209"><span class="linenos">1209</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1210"><a href="#CoTrainingByCommittee.fit-1210"><span class="linenos">1210</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="n">class_predicted</span><span class="p">[</span><span class="n">added</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-1211"><a href="#CoTrainingByCommittee.fit-1211"><span class="linenos">1211</span></a>
</span><span id="CoTrainingByCommittee.fit-1212"><a href="#CoTrainingByCommittee.fit-1212"><span class="linenos">1212</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">pseudoy</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1213"><a href="#CoTrainingByCommittee.fit-1213"><span class="linenos">1213</span></a>            <span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">,</span> <span class="n">permutation</span><span class="p">))]</span>
</span><span id="CoTrainingByCommittee.fit-1214"><a href="#CoTrainingByCommittee.fit-1214"><span class="linenos">1214</span></a>
</span><span id="CoTrainingByCommittee.fit-1215"><a href="#CoTrainingByCommittee.fit-1215"><span class="linenos">1215</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-1216"><a href="#CoTrainingByCommittee.fit-1216"><span class="linenos">1216</span></a>
</span><span id="CoTrainingByCommittee.fit-1217"><a href="#CoTrainingByCommittee.fit-1217"><span class="linenos">1217</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a CoTrainingByCommittee classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (CoTrainingByCommittee):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.predict" class="classattr">
                                        <input id="CoTrainingByCommittee.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTrainingByCommittee.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.predict-1219"><a href="#CoTrainingByCommittee.predict-1219"><span class="linenos">1219</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.predict-1220"><a href="#CoTrainingByCommittee.predict-1220"><span class="linenos">1220</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class value for X.</span>
</span><span id="CoTrainingByCommittee.predict-1221"><a href="#CoTrainingByCommittee.predict-1221"><span class="linenos">1221</span></a><span class="sd">        For a classification model, the predicted class for each sample in X is returned.</span>
</span><span id="CoTrainingByCommittee.predict-1222"><a href="#CoTrainingByCommittee.predict-1222"><span class="linenos">1222</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.predict-1223"><a href="#CoTrainingByCommittee.predict-1223"><span class="linenos">1223</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.predict-1224"><a href="#CoTrainingByCommittee.predict-1224"><span class="linenos">1224</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee.predict-1225"><a href="#CoTrainingByCommittee.predict-1225"><span class="linenos">1225</span></a><span class="sd">            The input samples.</span>
</span><span id="CoTrainingByCommittee.predict-1226"><a href="#CoTrainingByCommittee.predict-1226"><span class="linenos">1226</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee.predict-1227"><a href="#CoTrainingByCommittee.predict-1227"><span class="linenos">1227</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee.predict-1228"><a href="#CoTrainingByCommittee.predict-1228"><span class="linenos">1228</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTrainingByCommittee.predict-1229"><a href="#CoTrainingByCommittee.predict-1229"><span class="linenos">1229</span></a><span class="sd">            The predicted classes</span>
</span><span id="CoTrainingByCommittee.predict-1230"><a href="#CoTrainingByCommittee.predict-1230"><span class="linenos">1230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.predict-1231"><a href="#CoTrainingByCommittee.predict-1231"><span class="linenos">1231</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.predict-1232"><a href="#CoTrainingByCommittee.predict-1232"><span class="linenos">1232</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Predict class value for X.
For a classification model, the predicted class for each sample in X is returned.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The input samples.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The predicted classes</li>
</ul>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.predict_proba" class="classattr">
                                        <input id="CoTrainingByCommittee.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTrainingByCommittee.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.predict_proba-1234"><a href="#CoTrainingByCommittee.predict_proba-1234"><span class="linenos">1234</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.predict_proba-1235"><a href="#CoTrainingByCommittee.predict_proba-1235"><span class="linenos">1235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class probabilities of the input samples X.</span>
</span><span id="CoTrainingByCommittee.predict_proba-1236"><a href="#CoTrainingByCommittee.predict_proba-1236"><span class="linenos">1236</span></a><span class="sd">        The predicted class probability depends on the ensemble estimator.</span>
</span><span id="CoTrainingByCommittee.predict_proba-1237"><a href="#CoTrainingByCommittee.predict_proba-1237"><span class="linenos">1237</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.predict_proba-1238"><a href="#CoTrainingByCommittee.predict_proba-1238"><span class="linenos">1238</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.predict_proba-1239"><a href="#CoTrainingByCommittee.predict_proba-1239"><span class="linenos">1239</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee.predict_proba-1240"><a href="#CoTrainingByCommittee.predict_proba-1240"><span class="linenos">1240</span></a><span class="sd">            The input samples.</span>
</span><span id="CoTrainingByCommittee.predict_proba-1241"><a href="#CoTrainingByCommittee.predict_proba-1241"><span class="linenos">1241</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee.predict_proba-1242"><a href="#CoTrainingByCommittee.predict_proba-1242"><span class="linenos">1242</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee.predict_proba-1243"><a href="#CoTrainingByCommittee.predict_proba-1243"><span class="linenos">1243</span></a><span class="sd">        y : ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1</span>
</span><span id="CoTrainingByCommittee.predict_proba-1244"><a href="#CoTrainingByCommittee.predict_proba-1244"><span class="linenos">1244</span></a><span class="sd">            The predicted classes</span>
</span><span id="CoTrainingByCommittee.predict_proba-1245"><a href="#CoTrainingByCommittee.predict_proba-1245"><span class="linenos">1245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.predict_proba-1246"><a href="#CoTrainingByCommittee.predict_proba-1246"><span class="linenos">1246</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.predict_proba-1247"><a href="#CoTrainingByCommittee.predict_proba-1247"><span class="linenos">1247</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict class probabilities of the input samples X.
The predicted class probability depends on the ensemble estimator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The input samples.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1):
The predicted classes</li>
</ul>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.score" class="classattr">
                                        <input id="CoTrainingByCommittee.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTrainingByCommittee.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.score-1249"><a href="#CoTrainingByCommittee.score-1249"><span class="linenos">1249</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.score-1250"><a href="#CoTrainingByCommittee.score-1250"><span class="linenos">1250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTrainingByCommittee.score-1251"><a href="#CoTrainingByCommittee.score-1251"><span class="linenos">1251</span></a><span class="sd">        In multi-label classification, this is the subset accuracy which is a harsh metric since you require for each sample that each label set be correctly predicted.</span>
</span><span id="CoTrainingByCommittee.score-1252"><a href="#CoTrainingByCommittee.score-1252"><span class="linenos">1252</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.score-1253"><a href="#CoTrainingByCommittee.score-1253"><span class="linenos">1253</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.score-1254"><a href="#CoTrainingByCommittee.score-1254"><span class="linenos">1254</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee.score-1255"><a href="#CoTrainingByCommittee.score-1255"><span class="linenos">1255</span></a><span class="sd">            Test samples.</span>
</span><span id="CoTrainingByCommittee.score-1256"><a href="#CoTrainingByCommittee.score-1256"><span class="linenos">1256</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="CoTrainingByCommittee.score-1257"><a href="#CoTrainingByCommittee.score-1257"><span class="linenos">1257</span></a><span class="sd">            True labels for X.</span>
</span><span id="CoTrainingByCommittee.score-1258"><a href="#CoTrainingByCommittee.score-1258"><span class="linenos">1258</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), optional</span>
</span><span id="CoTrainingByCommittee.score-1259"><a href="#CoTrainingByCommittee.score-1259"><span class="linenos">1259</span></a><span class="sd">            Sample weights., by default None</span>
</span><span id="CoTrainingByCommittee.score-1260"><a href="#CoTrainingByCommittee.score-1260"><span class="linenos">1260</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee.score-1261"><a href="#CoTrainingByCommittee.score-1261"><span class="linenos">1261</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee.score-1262"><a href="#CoTrainingByCommittee.score-1262"><span class="linenos">1262</span></a><span class="sd">        score: float</span>
</span><span id="CoTrainingByCommittee.score-1263"><a href="#CoTrainingByCommittee.score-1263"><span class="linenos">1263</span></a><span class="sd">            Mean accuracy of self.predict(X) wrt. y.</span>
</span><span id="CoTrainingByCommittee.score-1264"><a href="#CoTrainingByCommittee.score-1264"><span class="linenos">1264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.score-1265"><a href="#CoTrainingByCommittee.score-1265"><span class="linenos">1265</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.score-1266"><a href="#CoTrainingByCommittee.score-1266"><span class="linenos">1266</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.score-1267"><a href="#CoTrainingByCommittee.score-1267"><span class="linenos">1267</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.score-1268"><a href="#CoTrainingByCommittee.score-1268"><span class="linenos">1268</span></a>            <span class="k">if</span> <span class="s2">&quot;le_dict_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.score-1269"><a href="#CoTrainingByCommittee.score-1269"><span class="linenos">1269</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">le_dict_</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.score-1270"><a href="#CoTrainingByCommittee.score-1270"><span class="linenos">1270</span></a>                    <span class="nb">zip</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.score-1271"><a href="#CoTrainingByCommittee.score-1271"><span class="linenos">1271</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.score-1272"><a href="#CoTrainingByCommittee.score-1272"><span class="linenos">1272</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span><span class="p">),</span>
</span><span id="CoTrainingByCommittee.score-1273"><a href="#CoTrainingByCommittee.score-1273"><span class="linenos">1273</span></a>                    <span class="p">)</span>
</span><span id="CoTrainingByCommittee.score-1274"><a href="#CoTrainingByCommittee.score-1274"><span class="linenos">1274</span></a>                <span class="p">)</span>
</span><span id="CoTrainingByCommittee.score-1275"><a href="#CoTrainingByCommittee.score-1275"><span class="linenos">1275</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">le_dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.score-1276"><a href="#CoTrainingByCommittee.score-1276"><span class="linenos">1276</span></a>
</span><span id="CoTrainingByCommittee.score-1277"><a href="#CoTrainingByCommittee.score-1277"><span class="linenos">1277</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the mean accuracy on the given test data and labels.
In multi-label classification, this is the subset accuracy which is a harsh metric since you require for each sample that each label set be correctly predicted.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (array-like of shape (n_samples, n_features)):
Test samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,) or (n_samples, n_outputs)):
True labels for X.</li>
<li><strong>sample_weight</strong> (array-like of shape (n_samples,), optional):
Sample weights., by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>score</strong> (float):
Mean accuracy of self.predict(X) wrt. y.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="CoTrainingByCommittee.get_params" class="function">get_params</dd>
                <dd id="CoTrainingByCommittee.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="DemocraticCoLearning">
                            <input id="DemocraticCoLearning-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DemocraticCoLearning</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="DemocraticCoLearning-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemocraticCoLearning"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemocraticCoLearning-116"><a href="#DemocraticCoLearning-116"><span class="linenos">116</span></a><span class="k">class</span> <span class="nc">DemocraticCoLearning</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-117"><a href="#DemocraticCoLearning-117"><span class="linenos">117</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-118"><a href="#DemocraticCoLearning-118"><span class="linenos">118</span></a><span class="sd">    **Democratic Co-learning. Ensemble of classifiers of different types.**</span>
</span><span id="DemocraticCoLearning-119"><a href="#DemocraticCoLearning-119"><span class="linenos">119</span></a><span class="sd">    --------------------------------------------</span>
</span><span id="DemocraticCoLearning-120"><a href="#DemocraticCoLearning-120"><span class="linenos">120</span></a>
</span><span id="DemocraticCoLearning-121"><a href="#DemocraticCoLearning-121"><span class="linenos">121</span></a><span class="sd">    A iterative algorithm that uses a ensemble of classifiers to label instances.</span>
</span><span id="DemocraticCoLearning-122"><a href="#DemocraticCoLearning-122"><span class="linenos">122</span></a><span class="sd">    The main process is:</span>
</span><span id="DemocraticCoLearning-123"><a href="#DemocraticCoLearning-123"><span class="linenos">123</span></a><span class="sd">    1. Train each classifier with the labeled instances.</span>
</span><span id="DemocraticCoLearning-124"><a href="#DemocraticCoLearning-124"><span class="linenos">124</span></a><span class="sd">    2. While any classifier is retrained:</span>
</span><span id="DemocraticCoLearning-125"><a href="#DemocraticCoLearning-125"><span class="linenos">125</span></a><span class="sd">        1. Predict the instances from the unlabeled set.</span>
</span><span id="DemocraticCoLearning-126"><a href="#DemocraticCoLearning-126"><span class="linenos">126</span></a><span class="sd">        2. Calculate the confidence interval for each classifier for define weights.</span>
</span><span id="DemocraticCoLearning-127"><a href="#DemocraticCoLearning-127"><span class="linenos">127</span></a><span class="sd">        3. Calculate the weighted vote for each instance.</span>
</span><span id="DemocraticCoLearning-128"><a href="#DemocraticCoLearning-128"><span class="linenos">128</span></a><span class="sd">        4. Calculate the majority vote for each instance.</span>
</span><span id="DemocraticCoLearning-129"><a href="#DemocraticCoLearning-129"><span class="linenos">129</span></a><span class="sd">        5. Select the instances to label if majority vote is the same as weighted vote.</span>
</span><span id="DemocraticCoLearning-130"><a href="#DemocraticCoLearning-130"><span class="linenos">130</span></a><span class="sd">        6. Select the instances to retrain the classifier, if `only_mislabeled` is False then select all instances, else select only mislabeled instances for each classifier.</span>
</span><span id="DemocraticCoLearning-131"><a href="#DemocraticCoLearning-131"><span class="linenos">131</span></a><span class="sd">        7. Retrain the classifier with the new instances if the error rate is lower than the previous iteration.</span>
</span><span id="DemocraticCoLearning-132"><a href="#DemocraticCoLearning-132"><span class="linenos">132</span></a><span class="sd">    3. Ignore the classifiers with confidence interval lower than 0.5.</span>
</span><span id="DemocraticCoLearning-133"><a href="#DemocraticCoLearning-133"><span class="linenos">133</span></a><span class="sd">    4. Combine the probabilities of each classifier.</span>
</span><span id="DemocraticCoLearning-134"><a href="#DemocraticCoLearning-134"><span class="linenos">134</span></a>
</span><span id="DemocraticCoLearning-135"><a href="#DemocraticCoLearning-135"><span class="linenos">135</span></a><span class="sd">    **Methods**</span>
</span><span id="DemocraticCoLearning-136"><a href="#DemocraticCoLearning-136"><span class="linenos">136</span></a><span class="sd">    -------</span>
</span><span id="DemocraticCoLearning-137"><a href="#DemocraticCoLearning-137"><span class="linenos">137</span></a><span class="sd">    - `fit`: Fit the model with the labeled instances.</span>
</span><span id="DemocraticCoLearning-138"><a href="#DemocraticCoLearning-138"><span class="linenos">138</span></a><span class="sd">    - `predict` : Predict the class for each instance.</span>
</span><span id="DemocraticCoLearning-139"><a href="#DemocraticCoLearning-139"><span class="linenos">139</span></a><span class="sd">    - `predict_proba`: Predict the probability for each class.</span>
</span><span id="DemocraticCoLearning-140"><a href="#DemocraticCoLearning-140"><span class="linenos">140</span></a><span class="sd">    - `score`: Return the mean accuracy on the given test data and labels.</span>
</span><span id="DemocraticCoLearning-141"><a href="#DemocraticCoLearning-141"><span class="linenos">141</span></a><span class="sd">    </span>
</span><span id="DemocraticCoLearning-142"><a href="#DemocraticCoLearning-142"><span class="linenos">142</span></a><span class="sd">    </span>
</span><span id="DemocraticCoLearning-143"><a href="#DemocraticCoLearning-143"><span class="linenos">143</span></a><span class="sd">    **Example**</span>
</span><span id="DemocraticCoLearning-144"><a href="#DemocraticCoLearning-144"><span class="linenos">144</span></a><span class="sd">    -------</span>
</span><span id="DemocraticCoLearning-145"><a href="#DemocraticCoLearning-145"><span class="linenos">145</span></a><span class="sd">    ```python</span>
</span><span id="DemocraticCoLearning-146"><a href="#DemocraticCoLearning-146"><span class="linenos">146</span></a><span class="sd">    from sklearn.datasets import load_iris</span>
</span><span id="DemocraticCoLearning-147"><a href="#DemocraticCoLearning-147"><span class="linenos">147</span></a><span class="sd">    from sklearn.tree import DecisionTreeClassifier</span>
</span><span id="DemocraticCoLearning-148"><a href="#DemocraticCoLearning-148"><span class="linenos">148</span></a><span class="sd">    from sklearn.naive_bayes import GaussianNB</span>
</span><span id="DemocraticCoLearning-149"><a href="#DemocraticCoLearning-149"><span class="linenos">149</span></a><span class="sd">    from sklearn.neighbors import KNeighborsClassifier</span>
</span><span id="DemocraticCoLearning-150"><a href="#DemocraticCoLearning-150"><span class="linenos">150</span></a><span class="sd">    from sslearn.wrapper import DemocraticCoLearning</span>
</span><span id="DemocraticCoLearning-151"><a href="#DemocraticCoLearning-151"><span class="linenos">151</span></a><span class="sd">    from sslearn.model_selection import artificial_ssl_dataset</span>
</span><span id="DemocraticCoLearning-152"><a href="#DemocraticCoLearning-152"><span class="linenos">152</span></a>
</span><span id="DemocraticCoLearning-153"><a href="#DemocraticCoLearning-153"><span class="linenos">153</span></a><span class="sd">    X, y = load_iris(return_X_y=True)</span>
</span><span id="DemocraticCoLearning-154"><a href="#DemocraticCoLearning-154"><span class="linenos">154</span></a><span class="sd">    X, y, X_unlabel, y_unlabel, _, _ = artificial_ssl_dataset(X, y, label_rate=0.1, random_state=0)</span>
</span><span id="DemocraticCoLearning-155"><a href="#DemocraticCoLearning-155"><span class="linenos">155</span></a><span class="sd">    dcl = DemocraticCoLearning(base_estimator=[DecisionTreeClassifier(), GaussianNB(), KNeighborsClassifier(n_neighbors=3)])</span>
</span><span id="DemocraticCoLearning-156"><a href="#DemocraticCoLearning-156"><span class="linenos">156</span></a><span class="sd">    dcl.fit(X, y)</span>
</span><span id="DemocraticCoLearning-157"><a href="#DemocraticCoLearning-157"><span class="linenos">157</span></a><span class="sd">    dcl.score(X_unlabel, y_unlabel)</span>
</span><span id="DemocraticCoLearning-158"><a href="#DemocraticCoLearning-158"><span class="linenos">158</span></a><span class="sd">    ``` </span>
</span><span id="DemocraticCoLearning-159"><a href="#DemocraticCoLearning-159"><span class="linenos">159</span></a>
</span><span id="DemocraticCoLearning-160"><a href="#DemocraticCoLearning-160"><span class="linenos">160</span></a><span class="sd">    **References**</span>
</span><span id="DemocraticCoLearning-161"><a href="#DemocraticCoLearning-161"><span class="linenos">161</span></a><span class="sd">    ----------</span>
</span><span id="DemocraticCoLearning-162"><a href="#DemocraticCoLearning-162"><span class="linenos">162</span></a><span class="sd">    Y. Zhou and S. Goldman, (2004) &lt;br&gt;</span>
</span><span id="DemocraticCoLearning-163"><a href="#DemocraticCoLearning-163"><span class="linenos">163</span></a><span class="sd">    Democratic co-learning, &lt;br&gt;</span>
</span><span id="DemocraticCoLearning-164"><a href="#DemocraticCoLearning-164"><span class="linenos">164</span></a><span class="sd">    in &lt;i&gt;16th IEEE International Conference on Tools with Artificial Intelligence&lt;/i&gt;,&lt;br&gt;</span>
</span><span id="DemocraticCoLearning-165"><a href="#DemocraticCoLearning-165"><span class="linenos">165</span></a><span class="sd">    pp. 594-602, [10.1109/ICTAI.2004.48](https://doi.org/10.1109/ICTAI.2004.48).</span>
</span><span id="DemocraticCoLearning-166"><a href="#DemocraticCoLearning-166"><span class="linenos">166</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-167"><a href="#DemocraticCoLearning-167"><span class="linenos">167</span></a>
</span><span id="DemocraticCoLearning-168"><a href="#DemocraticCoLearning-168"><span class="linenos">168</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-169"><a href="#DemocraticCoLearning-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-170"><a href="#DemocraticCoLearning-170"><span class="linenos">170</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="p">[</span>
</span><span id="DemocraticCoLearning-171"><a href="#DemocraticCoLearning-171"><span class="linenos">171</span></a>            <span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="DemocraticCoLearning-172"><a href="#DemocraticCoLearning-172"><span class="linenos">172</span></a>            <span class="n">GaussianNB</span><span class="p">(),</span>
</span><span id="DemocraticCoLearning-173"><a href="#DemocraticCoLearning-173"><span class="linenos">173</span></a>            <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
</span><span id="DemocraticCoLearning-174"><a href="#DemocraticCoLearning-174"><span class="linenos">174</span></a>        <span class="p">],</span>
</span><span id="DemocraticCoLearning-175"><a href="#DemocraticCoLearning-175"><span class="linenos">175</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-176"><a href="#DemocraticCoLearning-176"><span class="linenos">176</span></a>        <span class="n">expand_only_mislabeled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-177"><a href="#DemocraticCoLearning-177"><span class="linenos">177</span></a>        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-178"><a href="#DemocraticCoLearning-178"><span class="linenos">178</span></a>        <span class="n">q_exp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-179"><a href="#DemocraticCoLearning-179"><span class="linenos">179</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>
</span><span id="DemocraticCoLearning-180"><a href="#DemocraticCoLearning-180"><span class="linenos">180</span></a>    <span class="p">):</span>
</span><span id="DemocraticCoLearning-181"><a href="#DemocraticCoLearning-181"><span class="linenos">181</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-182"><a href="#DemocraticCoLearning-182"><span class="linenos">182</span></a><span class="sd">        Democratic Co-learning. Ensemble of classifiers of different types.</span>
</span><span id="DemocraticCoLearning-183"><a href="#DemocraticCoLearning-183"><span class="linenos">183</span></a>
</span><span id="DemocraticCoLearning-184"><a href="#DemocraticCoLearning-184"><span class="linenos">184</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning-185"><a href="#DemocraticCoLearning-185"><span class="linenos">185</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-186"><a href="#DemocraticCoLearning-186"><span class="linenos">186</span></a><span class="sd">        base_estimator : {ClassifierMixin, list}, optional</span>
</span><span id="DemocraticCoLearning-187"><a href="#DemocraticCoLearning-187"><span class="linenos">187</span></a><span class="sd">            An estimator object implementing fit and predict_proba or a list of ClassifierMixin, by default DecisionTreeClassifier()</span>
</span><span id="DemocraticCoLearning-188"><a href="#DemocraticCoLearning-188"><span class="linenos">188</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="DemocraticCoLearning-189"><a href="#DemocraticCoLearning-189"><span class="linenos">189</span></a><span class="sd">            number of base_estimators to use. None if base_estimator is a list, by default None</span>
</span><span id="DemocraticCoLearning-190"><a href="#DemocraticCoLearning-190"><span class="linenos">190</span></a><span class="sd">        expand_only_mislabeled : bool, optional</span>
</span><span id="DemocraticCoLearning-191"><a href="#DemocraticCoLearning-191"><span class="linenos">191</span></a><span class="sd">            expand only mislabeled instances by itself, by default True</span>
</span><span id="DemocraticCoLearning-192"><a href="#DemocraticCoLearning-192"><span class="linenos">192</span></a><span class="sd">        alpha : float, optional</span>
</span><span id="DemocraticCoLearning-193"><a href="#DemocraticCoLearning-193"><span class="linenos">193</span></a><span class="sd">            confidence level, by default 0.95</span>
</span><span id="DemocraticCoLearning-194"><a href="#DemocraticCoLearning-194"><span class="linenos">194</span></a><span class="sd">        q_exp : int, optional</span>
</span><span id="DemocraticCoLearning-195"><a href="#DemocraticCoLearning-195"><span class="linenos">195</span></a><span class="sd">            exponent for the estimation for error rate, by default 2</span>
</span><span id="DemocraticCoLearning-196"><a href="#DemocraticCoLearning-196"><span class="linenos">196</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="DemocraticCoLearning-197"><a href="#DemocraticCoLearning-197"><span class="linenos">197</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="DemocraticCoLearning-198"><a href="#DemocraticCoLearning-198"><span class="linenos">198</span></a><span class="sd">        Raises</span>
</span><span id="DemocraticCoLearning-199"><a href="#DemocraticCoLearning-199"><span class="linenos">199</span></a><span class="sd">        ------</span>
</span><span id="DemocraticCoLearning-200"><a href="#DemocraticCoLearning-200"><span class="linenos">200</span></a><span class="sd">        AttributeError</span>
</span><span id="DemocraticCoLearning-201"><a href="#DemocraticCoLearning-201"><span class="linenos">201</span></a><span class="sd">            If n_estimators is None and base_estimator is not a list</span>
</span><span id="DemocraticCoLearning-202"><a href="#DemocraticCoLearning-202"><span class="linenos">202</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-203"><a href="#DemocraticCoLearning-203"><span class="linenos">203</span></a>
</span><span id="DemocraticCoLearning-204"><a href="#DemocraticCoLearning-204"><span class="linenos">204</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n_estimators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-205"><a href="#DemocraticCoLearning-205"><span class="linenos">205</span></a>            <span class="n">estimators</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning-206"><a href="#DemocraticCoLearning-206"><span class="linenos">206</span></a>            <span class="n">random_available</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning-207"><a href="#DemocraticCoLearning-207"><span class="linenos">207</span></a>            <span class="n">rand</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-208"><a href="#DemocraticCoLearning-208"><span class="linenos">208</span></a>            <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-209"><a href="#DemocraticCoLearning-209"><span class="linenos">209</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-210"><a href="#DemocraticCoLearning-210"><span class="linenos">210</span></a>                    <span class="s2">&quot;The classifier will not be able to converge correctly, there is not enough diversity among the estimators (learners should be different).&quot;</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-211"><a href="#DemocraticCoLearning-211"><span class="linenos">211</span></a>                    <span class="n">ConvergenceWarning</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-212"><a href="#DemocraticCoLearning-212"><span class="linenos">212</span></a>                <span class="p">)</span>
</span><span id="DemocraticCoLearning-213"><a href="#DemocraticCoLearning-213"><span class="linenos">213</span></a>                <span class="n">random_available</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DemocraticCoLearning-214"><a href="#DemocraticCoLearning-214"><span class="linenos">214</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-215"><a href="#DemocraticCoLearning-215"><span class="linenos">215</span></a>                <span class="n">estimators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skclone</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">))</span>
</span><span id="DemocraticCoLearning-216"><a href="#DemocraticCoLearning-216"><span class="linenos">216</span></a>                <span class="k">if</span> <span class="n">random_available</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-217"><a href="#DemocraticCoLearning-217"><span class="linenos">217</span></a>                    <span class="n">estimators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-218"><a href="#DemocraticCoLearning-218"><span class="linenos">218</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="DemocraticCoLearning-219"><a href="#DemocraticCoLearning-219"><span class="linenos">219</span></a>
</span><span id="DemocraticCoLearning-220"><a href="#DemocraticCoLearning-220"><span class="linenos">220</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-221"><a href="#DemocraticCoLearning-221"><span class="linenos">221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning-222"><a href="#DemocraticCoLearning-222"><span class="linenos">222</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-223"><a href="#DemocraticCoLearning-223"><span class="linenos">223</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-224"><a href="#DemocraticCoLearning-224"><span class="linenos">224</span></a>                <span class="s2">&quot;If `n_estimators` is None then `base_estimator` must be a `list`.&quot;</span>
</span><span id="DemocraticCoLearning-225"><a href="#DemocraticCoLearning-225"><span class="linenos">225</span></a>            <span class="p">)</span>
</span><span id="DemocraticCoLearning-226"><a href="#DemocraticCoLearning-226"><span class="linenos">226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-227"><a href="#DemocraticCoLearning-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-228"><a href="#DemocraticCoLearning-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-229"><a href="#DemocraticCoLearning-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span> <span class="o">=</span> <span class="n">expand_only_mislabeled</span>
</span><span id="DemocraticCoLearning-230"><a href="#DemocraticCoLearning-230"><span class="linenos">230</span></a>
</span><span id="DemocraticCoLearning-231"><a href="#DemocraticCoLearning-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</span><span id="DemocraticCoLearning-232"><a href="#DemocraticCoLearning-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">q_exp</span> <span class="o">=</span> <span class="n">q_exp</span>
</span><span id="DemocraticCoLearning-233"><a href="#DemocraticCoLearning-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="DemocraticCoLearning-234"><a href="#DemocraticCoLearning-234"><span class="linenos">234</span></a>
</span><span id="DemocraticCoLearning-235"><a href="#DemocraticCoLearning-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">__weighted_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-236"><a href="#DemocraticCoLearning-236"><span class="linenos">236</span></a>        <span class="n">y_complete</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-237"><a href="#DemocraticCoLearning-237"><span class="linenos">237</span></a>            <span class="p">[</span>
</span><span id="DemocraticCoLearning-238"><a href="#DemocraticCoLearning-238"><span class="linenos">238</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">wi</span>
</span><span id="DemocraticCoLearning-239"><a href="#DemocraticCoLearning-239"><span class="linenos">239</span></a>                <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">wi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-240"><a href="#DemocraticCoLearning-240"><span class="linenos">240</span></a>            <span class="p">],</span>
</span><span id="DemocraticCoLearning-241"><a href="#DemocraticCoLearning-241"><span class="linenos">241</span></a>            <span class="mi">0</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-242"><a href="#DemocraticCoLearning-242"><span class="linenos">242</span></a>        <span class="p">)</span>
</span><span id="DemocraticCoLearning-243"><a href="#DemocraticCoLearning-243"><span class="linenos">243</span></a>        <span class="n">y_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">y_complete</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-244"><a href="#DemocraticCoLearning-244"><span class="linenos">244</span></a>        <span class="n">y_zeros</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_complete</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">y_complete</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="DemocraticCoLearning-245"><a href="#DemocraticCoLearning-245"><span class="linenos">245</span></a>
</span><span id="DemocraticCoLearning-246"><a href="#DemocraticCoLearning-246"><span class="linenos">246</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_zeros</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="DemocraticCoLearning-247"><a href="#DemocraticCoLearning-247"><span class="linenos">247</span></a>
</span><span id="DemocraticCoLearning-248"><a href="#DemocraticCoLearning-248"><span class="linenos">248</span></a>    <span class="k">def</span> <span class="nf">__calcule_last_confidences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-249"><a href="#DemocraticCoLearning-249"><span class="linenos">249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the confidence of each learner</span>
</span><span id="DemocraticCoLearning-250"><a href="#DemocraticCoLearning-250"><span class="linenos">250</span></a>
</span><span id="DemocraticCoLearning-251"><a href="#DemocraticCoLearning-251"><span class="linenos">251</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning-252"><a href="#DemocraticCoLearning-252"><span class="linenos">252</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-253"><a href="#DemocraticCoLearning-253"><span class="linenos">253</span></a><span class="sd">        X : array-like</span>
</span><span id="DemocraticCoLearning-254"><a href="#DemocraticCoLearning-254"><span class="linenos">254</span></a><span class="sd">            Set of instances</span>
</span><span id="DemocraticCoLearning-255"><a href="#DemocraticCoLearning-255"><span class="linenos">255</span></a><span class="sd">        y : array-like</span>
</span><span id="DemocraticCoLearning-256"><a href="#DemocraticCoLearning-256"><span class="linenos">256</span></a><span class="sd">            Set of classes for each instance</span>
</span><span id="DemocraticCoLearning-257"><a href="#DemocraticCoLearning-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-258"><a href="#DemocraticCoLearning-258"><span class="linenos">258</span></a>        <span class="n">w</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DemocraticCoLearning-259"><a href="#DemocraticCoLearning-259"><span class="linenos">259</span></a>        <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-260"><a href="#DemocraticCoLearning-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="o">=</span> <span class="n">w</span>
</span><span id="DemocraticCoLearning-261"><a href="#DemocraticCoLearning-261"><span class="linenos">261</span></a>
</span><span id="DemocraticCoLearning-262"><a href="#DemocraticCoLearning-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">estimator_kwards</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-263"><a href="#DemocraticCoLearning-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Democratic-Co classifier</span>
</span><span id="DemocraticCoLearning-264"><a href="#DemocraticCoLearning-264"><span class="linenos">264</span></a>
</span><span id="DemocraticCoLearning-265"><a href="#DemocraticCoLearning-265"><span class="linenos">265</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning-266"><a href="#DemocraticCoLearning-266"><span class="linenos">266</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-267"><a href="#DemocraticCoLearning-267"><span class="linenos">267</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DemocraticCoLearning-268"><a href="#DemocraticCoLearning-268"><span class="linenos">268</span></a><span class="sd">            The training input samples.</span>
</span><span id="DemocraticCoLearning-269"><a href="#DemocraticCoLearning-269"><span class="linenos">269</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="DemocraticCoLearning-270"><a href="#DemocraticCoLearning-270"><span class="linenos">270</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="DemocraticCoLearning-271"><a href="#DemocraticCoLearning-271"><span class="linenos">271</span></a><span class="sd">        estimator_kwards : {list, dict}, optional</span>
</span><span id="DemocraticCoLearning-272"><a href="#DemocraticCoLearning-272"><span class="linenos">272</span></a><span class="sd">            list of kwards for each estimator or kwards for all estimators, by default None</span>
</span><span id="DemocraticCoLearning-273"><a href="#DemocraticCoLearning-273"><span class="linenos">273</span></a>
</span><span id="DemocraticCoLearning-274"><a href="#DemocraticCoLearning-274"><span class="linenos">274</span></a><span class="sd">        Returns</span>
</span><span id="DemocraticCoLearning-275"><a href="#DemocraticCoLearning-275"><span class="linenos">275</span></a><span class="sd">        -------</span>
</span><span id="DemocraticCoLearning-276"><a href="#DemocraticCoLearning-276"><span class="linenos">276</span></a><span class="sd">        self : DemocraticCoLearning</span>
</span><span id="DemocraticCoLearning-277"><a href="#DemocraticCoLearning-277"><span class="linenos">277</span></a><span class="sd">            fitted classifier</span>
</span><span id="DemocraticCoLearning-278"><a href="#DemocraticCoLearning-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-279"><a href="#DemocraticCoLearning-279"><span class="linenos">279</span></a>
</span><span id="DemocraticCoLearning-280"><a href="#DemocraticCoLearning-280"><span class="linenos">280</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-281"><a href="#DemocraticCoLearning-281"><span class="linenos">281</span></a>
</span><span id="DemocraticCoLearning-282"><a href="#DemocraticCoLearning-282"><span class="linenos">282</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-283"><a href="#DemocraticCoLearning-283"><span class="linenos">283</span></a>
</span><span id="DemocraticCoLearning-284"><a href="#DemocraticCoLearning-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-285"><a href="#DemocraticCoLearning-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-286"><a href="#DemocraticCoLearning-286"><span class="linenos">286</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-287"><a href="#DemocraticCoLearning-287"><span class="linenos">287</span></a>
</span><span id="DemocraticCoLearning-288"><a href="#DemocraticCoLearning-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DemocraticCoLearning-289"><a href="#DemocraticCoLearning-289"><span class="linenos">289</span></a>
</span><span id="DemocraticCoLearning-290"><a href="#DemocraticCoLearning-290"><span class="linenos">290</span></a>        <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">X_label</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-291"><a href="#DemocraticCoLearning-291"><span class="linenos">291</span></a>        <span class="n">Ly</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-292"><a href="#DemocraticCoLearning-292"><span class="linenos">292</span></a>        <span class="c1"># This variable prevents duplicate instances.</span>
</span><span id="DemocraticCoLearning-293"><a href="#DemocraticCoLearning-293"><span class="linenos">293</span></a>        <span class="n">L_added</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-294"><a href="#DemocraticCoLearning-294"><span class="linenos">294</span></a>        <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-295"><a href="#DemocraticCoLearning-295"><span class="linenos">295</span></a>
</span><span id="DemocraticCoLearning-296"><a href="#DemocraticCoLearning-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">estimator_kwards</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-297"><a href="#DemocraticCoLearning-297"><span class="linenos">297</span></a>            <span class="n">estimator_kwards</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-298"><a href="#DemocraticCoLearning-298"><span class="linenos">298</span></a>
</span><span id="DemocraticCoLearning-299"><a href="#DemocraticCoLearning-299"><span class="linenos">299</span></a>        <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning-300"><a href="#DemocraticCoLearning-300"><span class="linenos">300</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DemocraticCoLearning-301"><a href="#DemocraticCoLearning-301"><span class="linenos">301</span></a>        <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-302"><a href="#DemocraticCoLearning-302"><span class="linenos">302</span></a>            <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DemocraticCoLearning-303"><a href="#DemocraticCoLearning-303"><span class="linenos">303</span></a>            <span class="n">iteration_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DemocraticCoLearning-304"><a href="#DemocraticCoLearning-304"><span class="linenos">304</span></a>            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DemocraticCoLearning-305"><a href="#DemocraticCoLearning-305"><span class="linenos">305</span></a>
</span><span id="DemocraticCoLearning-306"><a href="#DemocraticCoLearning-306"><span class="linenos">306</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-307"><a href="#DemocraticCoLearning-307"><span class="linenos">307</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">estimator_kwards</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning-308"><a href="#DemocraticCoLearning-308"><span class="linenos">308</span></a>            <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-309"><a href="#DemocraticCoLearning-309"><span class="linenos">309</span></a>                <span class="k">break</span>
</span><span id="DemocraticCoLearning-310"><a href="#DemocraticCoLearning-310"><span class="linenos">310</span></a>            <span class="c1"># Majority Vote</span>
</span><span id="DemocraticCoLearning-311"><a href="#DemocraticCoLearning-311"><span class="linenos">311</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span> <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-312"><a href="#DemocraticCoLearning-312"><span class="linenos">312</span></a>            <span class="n">majority_class</span> <span class="o">=</span> <span class="n">mode</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-313"><a href="#DemocraticCoLearning-313"><span class="linenos">313</span></a>            <span class="c1"># majority_class = st.mode(np.array(predictions, dtype=predictions[0].dtype), axis=0, keepdims=True)[</span>
</span><span id="DemocraticCoLearning-314"><a href="#DemocraticCoLearning-314"><span class="linenos">314</span></a>            <span class="c1">#     0</span>
</span><span id="DemocraticCoLearning-315"><a href="#DemocraticCoLearning-315"><span class="linenos">315</span></a>            <span class="c1"># ].flatten()  # K in pseudocode</span>
</span><span id="DemocraticCoLearning-316"><a href="#DemocraticCoLearning-316"><span class="linenos">316</span></a>
</span><span id="DemocraticCoLearning-317"><a href="#DemocraticCoLearning-317"><span class="linenos">317</span></a>            <span class="n">L_</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-318"><a href="#DemocraticCoLearning-318"><span class="linenos">318</span></a>            <span class="n">Ly_</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-319"><a href="#DemocraticCoLearning-319"><span class="linenos">319</span></a>
</span><span id="DemocraticCoLearning-320"><a href="#DemocraticCoLearning-320"><span class="linenos">320</span></a>            <span class="c1"># Calculate confidence interval</span>
</span><span id="DemocraticCoLearning-321"><a href="#DemocraticCoLearning-321"><span class="linenos">321</span></a>            <span class="n">conf_interval</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DemocraticCoLearning-322"><a href="#DemocraticCoLearning-322"><span class="linenos">322</span></a>                <span class="n">confidence_interval</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-323"><a href="#DemocraticCoLearning-323"><span class="linenos">323</span></a>                    <span class="n">X_label</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-324"><a href="#DemocraticCoLearning-324"><span class="linenos">324</span></a>                    <span class="n">H</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-325"><a href="#DemocraticCoLearning-325"><span class="linenos">325</span></a>                    <span class="n">y_label</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-326"><a href="#DemocraticCoLearning-326"><span class="linenos">326</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
</span><span id="DemocraticCoLearning-327"><a href="#DemocraticCoLearning-327"><span class="linenos">327</span></a>                <span class="p">)</span>
</span><span id="DemocraticCoLearning-328"><a href="#DemocraticCoLearning-328"><span class="linenos">328</span></a>                <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning-329"><a href="#DemocraticCoLearning-329"><span class="linenos">329</span></a>            <span class="p">]</span>
</span><span id="DemocraticCoLearning-330"><a href="#DemocraticCoLearning-330"><span class="linenos">330</span></a>
</span><span id="DemocraticCoLearning-331"><a href="#DemocraticCoLearning-331"><span class="linenos">331</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="p">[(</span><span class="n">li</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="n">hi</span><span class="p">)</span> <span class="ow">in</span> <span class="n">conf_interval</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-332"><a href="#DemocraticCoLearning-332"><span class="linenos">332</span></a>            <span class="n">iteration_dict</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DemocraticCoLearning-333"><a href="#DemocraticCoLearning-333"><span class="linenos">333</span></a>                <span class="s2">&quot;cl&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-334"><a href="#DemocraticCoLearning-334"><span class="linenos">334</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">conf_interval</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>
</span><span id="DemocraticCoLearning-335"><a href="#DemocraticCoLearning-335"><span class="linenos">335</span></a>            <span class="p">}</span>
</span><span id="DemocraticCoLearning-336"><a href="#DemocraticCoLearning-336"><span class="linenos">336</span></a>            <span class="c1"># weighted vote</span>
</span><span id="DemocraticCoLearning-337"><a href="#DemocraticCoLearning-337"><span class="linenos">337</span></a>            <span class="n">weighted_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__weighted_y</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-338"><a href="#DemocraticCoLearning-338"><span class="linenos">338</span></a>
</span><span id="DemocraticCoLearning-339"><a href="#DemocraticCoLearning-339"><span class="linenos">339</span></a>            <span class="c1"># If `weighted_class` is equal as `majority_class` then</span>
</span><span id="DemocraticCoLearning-340"><a href="#DemocraticCoLearning-340"><span class="linenos">340</span></a>            <span class="c1"># the sum of classifier&#39;s weights of max voted class</span>
</span><span id="DemocraticCoLearning-341"><a href="#DemocraticCoLearning-341"><span class="linenos">341</span></a>            <span class="c1"># is greater than the max of sum of classifier&#39;s weights</span>
</span><span id="DemocraticCoLearning-342"><a href="#DemocraticCoLearning-342"><span class="linenos">342</span></a>            <span class="c1"># from another classes.</span>
</span><span id="DemocraticCoLearning-343"><a href="#DemocraticCoLearning-343"><span class="linenos">343</span></a>
</span><span id="DemocraticCoLearning-344"><a href="#DemocraticCoLearning-344"><span class="linenos">344</span></a>            <span class="n">candidates</span> <span class="o">=</span> <span class="n">weighted_class</span> <span class="o">==</span> <span class="n">majority_class</span>
</span><span id="DemocraticCoLearning-345"><a href="#DemocraticCoLearning-345"><span class="linenos">345</span></a>            <span class="n">candidates_bool</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning-346"><a href="#DemocraticCoLearning-346"><span class="linenos">346</span></a>
</span><span id="DemocraticCoLearning-347"><a href="#DemocraticCoLearning-347"><span class="linenos">347</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-348"><a href="#DemocraticCoLearning-348"><span class="linenos">348</span></a>                <span class="n">all_same_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning-349"><a href="#DemocraticCoLearning-349"><span class="linenos">349</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-350"><a href="#DemocraticCoLearning-350"><span class="linenos">350</span></a>                    <span class="n">all_same_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="DemocraticCoLearning-351"><a href="#DemocraticCoLearning-351"><span class="linenos">351</span></a>                <span class="n">all_same</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">*</span><span class="n">all_same_list</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-352"><a href="#DemocraticCoLearning-352"><span class="linenos">352</span></a>            <span class="c1"># new_instances = []</span>
</span><span id="DemocraticCoLearning-353"><a href="#DemocraticCoLearning-353"><span class="linenos">353</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-354"><a href="#DemocraticCoLearning-354"><span class="linenos">354</span></a>
</span><span id="DemocraticCoLearning-355"><a href="#DemocraticCoLearning-355"><span class="linenos">355</span></a>                <span class="n">mispredictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">weighted_class</span>
</span><span id="DemocraticCoLearning-356"><a href="#DemocraticCoLearning-356"><span class="linenos">356</span></a>                <span class="c1"># An instance from U are added to Li&#39; only if:</span>
</span><span id="DemocraticCoLearning-357"><a href="#DemocraticCoLearning-357"><span class="linenos">357</span></a>                <span class="c1">#   It is a misprediction for i</span>
</span><span id="DemocraticCoLearning-358"><a href="#DemocraticCoLearning-358"><span class="linenos">358</span></a>                <span class="c1">#   It is a candidate (weighted_class are same majority_class)</span>
</span><span id="DemocraticCoLearning-359"><a href="#DemocraticCoLearning-359"><span class="linenos">359</span></a>                <span class="c1">#   It hasn&#39;t been added yet in Li</span>
</span><span id="DemocraticCoLearning-360"><a href="#DemocraticCoLearning-360"><span class="linenos">360</span></a>
</span><span id="DemocraticCoLearning-361"><a href="#DemocraticCoLearning-361"><span class="linenos">361</span></a>                <span class="n">candidates_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">mispredictions</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-362"><a href="#DemocraticCoLearning-362"><span class="linenos">362</span></a>
</span><span id="DemocraticCoLearning-363"><a href="#DemocraticCoLearning-363"><span class="linenos">363</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-364"><a href="#DemocraticCoLearning-364"><span class="linenos">364</span></a>                    <span class="n">candidates_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">candidates_temp</span><span class="p">,</span> <span class="n">all_same</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-365"><a href="#DemocraticCoLearning-365"><span class="linenos">365</span></a>
</span><span id="DemocraticCoLearning-366"><a href="#DemocraticCoLearning-366"><span class="linenos">366</span></a>                <span class="n">to_add</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">candidates_temp</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-367"><a href="#DemocraticCoLearning-367"><span class="linenos">367</span></a>
</span><span id="DemocraticCoLearning-368"><a href="#DemocraticCoLearning-368"><span class="linenos">368</span></a>                <span class="n">candidates_bool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_add</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-369"><a href="#DemocraticCoLearning-369"><span class="linenos">369</span></a>                <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-370"><a href="#DemocraticCoLearning-370"><span class="linenos">370</span></a>                    <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="DemocraticCoLearning-371"><a href="#DemocraticCoLearning-371"><span class="linenos">371</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-372"><a href="#DemocraticCoLearning-372"><span class="linenos">372</span></a>                    <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="DemocraticCoLearning-373"><a href="#DemocraticCoLearning-373"><span class="linenos">373</span></a>                <span class="n">Ly_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">weighted_class</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-374"><a href="#DemocraticCoLearning-374"><span class="linenos">374</span></a>
</span><span id="DemocraticCoLearning-375"><a href="#DemocraticCoLearning-375"><span class="linenos">375</span></a>            <span class="n">new_conf_interval</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DemocraticCoLearning-376"><a href="#DemocraticCoLearning-376"><span class="linenos">376</span></a>                <span class="n">confidence_interval</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">H</span><span class="p">,</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-377"><a href="#DemocraticCoLearning-377"><span class="linenos">377</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-378"><a href="#DemocraticCoLearning-378"><span class="linenos">378</span></a>            <span class="p">]</span>
</span><span id="DemocraticCoLearning-379"><a href="#DemocraticCoLearning-379"><span class="linenos">379</span></a>            <span class="n">e_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">l_</span> <span class="k">for</span> <span class="n">l_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">new_conf_interval</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-380"><a href="#DemocraticCoLearning-380"><span class="linenos">380</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-381"><a href="#DemocraticCoLearning-381"><span class="linenos">381</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-382"><a href="#DemocraticCoLearning-382"><span class="linenos">382</span></a>
</span><span id="DemocraticCoLearning-383"><a href="#DemocraticCoLearning-383"><span class="linenos">383</span></a>                    <span class="n">qi</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-384"><a href="#DemocraticCoLearning-384"><span class="linenos">384</span></a>                    <span class="n">e_i</span> <span class="o">=</span> <span class="n">e_factor</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning-385"><a href="#DemocraticCoLearning-385"><span class="linenos">385</span></a>                    <span class="c1"># |Li|+|L&#39;i| == |Li U L&#39;i| because of to_add</span>
</span><span id="DemocraticCoLearning-386"><a href="#DemocraticCoLearning-386"><span class="linenos">386</span></a>                    <span class="n">q_i</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="DemocraticCoLearning-387"><a href="#DemocraticCoLearning-387"><span class="linenos">387</span></a>                        <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="DemocraticCoLearning-388"><a href="#DemocraticCoLearning-388"><span class="linenos">388</span></a>                    <span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_exp</span>
</span><span id="DemocraticCoLearning-389"><a href="#DemocraticCoLearning-389"><span class="linenos">389</span></a>                    <span class="k">if</span> <span class="n">q_i</span> <span class="o">&lt;=</span> <span class="n">qi</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-390"><a href="#DemocraticCoLearning-390"><span class="linenos">390</span></a>                        <span class="k">continue</span>
</span><span id="DemocraticCoLearning-391"><a href="#DemocraticCoLearning-391"><span class="linenos">391</span></a>                    <span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">candidates_bool</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning-392"><a href="#DemocraticCoLearning-392"><span class="linenos">392</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-393"><a href="#DemocraticCoLearning-393"><span class="linenos">393</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="DemocraticCoLearning-394"><a href="#DemocraticCoLearning-394"><span class="linenos">394</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-395"><a href="#DemocraticCoLearning-395"><span class="linenos">395</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</span><span id="DemocraticCoLearning-396"><a href="#DemocraticCoLearning-396"><span class="linenos">396</span></a>                    <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ly_</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</span><span id="DemocraticCoLearning-397"><a href="#DemocraticCoLearning-397"><span class="linenos">397</span></a>
</span><span id="DemocraticCoLearning-398"><a href="#DemocraticCoLearning-398"><span class="linenos">398</span></a>                    <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_i</span>
</span><span id="DemocraticCoLearning-399"><a href="#DemocraticCoLearning-399"><span class="linenos">399</span></a>                    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning-400"><a href="#DemocraticCoLearning-400"><span class="linenos">400</span></a>
</span><span id="DemocraticCoLearning-401"><a href="#DemocraticCoLearning-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning-402"><a href="#DemocraticCoLearning-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__calcule_last_confidences</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-403"><a href="#DemocraticCoLearning-403"><span class="linenos">403</span></a>
</span><span id="DemocraticCoLearning-404"><a href="#DemocraticCoLearning-404"><span class="linenos">404</span></a>        <span class="c1"># Ignore hypothesis</span>
</span><span id="DemocraticCoLearning-405"><a href="#DemocraticCoLearning-405"><span class="linenos">405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">)</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-406"><a href="#DemocraticCoLearning-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-407"><a href="#DemocraticCoLearning-407"><span class="linenos">407</span></a>
</span><span id="DemocraticCoLearning-408"><a href="#DemocraticCoLearning-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-409"><a href="#DemocraticCoLearning-409"><span class="linenos">409</span></a>
</span><span id="DemocraticCoLearning-410"><a href="#DemocraticCoLearning-410"><span class="linenos">410</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="DemocraticCoLearning-411"><a href="#DemocraticCoLearning-411"><span class="linenos">411</span></a>
</span><span id="DemocraticCoLearning-412"><a href="#DemocraticCoLearning-412"><span class="linenos">412</span></a>    <span class="k">def</span> <span class="nf">__combine_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-413"><a href="#DemocraticCoLearning-413"><span class="linenos">413</span></a>
</span><span id="DemocraticCoLearning-414"><a href="#DemocraticCoLearning-414"><span class="linenos">414</span></a>        <span class="n">n_instances</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># uppercase X as it will be an np.array</span>
</span><span id="DemocraticCoLearning-415"><a href="#DemocraticCoLearning-415"><span class="linenos">415</span></a>        <span class="n">sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_instances</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-416"><a href="#DemocraticCoLearning-416"><span class="linenos">416</span></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_instances</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-417"><a href="#DemocraticCoLearning-417"><span class="linenos">417</span></a>        <span class="n">Cavg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_instances</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-418"><a href="#DemocraticCoLearning-418"><span class="linenos">418</span></a>
</span><span id="DemocraticCoLearning-419"><a href="#DemocraticCoLearning-419"><span class="linenos">419</span></a>        <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-420"><a href="#DemocraticCoLearning-420"><span class="linenos">420</span></a>            <span class="n">cj</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-421"><a href="#DemocraticCoLearning-421"><span class="linenos">421</span></a>            <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">cj</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-422"><a href="#DemocraticCoLearning-422"><span class="linenos">422</span></a>            <span class="n">C</span> <span class="o">+=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">factor</span>
</span><span id="DemocraticCoLearning-423"><a href="#DemocraticCoLearning-423"><span class="linenos">423</span></a>            <span class="n">sizes</span> <span class="o">+=</span> <span class="n">factor</span>
</span><span id="DemocraticCoLearning-424"><a href="#DemocraticCoLearning-424"><span class="linenos">424</span></a>
</span><span id="DemocraticCoLearning-425"><a href="#DemocraticCoLearning-425"><span class="linenos">425</span></a>        <span class="n">Cavg</span><span class="p">[</span><span class="n">sizes</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># «voting power» of 0.5 for small groups</span>
</span><span id="DemocraticCoLearning-426"><a href="#DemocraticCoLearning-426"><span class="linenos">426</span></a>        <span class="n">ne</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizes</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># non empty groups</span>
</span><span id="DemocraticCoLearning-427"><a href="#DemocraticCoLearning-427"><span class="linenos">427</span></a>        <span class="n">Cavg</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizes</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sizes</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span> <span class="o">/</span> <span class="n">sizes</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-428"><a href="#DemocraticCoLearning-428"><span class="linenos">428</span></a>
</span><span id="DemocraticCoLearning-429"><a href="#DemocraticCoLearning-429"><span class="linenos">429</span></a>        <span class="k">return</span> <span class="n">softmax</span><span class="p">(</span><span class="n">Cavg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-430"><a href="#DemocraticCoLearning-430"><span class="linenos">430</span></a>
</span><span id="DemocraticCoLearning-431"><a href="#DemocraticCoLearning-431"><span class="linenos">431</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-432"><a href="#DemocraticCoLearning-432"><span class="linenos">432</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probability for each possible outcome.</span>
</span><span id="DemocraticCoLearning-433"><a href="#DemocraticCoLearning-433"><span class="linenos">433</span></a>
</span><span id="DemocraticCoLearning-434"><a href="#DemocraticCoLearning-434"><span class="linenos">434</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning-435"><a href="#DemocraticCoLearning-435"><span class="linenos">435</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-436"><a href="#DemocraticCoLearning-436"><span class="linenos">436</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DemocraticCoLearning-437"><a href="#DemocraticCoLearning-437"><span class="linenos">437</span></a><span class="sd">            Array representing the data.</span>
</span><span id="DemocraticCoLearning-438"><a href="#DemocraticCoLearning-438"><span class="linenos">438</span></a><span class="sd">        Returns</span>
</span><span id="DemocraticCoLearning-439"><a href="#DemocraticCoLearning-439"><span class="linenos">439</span></a><span class="sd">        -------</span>
</span><span id="DemocraticCoLearning-440"><a href="#DemocraticCoLearning-440"><span class="linenos">440</span></a><span class="sd">        class probabilities: ndarray of shape (n_samples, n_classes)</span>
</span><span id="DemocraticCoLearning-441"><a href="#DemocraticCoLearning-441"><span class="linenos">441</span></a><span class="sd">            Array with prediction probabilities.</span>
</span><span id="DemocraticCoLearning-442"><a href="#DemocraticCoLearning-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-443"><a href="#DemocraticCoLearning-443"><span class="linenos">443</span></a>        <span class="k">if</span> <span class="s2">&quot;h_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-444"><a href="#DemocraticCoLearning-444"><span class="linenos">444</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-445"><a href="#DemocraticCoLearning-445"><span class="linenos">445</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-446"><a href="#DemocraticCoLearning-446"><span class="linenos">446</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__combine_probabilities</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-447"><a href="#DemocraticCoLearning-447"><span class="linenos">447</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-448"><a href="#DemocraticCoLearning-448"><span class="linenos">448</span></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span><span class="s2">&quot;Classifier not fitted&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h2 id="democratic-co-learning-ensemble-of-classifiers-of-different-types"><strong>Democratic Co-learning. Ensemble of classifiers of different types.</strong></h2>

<p>A iterative algorithm that uses a ensemble of classifiers to label instances.
The main process is:</p>

<ol>
<li>Train each classifier with the labeled instances.</li>
<li>While any classifier is retrained:
<ol>
<li>Predict the instances from the unlabeled set.</li>
<li>Calculate the confidence interval for each classifier for define weights.</li>
<li>Calculate the weighted vote for each instance.</li>
<li>Calculate the majority vote for each instance.</li>
<li>Select the instances to label if majority vote is the same as weighted vote.</li>
<li>Select the instances to retrain the classifier, if <code>only_mislabeled</code> is False then select all instances, else select only mislabeled instances for each classifier.</li>
<li>Retrain the classifier with the new instances if the error rate is lower than the previous iteration.</li>
</ol></li>
<li>Ignore the classifiers with confidence interval lower than 0.5.</li>
<li>Combine the probabilities of each classifier.</li>
</ol>

<h2 id="methods"><strong>Methods</strong></h2>

<ul>
<li><code><a href="#DemocraticCoLearning.fit">fit</a></code>: Fit the model with the labeled instances.</li>
<li><code><a href="#DemocraticCoLearning.predict">predict</a></code> : Predict the class for each instance.</li>
<li><code><a href="#DemocraticCoLearning.predict_proba">predict_proba</a></code>: Predict the probability for each class.</li>
<li><code><a href="#DemocraticCoLearning.score">score</a></code>: Return the mean accuracy on the given test data and labels.</li>
</ul>

<h2 id="example"><strong>Example</strong></h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn"><a href="">sslearn.wrapper</a></span> <span class="kn">import</span> <span class="n">DemocraticCoLearning</span>
<span class="kn">from</span> <span class="nn"><a href="model_selection.html">sslearn.model_selection</a></span> <span class="kn">import</span> <span class="n">artificial_ssl_dataset</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">artificial_ssl_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dcl</span> <span class="o">=</span> <span class="n">DemocraticCoLearning</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="p">[</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">GaussianNB</span><span class="p">(),</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)])</span>
<span class="n">dcl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">dcl</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="references"><strong>References</strong></h2>

<p>Y. Zhou and S. Goldman, (2004) <br>
Democratic co-learning, <br>
in <i>16th IEEE International Conference on Tools with Artificial Intelligence</i>,<br>
pp. 594-602, <a href="https://doi.org/10.1109/ICTAI.2004.48">10.1109/ICTAI.2004.48</a>.</p>
</div>


                            <div id="DemocraticCoLearning.__init__" class="classattr">
                                        <input id="DemocraticCoLearning.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DemocraticCoLearning</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="p">[</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">GaussianNB</span><span class="p">(),</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>,</span><span class="param">	<span class="n">n_estimators</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">expand_only_mislabeled</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span>,</span><span class="param">	<span class="n">q_exp</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="DemocraticCoLearning.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemocraticCoLearning.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemocraticCoLearning.__init__-168"><a href="#DemocraticCoLearning.__init__-168"><span class="linenos">168</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="DemocraticCoLearning.__init__-169"><a href="#DemocraticCoLearning.__init__-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-170"><a href="#DemocraticCoLearning.__init__-170"><span class="linenos">170</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="p">[</span>
</span><span id="DemocraticCoLearning.__init__-171"><a href="#DemocraticCoLearning.__init__-171"><span class="linenos">171</span></a>            <span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="DemocraticCoLearning.__init__-172"><a href="#DemocraticCoLearning.__init__-172"><span class="linenos">172</span></a>            <span class="n">GaussianNB</span><span class="p">(),</span>
</span><span id="DemocraticCoLearning.__init__-173"><a href="#DemocraticCoLearning.__init__-173"><span class="linenos">173</span></a>            <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
</span><span id="DemocraticCoLearning.__init__-174"><a href="#DemocraticCoLearning.__init__-174"><span class="linenos">174</span></a>        <span class="p">],</span>
</span><span id="DemocraticCoLearning.__init__-175"><a href="#DemocraticCoLearning.__init__-175"><span class="linenos">175</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-176"><a href="#DemocraticCoLearning.__init__-176"><span class="linenos">176</span></a>        <span class="n">expand_only_mislabeled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-177"><a href="#DemocraticCoLearning.__init__-177"><span class="linenos">177</span></a>        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-178"><a href="#DemocraticCoLearning.__init__-178"><span class="linenos">178</span></a>        <span class="n">q_exp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-179"><a href="#DemocraticCoLearning.__init__-179"><span class="linenos">179</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>
</span><span id="DemocraticCoLearning.__init__-180"><a href="#DemocraticCoLearning.__init__-180"><span class="linenos">180</span></a>    <span class="p">):</span>
</span><span id="DemocraticCoLearning.__init__-181"><a href="#DemocraticCoLearning.__init__-181"><span class="linenos">181</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning.__init__-182"><a href="#DemocraticCoLearning.__init__-182"><span class="linenos">182</span></a><span class="sd">        Democratic Co-learning. Ensemble of classifiers of different types.</span>
</span><span id="DemocraticCoLearning.__init__-183"><a href="#DemocraticCoLearning.__init__-183"><span class="linenos">183</span></a>
</span><span id="DemocraticCoLearning.__init__-184"><a href="#DemocraticCoLearning.__init__-184"><span class="linenos">184</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning.__init__-185"><a href="#DemocraticCoLearning.__init__-185"><span class="linenos">185</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning.__init__-186"><a href="#DemocraticCoLearning.__init__-186"><span class="linenos">186</span></a><span class="sd">        base_estimator : {ClassifierMixin, list}, optional</span>
</span><span id="DemocraticCoLearning.__init__-187"><a href="#DemocraticCoLearning.__init__-187"><span class="linenos">187</span></a><span class="sd">            An estimator object implementing fit and predict_proba or a list of ClassifierMixin, by default DecisionTreeClassifier()</span>
</span><span id="DemocraticCoLearning.__init__-188"><a href="#DemocraticCoLearning.__init__-188"><span class="linenos">188</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="DemocraticCoLearning.__init__-189"><a href="#DemocraticCoLearning.__init__-189"><span class="linenos">189</span></a><span class="sd">            number of base_estimators to use. None if base_estimator is a list, by default None</span>
</span><span id="DemocraticCoLearning.__init__-190"><a href="#DemocraticCoLearning.__init__-190"><span class="linenos">190</span></a><span class="sd">        expand_only_mislabeled : bool, optional</span>
</span><span id="DemocraticCoLearning.__init__-191"><a href="#DemocraticCoLearning.__init__-191"><span class="linenos">191</span></a><span class="sd">            expand only mislabeled instances by itself, by default True</span>
</span><span id="DemocraticCoLearning.__init__-192"><a href="#DemocraticCoLearning.__init__-192"><span class="linenos">192</span></a><span class="sd">        alpha : float, optional</span>
</span><span id="DemocraticCoLearning.__init__-193"><a href="#DemocraticCoLearning.__init__-193"><span class="linenos">193</span></a><span class="sd">            confidence level, by default 0.95</span>
</span><span id="DemocraticCoLearning.__init__-194"><a href="#DemocraticCoLearning.__init__-194"><span class="linenos">194</span></a><span class="sd">        q_exp : int, optional</span>
</span><span id="DemocraticCoLearning.__init__-195"><a href="#DemocraticCoLearning.__init__-195"><span class="linenos">195</span></a><span class="sd">            exponent for the estimation for error rate, by default 2</span>
</span><span id="DemocraticCoLearning.__init__-196"><a href="#DemocraticCoLearning.__init__-196"><span class="linenos">196</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="DemocraticCoLearning.__init__-197"><a href="#DemocraticCoLearning.__init__-197"><span class="linenos">197</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="DemocraticCoLearning.__init__-198"><a href="#DemocraticCoLearning.__init__-198"><span class="linenos">198</span></a><span class="sd">        Raises</span>
</span><span id="DemocraticCoLearning.__init__-199"><a href="#DemocraticCoLearning.__init__-199"><span class="linenos">199</span></a><span class="sd">        ------</span>
</span><span id="DemocraticCoLearning.__init__-200"><a href="#DemocraticCoLearning.__init__-200"><span class="linenos">200</span></a><span class="sd">        AttributeError</span>
</span><span id="DemocraticCoLearning.__init__-201"><a href="#DemocraticCoLearning.__init__-201"><span class="linenos">201</span></a><span class="sd">            If n_estimators is None and base_estimator is not a list</span>
</span><span id="DemocraticCoLearning.__init__-202"><a href="#DemocraticCoLearning.__init__-202"><span class="linenos">202</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning.__init__-203"><a href="#DemocraticCoLearning.__init__-203"><span class="linenos">203</span></a>
</span><span id="DemocraticCoLearning.__init__-204"><a href="#DemocraticCoLearning.__init__-204"><span class="linenos">204</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n_estimators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.__init__-205"><a href="#DemocraticCoLearning.__init__-205"><span class="linenos">205</span></a>            <span class="n">estimators</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning.__init__-206"><a href="#DemocraticCoLearning.__init__-206"><span class="linenos">206</span></a>            <span class="n">random_available</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning.__init__-207"><a href="#DemocraticCoLearning.__init__-207"><span class="linenos">207</span></a>            <span class="n">rand</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-208"><a href="#DemocraticCoLearning.__init__-208"><span class="linenos">208</span></a>            <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.__init__-209"><a href="#DemocraticCoLearning.__init__-209"><span class="linenos">209</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="DemocraticCoLearning.__init__-210"><a href="#DemocraticCoLearning.__init__-210"><span class="linenos">210</span></a>                    <span class="s2">&quot;The classifier will not be able to converge correctly, there is not enough diversity among the estimators (learners should be different).&quot;</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-211"><a href="#DemocraticCoLearning.__init__-211"><span class="linenos">211</span></a>                    <span class="n">ConvergenceWarning</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-212"><a href="#DemocraticCoLearning.__init__-212"><span class="linenos">212</span></a>                <span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-213"><a href="#DemocraticCoLearning.__init__-213"><span class="linenos">213</span></a>                <span class="n">random_available</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DemocraticCoLearning.__init__-214"><a href="#DemocraticCoLearning.__init__-214"><span class="linenos">214</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.__init__-215"><a href="#DemocraticCoLearning.__init__-215"><span class="linenos">215</span></a>                <span class="n">estimators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skclone</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">))</span>
</span><span id="DemocraticCoLearning.__init__-216"><a href="#DemocraticCoLearning.__init__-216"><span class="linenos">216</span></a>                <span class="k">if</span> <span class="n">random_available</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.__init__-217"><a href="#DemocraticCoLearning.__init__-217"><span class="linenos">217</span></a>                    <span class="n">estimators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-218"><a href="#DemocraticCoLearning.__init__-218"><span class="linenos">218</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="DemocraticCoLearning.__init__-219"><a href="#DemocraticCoLearning.__init__-219"><span class="linenos">219</span></a>
</span><span id="DemocraticCoLearning.__init__-220"><a href="#DemocraticCoLearning.__init__-220"><span class="linenos">220</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.__init__-221"><a href="#DemocraticCoLearning.__init__-221"><span class="linenos">221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning.__init__-222"><a href="#DemocraticCoLearning.__init__-222"><span class="linenos">222</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.__init__-223"><a href="#DemocraticCoLearning.__init__-223"><span class="linenos">223</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="DemocraticCoLearning.__init__-224"><a href="#DemocraticCoLearning.__init__-224"><span class="linenos">224</span></a>                <span class="s2">&quot;If `n_estimators` is None then `base_estimator` must be a `list`.&quot;</span>
</span><span id="DemocraticCoLearning.__init__-225"><a href="#DemocraticCoLearning.__init__-225"><span class="linenos">225</span></a>            <span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-226"><a href="#DemocraticCoLearning.__init__-226"><span class="linenos">226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-227"><a href="#DemocraticCoLearning.__init__-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-228"><a href="#DemocraticCoLearning.__init__-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-229"><a href="#DemocraticCoLearning.__init__-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span> <span class="o">=</span> <span class="n">expand_only_mislabeled</span>
</span><span id="DemocraticCoLearning.__init__-230"><a href="#DemocraticCoLearning.__init__-230"><span class="linenos">230</span></a>
</span><span id="DemocraticCoLearning.__init__-231"><a href="#DemocraticCoLearning.__init__-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</span><span id="DemocraticCoLearning.__init__-232"><a href="#DemocraticCoLearning.__init__-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">q_exp</span> <span class="o">=</span> <span class="n">q_exp</span>
</span><span id="DemocraticCoLearning.__init__-233"><a href="#DemocraticCoLearning.__init__-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span></pre></div>


            <div class="docstring"><p>Democratic Co-learning. Ensemble of classifiers of different types.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> ({ClassifierMixin, list}, optional):
An estimator object implementing fit and predict_proba or a list of ClassifierMixin, by default DecisionTreeClassifier()</li>
<li><strong>n_estimators</strong> (int, optional):
number of base_estimators to use. None if base_estimator is a list, by default None</li>
<li><strong>expand_only_mislabeled</strong> (bool, optional):
expand only mislabeled instances by itself, by default True</li>
<li><strong>alpha</strong> (float, optional):
confidence level, by default 0.95</li>
<li><strong>q_exp</strong> (int, optional):
exponent for the estimation for error rate, by default 2</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>AttributeError</strong>: If n_estimators is None and base_estimator is not a list</li>
</ul>
</div>


                            </div>
                            <div id="DemocraticCoLearning.fit" class="classattr">
                                        <input id="DemocraticCoLearning.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">estimator_kwards</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DemocraticCoLearning.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemocraticCoLearning.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemocraticCoLearning.fit-262"><a href="#DemocraticCoLearning.fit-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">estimator_kwards</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-263"><a href="#DemocraticCoLearning.fit-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Democratic-Co classifier</span>
</span><span id="DemocraticCoLearning.fit-264"><a href="#DemocraticCoLearning.fit-264"><span class="linenos">264</span></a>
</span><span id="DemocraticCoLearning.fit-265"><a href="#DemocraticCoLearning.fit-265"><span class="linenos">265</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning.fit-266"><a href="#DemocraticCoLearning.fit-266"><span class="linenos">266</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning.fit-267"><a href="#DemocraticCoLearning.fit-267"><span class="linenos">267</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DemocraticCoLearning.fit-268"><a href="#DemocraticCoLearning.fit-268"><span class="linenos">268</span></a><span class="sd">            The training input samples.</span>
</span><span id="DemocraticCoLearning.fit-269"><a href="#DemocraticCoLearning.fit-269"><span class="linenos">269</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="DemocraticCoLearning.fit-270"><a href="#DemocraticCoLearning.fit-270"><span class="linenos">270</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="DemocraticCoLearning.fit-271"><a href="#DemocraticCoLearning.fit-271"><span class="linenos">271</span></a><span class="sd">        estimator_kwards : {list, dict}, optional</span>
</span><span id="DemocraticCoLearning.fit-272"><a href="#DemocraticCoLearning.fit-272"><span class="linenos">272</span></a><span class="sd">            list of kwards for each estimator or kwards for all estimators, by default None</span>
</span><span id="DemocraticCoLearning.fit-273"><a href="#DemocraticCoLearning.fit-273"><span class="linenos">273</span></a>
</span><span id="DemocraticCoLearning.fit-274"><a href="#DemocraticCoLearning.fit-274"><span class="linenos">274</span></a><span class="sd">        Returns</span>
</span><span id="DemocraticCoLearning.fit-275"><a href="#DemocraticCoLearning.fit-275"><span class="linenos">275</span></a><span class="sd">        -------</span>
</span><span id="DemocraticCoLearning.fit-276"><a href="#DemocraticCoLearning.fit-276"><span class="linenos">276</span></a><span class="sd">        self : DemocraticCoLearning</span>
</span><span id="DemocraticCoLearning.fit-277"><a href="#DemocraticCoLearning.fit-277"><span class="linenos">277</span></a><span class="sd">            fitted classifier</span>
</span><span id="DemocraticCoLearning.fit-278"><a href="#DemocraticCoLearning.fit-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning.fit-279"><a href="#DemocraticCoLearning.fit-279"><span class="linenos">279</span></a>
</span><span id="DemocraticCoLearning.fit-280"><a href="#DemocraticCoLearning.fit-280"><span class="linenos">280</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-281"><a href="#DemocraticCoLearning.fit-281"><span class="linenos">281</span></a>
</span><span id="DemocraticCoLearning.fit-282"><a href="#DemocraticCoLearning.fit-282"><span class="linenos">282</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-283"><a href="#DemocraticCoLearning.fit-283"><span class="linenos">283</span></a>
</span><span id="DemocraticCoLearning.fit-284"><a href="#DemocraticCoLearning.fit-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-285"><a href="#DemocraticCoLearning.fit-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-286"><a href="#DemocraticCoLearning.fit-286"><span class="linenos">286</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-287"><a href="#DemocraticCoLearning.fit-287"><span class="linenos">287</span></a>
</span><span id="DemocraticCoLearning.fit-288"><a href="#DemocraticCoLearning.fit-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DemocraticCoLearning.fit-289"><a href="#DemocraticCoLearning.fit-289"><span class="linenos">289</span></a>
</span><span id="DemocraticCoLearning.fit-290"><a href="#DemocraticCoLearning.fit-290"><span class="linenos">290</span></a>        <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">X_label</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-291"><a href="#DemocraticCoLearning.fit-291"><span class="linenos">291</span></a>        <span class="n">Ly</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-292"><a href="#DemocraticCoLearning.fit-292"><span class="linenos">292</span></a>        <span class="c1"># This variable prevents duplicate instances.</span>
</span><span id="DemocraticCoLearning.fit-293"><a href="#DemocraticCoLearning.fit-293"><span class="linenos">293</span></a>        <span class="n">L_added</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-294"><a href="#DemocraticCoLearning.fit-294"><span class="linenos">294</span></a>        <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-295"><a href="#DemocraticCoLearning.fit-295"><span class="linenos">295</span></a>
</span><span id="DemocraticCoLearning.fit-296"><a href="#DemocraticCoLearning.fit-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">estimator_kwards</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-297"><a href="#DemocraticCoLearning.fit-297"><span class="linenos">297</span></a>            <span class="n">estimator_kwards</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-298"><a href="#DemocraticCoLearning.fit-298"><span class="linenos">298</span></a>
</span><span id="DemocraticCoLearning.fit-299"><a href="#DemocraticCoLearning.fit-299"><span class="linenos">299</span></a>        <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning.fit-300"><a href="#DemocraticCoLearning.fit-300"><span class="linenos">300</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DemocraticCoLearning.fit-301"><a href="#DemocraticCoLearning.fit-301"><span class="linenos">301</span></a>        <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-302"><a href="#DemocraticCoLearning.fit-302"><span class="linenos">302</span></a>            <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DemocraticCoLearning.fit-303"><a href="#DemocraticCoLearning.fit-303"><span class="linenos">303</span></a>            <span class="n">iteration_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DemocraticCoLearning.fit-304"><a href="#DemocraticCoLearning.fit-304"><span class="linenos">304</span></a>            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DemocraticCoLearning.fit-305"><a href="#DemocraticCoLearning.fit-305"><span class="linenos">305</span></a>
</span><span id="DemocraticCoLearning.fit-306"><a href="#DemocraticCoLearning.fit-306"><span class="linenos">306</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-307"><a href="#DemocraticCoLearning.fit-307"><span class="linenos">307</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">estimator_kwards</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning.fit-308"><a href="#DemocraticCoLearning.fit-308"><span class="linenos">308</span></a>            <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-309"><a href="#DemocraticCoLearning.fit-309"><span class="linenos">309</span></a>                <span class="k">break</span>
</span><span id="DemocraticCoLearning.fit-310"><a href="#DemocraticCoLearning.fit-310"><span class="linenos">310</span></a>            <span class="c1"># Majority Vote</span>
</span><span id="DemocraticCoLearning.fit-311"><a href="#DemocraticCoLearning.fit-311"><span class="linenos">311</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span> <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-312"><a href="#DemocraticCoLearning.fit-312"><span class="linenos">312</span></a>            <span class="n">majority_class</span> <span class="o">=</span> <span class="n">mode</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-313"><a href="#DemocraticCoLearning.fit-313"><span class="linenos">313</span></a>            <span class="c1"># majority_class = st.mode(np.array(predictions, dtype=predictions[0].dtype), axis=0, keepdims=True)[</span>
</span><span id="DemocraticCoLearning.fit-314"><a href="#DemocraticCoLearning.fit-314"><span class="linenos">314</span></a>            <span class="c1">#     0</span>
</span><span id="DemocraticCoLearning.fit-315"><a href="#DemocraticCoLearning.fit-315"><span class="linenos">315</span></a>            <span class="c1"># ].flatten()  # K in pseudocode</span>
</span><span id="DemocraticCoLearning.fit-316"><a href="#DemocraticCoLearning.fit-316"><span class="linenos">316</span></a>
</span><span id="DemocraticCoLearning.fit-317"><a href="#DemocraticCoLearning.fit-317"><span class="linenos">317</span></a>            <span class="n">L_</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-318"><a href="#DemocraticCoLearning.fit-318"><span class="linenos">318</span></a>            <span class="n">Ly_</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-319"><a href="#DemocraticCoLearning.fit-319"><span class="linenos">319</span></a>
</span><span id="DemocraticCoLearning.fit-320"><a href="#DemocraticCoLearning.fit-320"><span class="linenos">320</span></a>            <span class="c1"># Calculate confidence interval</span>
</span><span id="DemocraticCoLearning.fit-321"><a href="#DemocraticCoLearning.fit-321"><span class="linenos">321</span></a>            <span class="n">conf_interval</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DemocraticCoLearning.fit-322"><a href="#DemocraticCoLearning.fit-322"><span class="linenos">322</span></a>                <span class="n">confidence_interval</span><span class="p">(</span>
</span><span id="DemocraticCoLearning.fit-323"><a href="#DemocraticCoLearning.fit-323"><span class="linenos">323</span></a>                    <span class="n">X_label</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.fit-324"><a href="#DemocraticCoLearning.fit-324"><span class="linenos">324</span></a>                    <span class="n">H</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.fit-325"><a href="#DemocraticCoLearning.fit-325"><span class="linenos">325</span></a>                    <span class="n">y_label</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.fit-326"><a href="#DemocraticCoLearning.fit-326"><span class="linenos">326</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
</span><span id="DemocraticCoLearning.fit-327"><a href="#DemocraticCoLearning.fit-327"><span class="linenos">327</span></a>                <span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-328"><a href="#DemocraticCoLearning.fit-328"><span class="linenos">328</span></a>                <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning.fit-329"><a href="#DemocraticCoLearning.fit-329"><span class="linenos">329</span></a>            <span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-330"><a href="#DemocraticCoLearning.fit-330"><span class="linenos">330</span></a>
</span><span id="DemocraticCoLearning.fit-331"><a href="#DemocraticCoLearning.fit-331"><span class="linenos">331</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="p">[(</span><span class="n">li</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="n">hi</span><span class="p">)</span> <span class="ow">in</span> <span class="n">conf_interval</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-332"><a href="#DemocraticCoLearning.fit-332"><span class="linenos">332</span></a>            <span class="n">iteration_dict</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DemocraticCoLearning.fit-333"><a href="#DemocraticCoLearning.fit-333"><span class="linenos">333</span></a>                <span class="s2">&quot;cl&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-334"><a href="#DemocraticCoLearning.fit-334"><span class="linenos">334</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">conf_interval</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>
</span><span id="DemocraticCoLearning.fit-335"><a href="#DemocraticCoLearning.fit-335"><span class="linenos">335</span></a>            <span class="p">}</span>
</span><span id="DemocraticCoLearning.fit-336"><a href="#DemocraticCoLearning.fit-336"><span class="linenos">336</span></a>            <span class="c1"># weighted vote</span>
</span><span id="DemocraticCoLearning.fit-337"><a href="#DemocraticCoLearning.fit-337"><span class="linenos">337</span></a>            <span class="n">weighted_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__weighted_y</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-338"><a href="#DemocraticCoLearning.fit-338"><span class="linenos">338</span></a>
</span><span id="DemocraticCoLearning.fit-339"><a href="#DemocraticCoLearning.fit-339"><span class="linenos">339</span></a>            <span class="c1"># If `weighted_class` is equal as `majority_class` then</span>
</span><span id="DemocraticCoLearning.fit-340"><a href="#DemocraticCoLearning.fit-340"><span class="linenos">340</span></a>            <span class="c1"># the sum of classifier&#39;s weights of max voted class</span>
</span><span id="DemocraticCoLearning.fit-341"><a href="#DemocraticCoLearning.fit-341"><span class="linenos">341</span></a>            <span class="c1"># is greater than the max of sum of classifier&#39;s weights</span>
</span><span id="DemocraticCoLearning.fit-342"><a href="#DemocraticCoLearning.fit-342"><span class="linenos">342</span></a>            <span class="c1"># from another classes.</span>
</span><span id="DemocraticCoLearning.fit-343"><a href="#DemocraticCoLearning.fit-343"><span class="linenos">343</span></a>
</span><span id="DemocraticCoLearning.fit-344"><a href="#DemocraticCoLearning.fit-344"><span class="linenos">344</span></a>            <span class="n">candidates</span> <span class="o">=</span> <span class="n">weighted_class</span> <span class="o">==</span> <span class="n">majority_class</span>
</span><span id="DemocraticCoLearning.fit-345"><a href="#DemocraticCoLearning.fit-345"><span class="linenos">345</span></a>            <span class="n">candidates_bool</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning.fit-346"><a href="#DemocraticCoLearning.fit-346"><span class="linenos">346</span></a>
</span><span id="DemocraticCoLearning.fit-347"><a href="#DemocraticCoLearning.fit-347"><span class="linenos">347</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-348"><a href="#DemocraticCoLearning.fit-348"><span class="linenos">348</span></a>                <span class="n">all_same_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning.fit-349"><a href="#DemocraticCoLearning.fit-349"><span class="linenos">349</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-350"><a href="#DemocraticCoLearning.fit-350"><span class="linenos">350</span></a>                    <span class="n">all_same_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="DemocraticCoLearning.fit-351"><a href="#DemocraticCoLearning.fit-351"><span class="linenos">351</span></a>                <span class="n">all_same</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">*</span><span class="n">all_same_list</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-352"><a href="#DemocraticCoLearning.fit-352"><span class="linenos">352</span></a>            <span class="c1"># new_instances = []</span>
</span><span id="DemocraticCoLearning.fit-353"><a href="#DemocraticCoLearning.fit-353"><span class="linenos">353</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-354"><a href="#DemocraticCoLearning.fit-354"><span class="linenos">354</span></a>
</span><span id="DemocraticCoLearning.fit-355"><a href="#DemocraticCoLearning.fit-355"><span class="linenos">355</span></a>                <span class="n">mispredictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">weighted_class</span>
</span><span id="DemocraticCoLearning.fit-356"><a href="#DemocraticCoLearning.fit-356"><span class="linenos">356</span></a>                <span class="c1"># An instance from U are added to Li&#39; only if:</span>
</span><span id="DemocraticCoLearning.fit-357"><a href="#DemocraticCoLearning.fit-357"><span class="linenos">357</span></a>                <span class="c1">#   It is a misprediction for i</span>
</span><span id="DemocraticCoLearning.fit-358"><a href="#DemocraticCoLearning.fit-358"><span class="linenos">358</span></a>                <span class="c1">#   It is a candidate (weighted_class are same majority_class)</span>
</span><span id="DemocraticCoLearning.fit-359"><a href="#DemocraticCoLearning.fit-359"><span class="linenos">359</span></a>                <span class="c1">#   It hasn&#39;t been added yet in Li</span>
</span><span id="DemocraticCoLearning.fit-360"><a href="#DemocraticCoLearning.fit-360"><span class="linenos">360</span></a>
</span><span id="DemocraticCoLearning.fit-361"><a href="#DemocraticCoLearning.fit-361"><span class="linenos">361</span></a>                <span class="n">candidates_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">mispredictions</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-362"><a href="#DemocraticCoLearning.fit-362"><span class="linenos">362</span></a>
</span><span id="DemocraticCoLearning.fit-363"><a href="#DemocraticCoLearning.fit-363"><span class="linenos">363</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-364"><a href="#DemocraticCoLearning.fit-364"><span class="linenos">364</span></a>                    <span class="n">candidates_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">candidates_temp</span><span class="p">,</span> <span class="n">all_same</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-365"><a href="#DemocraticCoLearning.fit-365"><span class="linenos">365</span></a>
</span><span id="DemocraticCoLearning.fit-366"><a href="#DemocraticCoLearning.fit-366"><span class="linenos">366</span></a>                <span class="n">to_add</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">candidates_temp</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-367"><a href="#DemocraticCoLearning.fit-367"><span class="linenos">367</span></a>
</span><span id="DemocraticCoLearning.fit-368"><a href="#DemocraticCoLearning.fit-368"><span class="linenos">368</span></a>                <span class="n">candidates_bool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_add</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-369"><a href="#DemocraticCoLearning.fit-369"><span class="linenos">369</span></a>                <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-370"><a href="#DemocraticCoLearning.fit-370"><span class="linenos">370</span></a>                    <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="DemocraticCoLearning.fit-371"><a href="#DemocraticCoLearning.fit-371"><span class="linenos">371</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-372"><a href="#DemocraticCoLearning.fit-372"><span class="linenos">372</span></a>                    <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="DemocraticCoLearning.fit-373"><a href="#DemocraticCoLearning.fit-373"><span class="linenos">373</span></a>                <span class="n">Ly_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">weighted_class</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-374"><a href="#DemocraticCoLearning.fit-374"><span class="linenos">374</span></a>
</span><span id="DemocraticCoLearning.fit-375"><a href="#DemocraticCoLearning.fit-375"><span class="linenos">375</span></a>            <span class="n">new_conf_interval</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DemocraticCoLearning.fit-376"><a href="#DemocraticCoLearning.fit-376"><span class="linenos">376</span></a>                <span class="n">confidence_interval</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">H</span><span class="p">,</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-377"><a href="#DemocraticCoLearning.fit-377"><span class="linenos">377</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-378"><a href="#DemocraticCoLearning.fit-378"><span class="linenos">378</span></a>            <span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-379"><a href="#DemocraticCoLearning.fit-379"><span class="linenos">379</span></a>            <span class="n">e_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">l_</span> <span class="k">for</span> <span class="n">l_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">new_conf_interval</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-380"><a href="#DemocraticCoLearning.fit-380"><span class="linenos">380</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-381"><a href="#DemocraticCoLearning.fit-381"><span class="linenos">381</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-382"><a href="#DemocraticCoLearning.fit-382"><span class="linenos">382</span></a>
</span><span id="DemocraticCoLearning.fit-383"><a href="#DemocraticCoLearning.fit-383"><span class="linenos">383</span></a>                    <span class="n">qi</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-384"><a href="#DemocraticCoLearning.fit-384"><span class="linenos">384</span></a>                    <span class="n">e_i</span> <span class="o">=</span> <span class="n">e_factor</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning.fit-385"><a href="#DemocraticCoLearning.fit-385"><span class="linenos">385</span></a>                    <span class="c1"># |Li|+|L&#39;i| == |Li U L&#39;i| because of to_add</span>
</span><span id="DemocraticCoLearning.fit-386"><a href="#DemocraticCoLearning.fit-386"><span class="linenos">386</span></a>                    <span class="n">q_i</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="DemocraticCoLearning.fit-387"><a href="#DemocraticCoLearning.fit-387"><span class="linenos">387</span></a>                        <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="DemocraticCoLearning.fit-388"><a href="#DemocraticCoLearning.fit-388"><span class="linenos">388</span></a>                    <span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_exp</span>
</span><span id="DemocraticCoLearning.fit-389"><a href="#DemocraticCoLearning.fit-389"><span class="linenos">389</span></a>                    <span class="k">if</span> <span class="n">q_i</span> <span class="o">&lt;=</span> <span class="n">qi</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-390"><a href="#DemocraticCoLearning.fit-390"><span class="linenos">390</span></a>                        <span class="k">continue</span>
</span><span id="DemocraticCoLearning.fit-391"><a href="#DemocraticCoLearning.fit-391"><span class="linenos">391</span></a>                    <span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">candidates_bool</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning.fit-392"><a href="#DemocraticCoLearning.fit-392"><span class="linenos">392</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-393"><a href="#DemocraticCoLearning.fit-393"><span class="linenos">393</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="DemocraticCoLearning.fit-394"><a href="#DemocraticCoLearning.fit-394"><span class="linenos">394</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-395"><a href="#DemocraticCoLearning.fit-395"><span class="linenos">395</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</span><span id="DemocraticCoLearning.fit-396"><a href="#DemocraticCoLearning.fit-396"><span class="linenos">396</span></a>                    <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ly_</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</span><span id="DemocraticCoLearning.fit-397"><a href="#DemocraticCoLearning.fit-397"><span class="linenos">397</span></a>
</span><span id="DemocraticCoLearning.fit-398"><a href="#DemocraticCoLearning.fit-398"><span class="linenos">398</span></a>                    <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_i</span>
</span><span id="DemocraticCoLearning.fit-399"><a href="#DemocraticCoLearning.fit-399"><span class="linenos">399</span></a>                    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning.fit-400"><a href="#DemocraticCoLearning.fit-400"><span class="linenos">400</span></a>
</span><span id="DemocraticCoLearning.fit-401"><a href="#DemocraticCoLearning.fit-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning.fit-402"><a href="#DemocraticCoLearning.fit-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__calcule_last_confidences</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-403"><a href="#DemocraticCoLearning.fit-403"><span class="linenos">403</span></a>
</span><span id="DemocraticCoLearning.fit-404"><a href="#DemocraticCoLearning.fit-404"><span class="linenos">404</span></a>        <span class="c1"># Ignore hypothesis</span>
</span><span id="DemocraticCoLearning.fit-405"><a href="#DemocraticCoLearning.fit-405"><span class="linenos">405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">)</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-406"><a href="#DemocraticCoLearning.fit-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-407"><a href="#DemocraticCoLearning.fit-407"><span class="linenos">407</span></a>
</span><span id="DemocraticCoLearning.fit-408"><a href="#DemocraticCoLearning.fit-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-409"><a href="#DemocraticCoLearning.fit-409"><span class="linenos">409</span></a>
</span><span id="DemocraticCoLearning.fit-410"><a href="#DemocraticCoLearning.fit-410"><span class="linenos">410</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit Democratic-Co classifier</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
<li><strong>estimator_kwards</strong> ({list, dict}, optional):
list of kwards for each estimator or kwards for all estimators, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (DemocraticCoLearning):
fitted classifier</li>
</ul>
</div>


                            </div>
                            <div id="DemocraticCoLearning.predict_proba" class="classattr">
                                        <input id="DemocraticCoLearning.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DemocraticCoLearning.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemocraticCoLearning.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemocraticCoLearning.predict_proba-431"><a href="#DemocraticCoLearning.predict_proba-431"><span class="linenos">431</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.predict_proba-432"><a href="#DemocraticCoLearning.predict_proba-432"><span class="linenos">432</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probability for each possible outcome.</span>
</span><span id="DemocraticCoLearning.predict_proba-433"><a href="#DemocraticCoLearning.predict_proba-433"><span class="linenos">433</span></a>
</span><span id="DemocraticCoLearning.predict_proba-434"><a href="#DemocraticCoLearning.predict_proba-434"><span class="linenos">434</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning.predict_proba-435"><a href="#DemocraticCoLearning.predict_proba-435"><span class="linenos">435</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning.predict_proba-436"><a href="#DemocraticCoLearning.predict_proba-436"><span class="linenos">436</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DemocraticCoLearning.predict_proba-437"><a href="#DemocraticCoLearning.predict_proba-437"><span class="linenos">437</span></a><span class="sd">            Array representing the data.</span>
</span><span id="DemocraticCoLearning.predict_proba-438"><a href="#DemocraticCoLearning.predict_proba-438"><span class="linenos">438</span></a><span class="sd">        Returns</span>
</span><span id="DemocraticCoLearning.predict_proba-439"><a href="#DemocraticCoLearning.predict_proba-439"><span class="linenos">439</span></a><span class="sd">        -------</span>
</span><span id="DemocraticCoLearning.predict_proba-440"><a href="#DemocraticCoLearning.predict_proba-440"><span class="linenos">440</span></a><span class="sd">        class probabilities: ndarray of shape (n_samples, n_classes)</span>
</span><span id="DemocraticCoLearning.predict_proba-441"><a href="#DemocraticCoLearning.predict_proba-441"><span class="linenos">441</span></a><span class="sd">            Array with prediction probabilities.</span>
</span><span id="DemocraticCoLearning.predict_proba-442"><a href="#DemocraticCoLearning.predict_proba-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning.predict_proba-443"><a href="#DemocraticCoLearning.predict_proba-443"><span class="linenos">443</span></a>        <span class="k">if</span> <span class="s2">&quot;h_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.predict_proba-444"><a href="#DemocraticCoLearning.predict_proba-444"><span class="linenos">444</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.predict_proba-445"><a href="#DemocraticCoLearning.predict_proba-445"><span class="linenos">445</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.predict_proba-446"><a href="#DemocraticCoLearning.predict_proba-446"><span class="linenos">446</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__combine_probabilities</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.predict_proba-447"><a href="#DemocraticCoLearning.predict_proba-447"><span class="linenos">447</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.predict_proba-448"><a href="#DemocraticCoLearning.predict_proba-448"><span class="linenos">448</span></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span><span class="s2">&quot;Classifier not fitted&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict probability for each possible outcome.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>class probabilities</strong> (ndarray of shape (n_samples, n_classes)):
Array with prediction probabilities.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="DemocraticCoLearning.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="DemocraticCoLearning.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="DemocraticCoLearning.get_params" class="function">get_params</dd>
                <dd id="DemocraticCoLearning.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Rasco">
                            <input id="Rasco-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Rasco</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="Rasco-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Rasco"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Rasco-765"><a href="#Rasco-765"><span class="linenos">765</span></a><span class="k">class</span> <span class="nc">Rasco</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="Rasco-766"><a href="#Rasco-766"><span class="linenos">766</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Rasco-767"><a href="#Rasco-767"><span class="linenos">767</span></a><span class="sd">    **Co-Training based on random subspaces**</span>
</span><span id="Rasco-768"><a href="#Rasco-768"><span class="linenos">768</span></a><span class="sd">    --------------------------------------------</span>
</span><span id="Rasco-769"><a href="#Rasco-769"><span class="linenos">769</span></a>
</span><span id="Rasco-770"><a href="#Rasco-770"><span class="linenos">770</span></a><span class="sd">    Generate a set of random subspaces and train a classifier for each subspace.</span>
</span><span id="Rasco-771"><a href="#Rasco-771"><span class="linenos">771</span></a>
</span><span id="Rasco-772"><a href="#Rasco-772"><span class="linenos">772</span></a><span class="sd">    The main process is:</span>
</span><span id="Rasco-773"><a href="#Rasco-773"><span class="linenos">773</span></a><span class="sd">    1. Generate a set of random subspaces.</span>
</span><span id="Rasco-774"><a href="#Rasco-774"><span class="linenos">774</span></a><span class="sd">    2. Train a classifier for each subspace.</span>
</span><span id="Rasco-775"><a href="#Rasco-775"><span class="linenos">775</span></a><span class="sd">    3. While max iterations is not reached or any instance is unlabeled:</span>
</span><span id="Rasco-776"><a href="#Rasco-776"><span class="linenos">776</span></a><span class="sd">        1. Predict the instances from the unlabeled set for each classifier.</span>
</span><span id="Rasco-777"><a href="#Rasco-777"><span class="linenos">777</span></a><span class="sd">        2. Calculate the average of the predictions.</span>
</span><span id="Rasco-778"><a href="#Rasco-778"><span class="linenos">778</span></a><span class="sd">        3. Select the instances with the highest probability.</span>
</span><span id="Rasco-779"><a href="#Rasco-779"><span class="linenos">779</span></a><span class="sd">        4. Label the instances with the highest probability, keeping the balance of the classes.</span>
</span><span id="Rasco-780"><a href="#Rasco-780"><span class="linenos">780</span></a><span class="sd">        5. Retrain the classifier with the new instances.</span>
</span><span id="Rasco-781"><a href="#Rasco-781"><span class="linenos">781</span></a><span class="sd">    4. Combine the probabilities of each classifier.</span>
</span><span id="Rasco-782"><a href="#Rasco-782"><span class="linenos">782</span></a>
</span><span id="Rasco-783"><a href="#Rasco-783"><span class="linenos">783</span></a><span class="sd">    **Methods**</span>
</span><span id="Rasco-784"><a href="#Rasco-784"><span class="linenos">784</span></a><span class="sd">    -------</span>
</span><span id="Rasco-785"><a href="#Rasco-785"><span class="linenos">785</span></a><span class="sd">    - `fit`: Fit the model with the labeled instances.</span>
</span><span id="Rasco-786"><a href="#Rasco-786"><span class="linenos">786</span></a><span class="sd">    - `predict` : Predict the class for each instance.</span>
</span><span id="Rasco-787"><a href="#Rasco-787"><span class="linenos">787</span></a><span class="sd">    - `predict_proba`: Predict the probability for each class.</span>
</span><span id="Rasco-788"><a href="#Rasco-788"><span class="linenos">788</span></a><span class="sd">    - `score`: Return the mean accuracy on the given test data and labels.</span>
</span><span id="Rasco-789"><a href="#Rasco-789"><span class="linenos">789</span></a>
</span><span id="Rasco-790"><a href="#Rasco-790"><span class="linenos">790</span></a><span class="sd">    **Example**</span>
</span><span id="Rasco-791"><a href="#Rasco-791"><span class="linenos">791</span></a><span class="sd">    -------</span>
</span><span id="Rasco-792"><a href="#Rasco-792"><span class="linenos">792</span></a><span class="sd">    ```python</span>
</span><span id="Rasco-793"><a href="#Rasco-793"><span class="linenos">793</span></a><span class="sd">    from sklearn.datasets import load_iris</span>
</span><span id="Rasco-794"><a href="#Rasco-794"><span class="linenos">794</span></a><span class="sd">    from sslearn.wrapper import Rasco</span>
</span><span id="Rasco-795"><a href="#Rasco-795"><span class="linenos">795</span></a><span class="sd">    from sslearn.model_selection import artificial_ssl_dataset</span>
</span><span id="Rasco-796"><a href="#Rasco-796"><span class="linenos">796</span></a>
</span><span id="Rasco-797"><a href="#Rasco-797"><span class="linenos">797</span></a><span class="sd">    X, y = load_iris(return_X_y=True)</span>
</span><span id="Rasco-798"><a href="#Rasco-798"><span class="linenos">798</span></a><span class="sd">    X, y, X_unlabel, y_unlabel, _, _ = artificial_ssl_dataset(X, y, label_rate=0.1, random_state=0)</span>
</span><span id="Rasco-799"><a href="#Rasco-799"><span class="linenos">799</span></a><span class="sd">    rasco = Rasco()</span>
</span><span id="Rasco-800"><a href="#Rasco-800"><span class="linenos">800</span></a><span class="sd">    rasco.fit(X, y)</span>
</span><span id="Rasco-801"><a href="#Rasco-801"><span class="linenos">801</span></a><span class="sd">    rasco.score(X_unlabel, y_unlabel) </span>
</span><span id="Rasco-802"><a href="#Rasco-802"><span class="linenos">802</span></a><span class="sd">    ```    </span>
</span><span id="Rasco-803"><a href="#Rasco-803"><span class="linenos">803</span></a>
</span><span id="Rasco-804"><a href="#Rasco-804"><span class="linenos">804</span></a><span class="sd">    **References**</span>
</span><span id="Rasco-805"><a href="#Rasco-805"><span class="linenos">805</span></a><span class="sd">    ----------</span>
</span><span id="Rasco-806"><a href="#Rasco-806"><span class="linenos">806</span></a><span class="sd">    Wang, J., Luo, S. W., &amp; Zeng, X. H. (2008).&lt;br&gt;</span>
</span><span id="Rasco-807"><a href="#Rasco-807"><span class="linenos">807</span></a><span class="sd">    A random subspace method for co-training,&lt;br&gt;</span>
</span><span id="Rasco-808"><a href="#Rasco-808"><span class="linenos">808</span></a><span class="sd">    in &lt;i&gt;2008 IEEE International Joint Conference on Neural Networks&lt;/i&gt;&lt;br&gt;</span>
</span><span id="Rasco-809"><a href="#Rasco-809"><span class="linenos">809</span></a><span class="sd">    IEEE World Congress on Computational Intelligence&lt;br&gt;</span>
</span><span id="Rasco-810"><a href="#Rasco-810"><span class="linenos">810</span></a><span class="sd">    (pp. 195-200). IEEE. [10.1109/IJCNN.2008.4633789](https://doi.org/10.1109/IJCNN.2008.4633789)</span>
</span><span id="Rasco-811"><a href="#Rasco-811"><span class="linenos">811</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Rasco-812"><a href="#Rasco-812"><span class="linenos">812</span></a>
</span><span id="Rasco-813"><a href="#Rasco-813"><span class="linenos">813</span></a>
</span><span id="Rasco-814"><a href="#Rasco-814"><span class="linenos">814</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Rasco-815"><a href="#Rasco-815"><span class="linenos">815</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Rasco-816"><a href="#Rasco-816"><span class="linenos">816</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="Rasco-817"><a href="#Rasco-817"><span class="linenos">817</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Rasco-818"><a href="#Rasco-818"><span class="linenos">818</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="Rasco-819"><a href="#Rasco-819"><span class="linenos">819</span></a>        <span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco-820"><a href="#Rasco-820"><span class="linenos">820</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco-821"><a href="#Rasco-821"><span class="linenos">821</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco-822"><a href="#Rasco-822"><span class="linenos">822</span></a>    <span class="p">):</span>
</span><span id="Rasco-823"><a href="#Rasco-823"><span class="linenos">823</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Rasco-824"><a href="#Rasco-824"><span class="linenos">824</span></a><span class="sd">        Co-Training based on random subspaces</span>
</span><span id="Rasco-825"><a href="#Rasco-825"><span class="linenos">825</span></a>
</span><span id="Rasco-826"><a href="#Rasco-826"><span class="linenos">826</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco-827"><a href="#Rasco-827"><span class="linenos">827</span></a><span class="sd">        ----------</span>
</span><span id="Rasco-828"><a href="#Rasco-828"><span class="linenos">828</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="Rasco-829"><a href="#Rasco-829"><span class="linenos">829</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="Rasco-830"><a href="#Rasco-830"><span class="linenos">830</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="Rasco-831"><a href="#Rasco-831"><span class="linenos">831</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0.</span>
</span><span id="Rasco-832"><a href="#Rasco-832"><span class="linenos">832</span></a><span class="sd">            If is -1 then will be infinite iterations until U be empty, by default 10</span>
</span><span id="Rasco-833"><a href="#Rasco-833"><span class="linenos">833</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="Rasco-834"><a href="#Rasco-834"><span class="linenos">834</span></a><span class="sd">            The number of base estimators in the ensemble., by default 30</span>
</span><span id="Rasco-835"><a href="#Rasco-835"><span class="linenos">835</span></a><span class="sd">        subspace_size : int, optional</span>
</span><span id="Rasco-836"><a href="#Rasco-836"><span class="linenos">836</span></a><span class="sd">            The number of features for each subspace. If it is None will be the half of the features size., by default None</span>
</span><span id="Rasco-837"><a href="#Rasco-837"><span class="linenos">837</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="Rasco-838"><a href="#Rasco-838"><span class="linenos">838</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="Rasco-839"><a href="#Rasco-839"><span class="linenos">839</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco-840"><a href="#Rasco-840"><span class="linenos">840</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="p">)</span>  <span class="c1"># C in paper</span>
</span><span id="Rasco-841"><a href="#Rasco-841"><span class="linenos">841</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>  <span class="c1"># J in paper</span>
</span><span id="Rasco-842"><a href="#Rasco-842"><span class="linenos">842</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>  <span class="c1"># K in paper</span>
</span><span id="Rasco-843"><a href="#Rasco-843"><span class="linenos">843</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="o">=</span> <span class="n">subspace_size</span>  <span class="c1"># m in paper</span>
</span><span id="Rasco-844"><a href="#Rasco-844"><span class="linenos">844</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="Rasco-845"><a href="#Rasco-845"><span class="linenos">845</span></a>
</span><span id="Rasco-846"><a href="#Rasco-846"><span class="linenos">846</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="Rasco-847"><a href="#Rasco-847"><span class="linenos">847</span></a>
</span><span id="Rasco-848"><a href="#Rasco-848"><span class="linenos">848</span></a>    <span class="k">def</span> <span class="nf">_generate_random_subspaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Rasco-849"><a href="#Rasco-849"><span class="linenos">849</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate the random subspaces</span>
</span><span id="Rasco-850"><a href="#Rasco-850"><span class="linenos">850</span></a>
</span><span id="Rasco-851"><a href="#Rasco-851"><span class="linenos">851</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco-852"><a href="#Rasco-852"><span class="linenos">852</span></a><span class="sd">        ----------</span>
</span><span id="Rasco-853"><a href="#Rasco-853"><span class="linenos">853</span></a><span class="sd">        X : array like</span>
</span><span id="Rasco-854"><a href="#Rasco-854"><span class="linenos">854</span></a><span class="sd">            Labeled dataset</span>
</span><span id="Rasco-855"><a href="#Rasco-855"><span class="linenos">855</span></a><span class="sd">        y : array like, optional</span>
</span><span id="Rasco-856"><a href="#Rasco-856"><span class="linenos">856</span></a><span class="sd">            Target for each X, not needed on Rasco, by default None</span>
</span><span id="Rasco-857"><a href="#Rasco-857"><span class="linenos">857</span></a>
</span><span id="Rasco-858"><a href="#Rasco-858"><span class="linenos">858</span></a><span class="sd">        Returns</span>
</span><span id="Rasco-859"><a href="#Rasco-859"><span class="linenos">859</span></a><span class="sd">        -------</span>
</span><span id="Rasco-860"><a href="#Rasco-860"><span class="linenos">860</span></a><span class="sd">        subspaces : list</span>
</span><span id="Rasco-861"><a href="#Rasco-861"><span class="linenos">861</span></a><span class="sd">            List of index of features</span>
</span><span id="Rasco-862"><a href="#Rasco-862"><span class="linenos">862</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco-863"><a href="#Rasco-863"><span class="linenos">863</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco-864"><a href="#Rasco-864"><span class="linenos">864</span></a>        <span class="n">features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Rasco-865"><a href="#Rasco-865"><span class="linenos">865</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Rasco-866"><a href="#Rasco-866"><span class="linenos">866</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="Rasco-867"><a href="#Rasco-867"><span class="linenos">867</span></a>            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">features</span><span class="p">)[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span><span class="p">])</span>
</span><span id="Rasco-868"><a href="#Rasco-868"><span class="linenos">868</span></a>        <span class="k">return</span> <span class="n">idxs</span>
</span><span id="Rasco-869"><a href="#Rasco-869"><span class="linenos">869</span></a>
</span><span id="Rasco-870"><a href="#Rasco-870"><span class="linenos">870</span></a>    <span class="k">def</span> <span class="nf">_fit_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Rasco-871"><a href="#Rasco-871"><span class="linenos">871</span></a>        <span class="n">estimator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="Rasco-872"><a href="#Rasco-872"><span class="linenos">872</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="Rasco-873"><a href="#Rasco-873"><span class="linenos">873</span></a>            <span class="n">estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="Rasco-874"><a href="#Rasco-874"><span class="linenos">874</span></a>        <span class="k">return</span> <span class="n">skclone</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco-875"><a href="#Rasco-875"><span class="linenos">875</span></a>
</span><span id="Rasco-876"><a href="#Rasco-876"><span class="linenos">876</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Rasco-877"><a href="#Rasco-877"><span class="linenos">877</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a Rasco classifier from the training set (X, y).</span>
</span><span id="Rasco-878"><a href="#Rasco-878"><span class="linenos">878</span></a>
</span><span id="Rasco-879"><a href="#Rasco-879"><span class="linenos">879</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco-880"><a href="#Rasco-880"><span class="linenos">880</span></a><span class="sd">        ----------</span>
</span><span id="Rasco-881"><a href="#Rasco-881"><span class="linenos">881</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Rasco-882"><a href="#Rasco-882"><span class="linenos">882</span></a><span class="sd">            The training input samples.</span>
</span><span id="Rasco-883"><a href="#Rasco-883"><span class="linenos">883</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Rasco-884"><a href="#Rasco-884"><span class="linenos">884</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="Rasco-885"><a href="#Rasco-885"><span class="linenos">885</span></a>
</span><span id="Rasco-886"><a href="#Rasco-886"><span class="linenos">886</span></a><span class="sd">        Returns</span>
</span><span id="Rasco-887"><a href="#Rasco-887"><span class="linenos">887</span></a><span class="sd">        -------</span>
</span><span id="Rasco-888"><a href="#Rasco-888"><span class="linenos">888</span></a><span class="sd">        self: Rasco</span>
</span><span id="Rasco-889"><a href="#Rasco-889"><span class="linenos">889</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="Rasco-890"><a href="#Rasco-890"><span class="linenos">890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco-891"><a href="#Rasco-891"><span class="linenos">891</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Rasco-892"><a href="#Rasco-892"><span class="linenos">892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco-893"><a href="#Rasco-893"><span class="linenos">893</span></a>
</span><span id="Rasco-894"><a href="#Rasco-894"><span class="linenos">894</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="Rasco-895"><a href="#Rasco-895"><span class="linenos">895</span></a>
</span><span id="Rasco-896"><a href="#Rasco-896"><span class="linenos">896</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco-897"><a href="#Rasco-897"><span class="linenos">897</span></a>
</span><span id="Rasco-898"><a href="#Rasco-898"><span class="linenos">898</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco-899"><a href="#Rasco-899"><span class="linenos">899</span></a>        <span class="n">number_per_class</span> <span class="o">=</span> <span class="n">calc_number_per_class</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco-900"><a href="#Rasco-900"><span class="linenos">900</span></a>
</span><span id="Rasco-901"><a href="#Rasco-901"><span class="linenos">901</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Rasco-902"><a href="#Rasco-902"><span class="linenos">902</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Rasco-903"><a href="#Rasco-903"><span class="linenos">903</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_random_subspaces</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco-904"><a href="#Rasco-904"><span class="linenos">904</span></a>
</span><span id="Rasco-905"><a href="#Rasco-905"><span class="linenos">905</span></a>        <span class="n">cfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="Rasco-906"><a href="#Rasco-906"><span class="linenos">906</span></a>            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco-907"><a href="#Rasco-907"><span class="linenos">907</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="Rasco-908"><a href="#Rasco-908"><span class="linenos">908</span></a>        <span class="p">)</span>
</span><span id="Rasco-909"><a href="#Rasco-909"><span class="linenos">909</span></a>
</span><span id="Rasco-910"><a href="#Rasco-910"><span class="linenos">910</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Rasco-911"><a href="#Rasco-911"><span class="linenos">911</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Rasco-912"><a href="#Rasco-912"><span class="linenos">912</span></a>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">it</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="Rasco-913"><a href="#Rasco-913"><span class="linenos">913</span></a>                <span class="n">X_unlabel</span>
</span><span id="Rasco-914"><a href="#Rasco-914"><span class="linenos">914</span></a>            <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Rasco-915"><a href="#Rasco-915"><span class="linenos">915</span></a>                <span class="k">break</span>
</span><span id="Rasco-916"><a href="#Rasco-916"><span class="linenos">916</span></a>
</span><span id="Rasco-917"><a href="#Rasco-917"><span class="linenos">917</span></a>            <span class="n">raw_predicions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Rasco-918"><a href="#Rasco-918"><span class="linenos">918</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="Rasco-919"><a href="#Rasco-919"><span class="linenos">919</span></a>                <span class="n">rp</span> <span class="o">=</span> <span class="n">cfs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="Rasco-920"><a href="#Rasco-920"><span class="linenos">920</span></a>                <span class="n">raw_predicions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span>
</span><span id="Rasco-921"><a href="#Rasco-921"><span class="linenos">921</span></a>            <span class="n">raw_predicions</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="Rasco-922"><a href="#Rasco-922"><span class="linenos">922</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Rasco-923"><a href="#Rasco-923"><span class="linenos">923</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Rasco-924"><a href="#Rasco-924"><span class="linenos">924</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">class_predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Rasco-925"><a href="#Rasco-925"><span class="linenos">925</span></a>
</span><span id="Rasco-926"><a href="#Rasco-926"><span class="linenos">926</span></a>            <span class="n">final_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Rasco-927"><a href="#Rasco-927"><span class="linenos">927</span></a>            <span class="n">best_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Rasco-928"><a href="#Rasco-928"><span class="linenos">928</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="Rasco-929"><a href="#Rasco-929"><span class="linenos">929</span></a>                <span class="n">final_instances</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">best_candidates</span><span class="p">[</span><span class="n">pseudoy</span><span class="p">[</span><span class="n">best_candidates</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">])[:</span><span class="n">number_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span>
</span><span id="Rasco-930"><a href="#Rasco-930"><span class="linenos">930</span></a>
</span><span id="Rasco-931"><a href="#Rasco-931"><span class="linenos">931</span></a>            <span class="n">Lj</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="Rasco-932"><a href="#Rasco-932"><span class="linenos">932</span></a>            <span class="n">yj</span> <span class="o">=</span> <span class="n">pseudoy</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="Rasco-933"><a href="#Rasco-933"><span class="linenos">933</span></a>
</span><span id="Rasco-934"><a href="#Rasco-934"><span class="linenos">934</span></a>            <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Lj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Lj</span><span class="p">])</span>
</span><span id="Rasco-935"><a href="#Rasco-935"><span class="linenos">935</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span>
</span><span id="Rasco-936"><a href="#Rasco-936"><span class="linenos">936</span></a>            <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">final_instances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">final_instances</span><span class="p">])</span>
</span><span id="Rasco-937"><a href="#Rasco-937"><span class="linenos">937</span></a>
</span><span id="Rasco-938"><a href="#Rasco-938"><span class="linenos">938</span></a>            <span class="n">cfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="Rasco-939"><a href="#Rasco-939"><span class="linenos">939</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco-940"><a href="#Rasco-940"><span class="linenos">940</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="Rasco-941"><a href="#Rasco-941"><span class="linenos">941</span></a>            <span class="p">)</span>
</span><span id="Rasco-942"><a href="#Rasco-942"><span class="linenos">942</span></a>
</span><span id="Rasco-943"><a href="#Rasco-943"><span class="linenos">943</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Rasco-944"><a href="#Rasco-944"><span class="linenos">944</span></a>
</span><span id="Rasco-945"><a href="#Rasco-945"><span class="linenos">945</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">cfs</span>
</span><span id="Rasco-946"><a href="#Rasco-946"><span class="linenos">946</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="n">idxs</span>
</span><span id="Rasco-947"><a href="#Rasco-947"><span class="linenos">947</span></a>
</span><span id="Rasco-948"><a href="#Rasco-948"><span class="linenos">948</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><h2 id="co-training-based-on-random-subspaces"><strong>Co-Training based on random subspaces</strong></h2>

<p>Generate a set of random subspaces and train a classifier for each subspace.</p>

<p>The main process is:</p>

<ol>
<li>Generate a set of random subspaces.</li>
<li>Train a classifier for each subspace.</li>
<li>While max iterations is not reached or any instance is unlabeled:
<ol>
<li>Predict the instances from the unlabeled set for each classifier.</li>
<li>Calculate the average of the predictions.</li>
<li>Select the instances with the highest probability.</li>
<li>Label the instances with the highest probability, keeping the balance of the classes.</li>
<li>Retrain the classifier with the new instances.</li>
</ol></li>
<li>Combine the probabilities of each classifier.</li>
</ol>

<h2 id="methods"><strong>Methods</strong></h2>

<ul>
<li><code><a href="#Rasco.fit">fit</a></code>: Fit the model with the labeled instances.</li>
<li><code><a href="#Rasco.predict">predict</a></code> : Predict the class for each instance.</li>
<li><code><a href="#Rasco.predict_proba">predict_proba</a></code>: Predict the probability for each class.</li>
<li><code><a href="#Rasco.score">score</a></code>: Return the mean accuracy on the given test data and labels.</li>
</ul>

<h2 id="example"><strong>Example</strong></h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn"><a href="">sslearn.wrapper</a></span> <span class="kn">import</span> <span class="n">Rasco</span>
<span class="kn">from</span> <span class="nn"><a href="model_selection.html">sslearn.model_selection</a></span> <span class="kn">import</span> <span class="n">artificial_ssl_dataset</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">artificial_ssl_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">rasco</span> <span class="o">=</span> <span class="n">Rasco</span><span class="p">()</span>
<span class="n">rasco</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">rasco</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">)</span> 
</code></pre>
</div>

<h2 id="references"><strong>References</strong></h2>

<p>Wang, J., Luo, S. W., &amp; Zeng, X. H. (2008).<br>
A random subspace method for co-training,<br>
in <i>2008 IEEE International Joint Conference on Neural Networks</i><br>
IEEE World Congress on Computational Intelligence<br>
(pp. 195-200). IEEE. <a href="https://doi.org/10.1109/IJCNN.2008.4633789">10.1109/IJCNN.2008.4633789</a></p>
</div>


                            <div id="Rasco.__init__" class="classattr">
                                        <input id="Rasco.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Rasco</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span>,</span><span class="param">	<span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Rasco.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Rasco.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Rasco.__init__-814"><a href="#Rasco.__init__-814"><span class="linenos">814</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Rasco.__init__-815"><a href="#Rasco.__init__-815"><span class="linenos">815</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Rasco.__init__-816"><a href="#Rasco.__init__-816"><span class="linenos">816</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="Rasco.__init__-817"><a href="#Rasco.__init__-817"><span class="linenos">817</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Rasco.__init__-818"><a href="#Rasco.__init__-818"><span class="linenos">818</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="Rasco.__init__-819"><a href="#Rasco.__init__-819"><span class="linenos">819</span></a>        <span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco.__init__-820"><a href="#Rasco.__init__-820"><span class="linenos">820</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco.__init__-821"><a href="#Rasco.__init__-821"><span class="linenos">821</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco.__init__-822"><a href="#Rasco.__init__-822"><span class="linenos">822</span></a>    <span class="p">):</span>
</span><span id="Rasco.__init__-823"><a href="#Rasco.__init__-823"><span class="linenos">823</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Rasco.__init__-824"><a href="#Rasco.__init__-824"><span class="linenos">824</span></a><span class="sd">        Co-Training based on random subspaces</span>
</span><span id="Rasco.__init__-825"><a href="#Rasco.__init__-825"><span class="linenos">825</span></a>
</span><span id="Rasco.__init__-826"><a href="#Rasco.__init__-826"><span class="linenos">826</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco.__init__-827"><a href="#Rasco.__init__-827"><span class="linenos">827</span></a><span class="sd">        ----------</span>
</span><span id="Rasco.__init__-828"><a href="#Rasco.__init__-828"><span class="linenos">828</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="Rasco.__init__-829"><a href="#Rasco.__init__-829"><span class="linenos">829</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="Rasco.__init__-830"><a href="#Rasco.__init__-830"><span class="linenos">830</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="Rasco.__init__-831"><a href="#Rasco.__init__-831"><span class="linenos">831</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0.</span>
</span><span id="Rasco.__init__-832"><a href="#Rasco.__init__-832"><span class="linenos">832</span></a><span class="sd">            If is -1 then will be infinite iterations until U be empty, by default 10</span>
</span><span id="Rasco.__init__-833"><a href="#Rasco.__init__-833"><span class="linenos">833</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="Rasco.__init__-834"><a href="#Rasco.__init__-834"><span class="linenos">834</span></a><span class="sd">            The number of base estimators in the ensemble., by default 30</span>
</span><span id="Rasco.__init__-835"><a href="#Rasco.__init__-835"><span class="linenos">835</span></a><span class="sd">        subspace_size : int, optional</span>
</span><span id="Rasco.__init__-836"><a href="#Rasco.__init__-836"><span class="linenos">836</span></a><span class="sd">            The number of features for each subspace. If it is None will be the half of the features size., by default None</span>
</span><span id="Rasco.__init__-837"><a href="#Rasco.__init__-837"><span class="linenos">837</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="Rasco.__init__-838"><a href="#Rasco.__init__-838"><span class="linenos">838</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="Rasco.__init__-839"><a href="#Rasco.__init__-839"><span class="linenos">839</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco.__init__-840"><a href="#Rasco.__init__-840"><span class="linenos">840</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="p">)</span>  <span class="c1"># C in paper</span>
</span><span id="Rasco.__init__-841"><a href="#Rasco.__init__-841"><span class="linenos">841</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>  <span class="c1"># J in paper</span>
</span><span id="Rasco.__init__-842"><a href="#Rasco.__init__-842"><span class="linenos">842</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>  <span class="c1"># K in paper</span>
</span><span id="Rasco.__init__-843"><a href="#Rasco.__init__-843"><span class="linenos">843</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="o">=</span> <span class="n">subspace_size</span>  <span class="c1"># m in paper</span>
</span><span id="Rasco.__init__-844"><a href="#Rasco.__init__-844"><span class="linenos">844</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="Rasco.__init__-845"><a href="#Rasco.__init__-845"><span class="linenos">845</span></a>
</span><span id="Rasco.__init__-846"><a href="#Rasco.__init__-846"><span class="linenos">846</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span></pre></div>


            <div class="docstring"><p>Co-Training based on random subspaces</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>max_iterations</strong> (int, optional):
Maximum number of iterations allowed. Should be greater than or equal to 0.
If is -1 then will be infinite iterations until U be empty, by default 10</li>
<li><strong>n_estimators</strong> (int, optional):
The number of base estimators in the ensemble., by default 30</li>
<li><strong>subspace_size</strong> (int, optional):
The number of features for each subspace. If it is None will be the half of the features size., by default None</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>
</div>


                            </div>
                            <div id="Rasco.fit" class="classattr">
                                        <input id="Rasco.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Rasco.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Rasco.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Rasco.fit-876"><a href="#Rasco.fit-876"><span class="linenos">876</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Rasco.fit-877"><a href="#Rasco.fit-877"><span class="linenos">877</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a Rasco classifier from the training set (X, y).</span>
</span><span id="Rasco.fit-878"><a href="#Rasco.fit-878"><span class="linenos">878</span></a>
</span><span id="Rasco.fit-879"><a href="#Rasco.fit-879"><span class="linenos">879</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco.fit-880"><a href="#Rasco.fit-880"><span class="linenos">880</span></a><span class="sd">        ----------</span>
</span><span id="Rasco.fit-881"><a href="#Rasco.fit-881"><span class="linenos">881</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Rasco.fit-882"><a href="#Rasco.fit-882"><span class="linenos">882</span></a><span class="sd">            The training input samples.</span>
</span><span id="Rasco.fit-883"><a href="#Rasco.fit-883"><span class="linenos">883</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Rasco.fit-884"><a href="#Rasco.fit-884"><span class="linenos">884</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="Rasco.fit-885"><a href="#Rasco.fit-885"><span class="linenos">885</span></a>
</span><span id="Rasco.fit-886"><a href="#Rasco.fit-886"><span class="linenos">886</span></a><span class="sd">        Returns</span>
</span><span id="Rasco.fit-887"><a href="#Rasco.fit-887"><span class="linenos">887</span></a><span class="sd">        -------</span>
</span><span id="Rasco.fit-888"><a href="#Rasco.fit-888"><span class="linenos">888</span></a><span class="sd">        self: Rasco</span>
</span><span id="Rasco.fit-889"><a href="#Rasco.fit-889"><span class="linenos">889</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="Rasco.fit-890"><a href="#Rasco.fit-890"><span class="linenos">890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco.fit-891"><a href="#Rasco.fit-891"><span class="linenos">891</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Rasco.fit-892"><a href="#Rasco.fit-892"><span class="linenos">892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco.fit-893"><a href="#Rasco.fit-893"><span class="linenos">893</span></a>
</span><span id="Rasco.fit-894"><a href="#Rasco.fit-894"><span class="linenos">894</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="Rasco.fit-895"><a href="#Rasco.fit-895"><span class="linenos">895</span></a>
</span><span id="Rasco.fit-896"><a href="#Rasco.fit-896"><span class="linenos">896</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco.fit-897"><a href="#Rasco.fit-897"><span class="linenos">897</span></a>
</span><span id="Rasco.fit-898"><a href="#Rasco.fit-898"><span class="linenos">898</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco.fit-899"><a href="#Rasco.fit-899"><span class="linenos">899</span></a>        <span class="n">number_per_class</span> <span class="o">=</span> <span class="n">calc_number_per_class</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco.fit-900"><a href="#Rasco.fit-900"><span class="linenos">900</span></a>
</span><span id="Rasco.fit-901"><a href="#Rasco.fit-901"><span class="linenos">901</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Rasco.fit-902"><a href="#Rasco.fit-902"><span class="linenos">902</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Rasco.fit-903"><a href="#Rasco.fit-903"><span class="linenos">903</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_random_subspaces</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco.fit-904"><a href="#Rasco.fit-904"><span class="linenos">904</span></a>
</span><span id="Rasco.fit-905"><a href="#Rasco.fit-905"><span class="linenos">905</span></a>        <span class="n">cfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="Rasco.fit-906"><a href="#Rasco.fit-906"><span class="linenos">906</span></a>            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco.fit-907"><a href="#Rasco.fit-907"><span class="linenos">907</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="Rasco.fit-908"><a href="#Rasco.fit-908"><span class="linenos">908</span></a>        <span class="p">)</span>
</span><span id="Rasco.fit-909"><a href="#Rasco.fit-909"><span class="linenos">909</span></a>
</span><span id="Rasco.fit-910"><a href="#Rasco.fit-910"><span class="linenos">910</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Rasco.fit-911"><a href="#Rasco.fit-911"><span class="linenos">911</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Rasco.fit-912"><a href="#Rasco.fit-912"><span class="linenos">912</span></a>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">it</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="Rasco.fit-913"><a href="#Rasco.fit-913"><span class="linenos">913</span></a>                <span class="n">X_unlabel</span>
</span><span id="Rasco.fit-914"><a href="#Rasco.fit-914"><span class="linenos">914</span></a>            <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Rasco.fit-915"><a href="#Rasco.fit-915"><span class="linenos">915</span></a>                <span class="k">break</span>
</span><span id="Rasco.fit-916"><a href="#Rasco.fit-916"><span class="linenos">916</span></a>
</span><span id="Rasco.fit-917"><a href="#Rasco.fit-917"><span class="linenos">917</span></a>            <span class="n">raw_predicions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Rasco.fit-918"><a href="#Rasco.fit-918"><span class="linenos">918</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="Rasco.fit-919"><a href="#Rasco.fit-919"><span class="linenos">919</span></a>                <span class="n">rp</span> <span class="o">=</span> <span class="n">cfs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="Rasco.fit-920"><a href="#Rasco.fit-920"><span class="linenos">920</span></a>                <span class="n">raw_predicions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span>
</span><span id="Rasco.fit-921"><a href="#Rasco.fit-921"><span class="linenos">921</span></a>            <span class="n">raw_predicions</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="Rasco.fit-922"><a href="#Rasco.fit-922"><span class="linenos">922</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Rasco.fit-923"><a href="#Rasco.fit-923"><span class="linenos">923</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Rasco.fit-924"><a href="#Rasco.fit-924"><span class="linenos">924</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">class_predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Rasco.fit-925"><a href="#Rasco.fit-925"><span class="linenos">925</span></a>
</span><span id="Rasco.fit-926"><a href="#Rasco.fit-926"><span class="linenos">926</span></a>            <span class="n">final_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Rasco.fit-927"><a href="#Rasco.fit-927"><span class="linenos">927</span></a>            <span class="n">best_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Rasco.fit-928"><a href="#Rasco.fit-928"><span class="linenos">928</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="Rasco.fit-929"><a href="#Rasco.fit-929"><span class="linenos">929</span></a>                <span class="n">final_instances</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">best_candidates</span><span class="p">[</span><span class="n">pseudoy</span><span class="p">[</span><span class="n">best_candidates</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">])[:</span><span class="n">number_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span>
</span><span id="Rasco.fit-930"><a href="#Rasco.fit-930"><span class="linenos">930</span></a>
</span><span id="Rasco.fit-931"><a href="#Rasco.fit-931"><span class="linenos">931</span></a>            <span class="n">Lj</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="Rasco.fit-932"><a href="#Rasco.fit-932"><span class="linenos">932</span></a>            <span class="n">yj</span> <span class="o">=</span> <span class="n">pseudoy</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="Rasco.fit-933"><a href="#Rasco.fit-933"><span class="linenos">933</span></a>
</span><span id="Rasco.fit-934"><a href="#Rasco.fit-934"><span class="linenos">934</span></a>            <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Lj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Lj</span><span class="p">])</span>
</span><span id="Rasco.fit-935"><a href="#Rasco.fit-935"><span class="linenos">935</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span>
</span><span id="Rasco.fit-936"><a href="#Rasco.fit-936"><span class="linenos">936</span></a>            <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">final_instances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">final_instances</span><span class="p">])</span>
</span><span id="Rasco.fit-937"><a href="#Rasco.fit-937"><span class="linenos">937</span></a>
</span><span id="Rasco.fit-938"><a href="#Rasco.fit-938"><span class="linenos">938</span></a>            <span class="n">cfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="Rasco.fit-939"><a href="#Rasco.fit-939"><span class="linenos">939</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco.fit-940"><a href="#Rasco.fit-940"><span class="linenos">940</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="Rasco.fit-941"><a href="#Rasco.fit-941"><span class="linenos">941</span></a>            <span class="p">)</span>
</span><span id="Rasco.fit-942"><a href="#Rasco.fit-942"><span class="linenos">942</span></a>
</span><span id="Rasco.fit-943"><a href="#Rasco.fit-943"><span class="linenos">943</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Rasco.fit-944"><a href="#Rasco.fit-944"><span class="linenos">944</span></a>
</span><span id="Rasco.fit-945"><a href="#Rasco.fit-945"><span class="linenos">945</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">cfs</span>
</span><span id="Rasco.fit-946"><a href="#Rasco.fit-946"><span class="linenos">946</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="n">idxs</span>
</span><span id="Rasco.fit-947"><a href="#Rasco.fit-947"><span class="linenos">947</span></a>
</span><span id="Rasco.fit-948"><a href="#Rasco.fit-948"><span class="linenos">948</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a Rasco classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (Rasco):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="Rasco.predict_proba" class="function">predict_proba</dd>
                <dd id="Rasco.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="Rasco.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="Rasco.get_params" class="function">get_params</dd>
                <dd id="Rasco.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="RelRasco">
                            <input id="RelRasco-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RelRasco</span><wbr>(<span class="base"><a href="#Rasco">sslearn.wrapper.Rasco</a></span>):

                <label class="view-source-button" for="RelRasco-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelRasco"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelRasco-951"><a href="#RelRasco-951"><span class="linenos"> 951</span></a><span class="k">class</span> <span class="nc">RelRasco</span><span class="p">(</span><span class="n">Rasco</span><span class="p">):</span>
</span><span id="RelRasco-952"><a href="#RelRasco-952"><span class="linenos"> 952</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RelRasco-953"><a href="#RelRasco-953"><span class="linenos"> 953</span></a><span class="sd">    **Co-Training based on relevant random subspaces**</span>
</span><span id="RelRasco-954"><a href="#RelRasco-954"><span class="linenos"> 954</span></a><span class="sd">    --------------------------------------------</span>
</span><span id="RelRasco-955"><a href="#RelRasco-955"><span class="linenos"> 955</span></a>
</span><span id="RelRasco-956"><a href="#RelRasco-956"><span class="linenos"> 956</span></a><span class="sd">    Is a variation of `sslearn.wrapper.Rasco` that uses the mutual information of each feature to select the random subspaces.</span>
</span><span id="RelRasco-957"><a href="#RelRasco-957"><span class="linenos"> 957</span></a><span class="sd">    The process of training is the same as Rasco.</span>
</span><span id="RelRasco-958"><a href="#RelRasco-958"><span class="linenos"> 958</span></a>
</span><span id="RelRasco-959"><a href="#RelRasco-959"><span class="linenos"> 959</span></a><span class="sd">    **Methods**</span>
</span><span id="RelRasco-960"><a href="#RelRasco-960"><span class="linenos"> 960</span></a><span class="sd">    -------</span>
</span><span id="RelRasco-961"><a href="#RelRasco-961"><span class="linenos"> 961</span></a><span class="sd">    - `fit`: Fit the model with the labeled instances.</span>
</span><span id="RelRasco-962"><a href="#RelRasco-962"><span class="linenos"> 962</span></a><span class="sd">    - `predict` : Predict the class for each instance.</span>
</span><span id="RelRasco-963"><a href="#RelRasco-963"><span class="linenos"> 963</span></a><span class="sd">    - `predict_proba`: Predict the probability for each class.</span>
</span><span id="RelRasco-964"><a href="#RelRasco-964"><span class="linenos"> 964</span></a><span class="sd">    - `score`: Return the mean accuracy on the given test data and labels.</span>
</span><span id="RelRasco-965"><a href="#RelRasco-965"><span class="linenos"> 965</span></a>
</span><span id="RelRasco-966"><a href="#RelRasco-966"><span class="linenos"> 966</span></a><span class="sd">    **Example**</span>
</span><span id="RelRasco-967"><a href="#RelRasco-967"><span class="linenos"> 967</span></a><span class="sd">    -------</span>
</span><span id="RelRasco-968"><a href="#RelRasco-968"><span class="linenos"> 968</span></a><span class="sd">    ```python</span>
</span><span id="RelRasco-969"><a href="#RelRasco-969"><span class="linenos"> 969</span></a><span class="sd">    from sklearn.datasets import load_iris</span>
</span><span id="RelRasco-970"><a href="#RelRasco-970"><span class="linenos"> 970</span></a><span class="sd">    from sslearn.wrapper import RelRasco</span>
</span><span id="RelRasco-971"><a href="#RelRasco-971"><span class="linenos"> 971</span></a><span class="sd">    from sslearn.model_selection import artificial_ssl_dataset</span>
</span><span id="RelRasco-972"><a href="#RelRasco-972"><span class="linenos"> 972</span></a>
</span><span id="RelRasco-973"><a href="#RelRasco-973"><span class="linenos"> 973</span></a><span class="sd">    X, y = load_iris(return_X_y=True)</span>
</span><span id="RelRasco-974"><a href="#RelRasco-974"><span class="linenos"> 974</span></a><span class="sd">    X, y, X_unlabel, y_unlabel, _, _ = artificial_ssl_dataset(X, y, label_rate=0.1, random_state=0)</span>
</span><span id="RelRasco-975"><a href="#RelRasco-975"><span class="linenos"> 975</span></a><span class="sd">    relrasco = RelRasco()</span>
</span><span id="RelRasco-976"><a href="#RelRasco-976"><span class="linenos"> 976</span></a><span class="sd">    relrasco.fit(X, y)</span>
</span><span id="RelRasco-977"><a href="#RelRasco-977"><span class="linenos"> 977</span></a><span class="sd">    relrasco.score(X_unlabel, y_unlabel)</span>
</span><span id="RelRasco-978"><a href="#RelRasco-978"><span class="linenos"> 978</span></a><span class="sd">    ```</span>
</span><span id="RelRasco-979"><a href="#RelRasco-979"><span class="linenos"> 979</span></a>
</span><span id="RelRasco-980"><a href="#RelRasco-980"><span class="linenos"> 980</span></a><span class="sd">    **References**</span>
</span><span id="RelRasco-981"><a href="#RelRasco-981"><span class="linenos"> 981</span></a><span class="sd">    ----------</span>
</span><span id="RelRasco-982"><a href="#RelRasco-982"><span class="linenos"> 982</span></a><span class="sd">    Yaslan, Y., &amp; Cataltepe, Z. (2010).&lt;br&gt;</span>
</span><span id="RelRasco-983"><a href="#RelRasco-983"><span class="linenos"> 983</span></a><span class="sd">    Co-training with relevant random subspaces.&lt;br&gt;</span>
</span><span id="RelRasco-984"><a href="#RelRasco-984"><span class="linenos"> 984</span></a><span class="sd">    &lt;i&gt;Neurocomputing&lt;/i&gt;, 73(10-12), 1652-1661.&lt;br&gt;</span>
</span><span id="RelRasco-985"><a href="#RelRasco-985"><span class="linenos"> 985</span></a><span class="sd">    [10.1016/j.neucom.2010.01.018](https://doi.org/10.1016/j.neucom.2010.01.018)</span>
</span><span id="RelRasco-986"><a href="#RelRasco-986"><span class="linenos"> 986</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RelRasco-987"><a href="#RelRasco-987"><span class="linenos"> 987</span></a>
</span><span id="RelRasco-988"><a href="#RelRasco-988"><span class="linenos"> 988</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RelRasco-989"><a href="#RelRasco-989"><span class="linenos"> 989</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RelRasco-990"><a href="#RelRasco-990"><span class="linenos"> 990</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="RelRasco-991"><a href="#RelRasco-991"><span class="linenos"> 991</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="RelRasco-992"><a href="#RelRasco-992"><span class="linenos"> 992</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="RelRasco-993"><a href="#RelRasco-993"><span class="linenos"> 993</span></a>        <span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco-994"><a href="#RelRasco-994"><span class="linenos"> 994</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco-995"><a href="#RelRasco-995"><span class="linenos"> 995</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco-996"><a href="#RelRasco-996"><span class="linenos"> 996</span></a>    <span class="p">):</span>
</span><span id="RelRasco-997"><a href="#RelRasco-997"><span class="linenos"> 997</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RelRasco-998"><a href="#RelRasco-998"><span class="linenos"> 998</span></a><span class="sd">        Co-Training with relevant random subspaces</span>
</span><span id="RelRasco-999"><a href="#RelRasco-999"><span class="linenos"> 999</span></a>
</span><span id="RelRasco-1000"><a href="#RelRasco-1000"><span class="linenos">1000</span></a><span class="sd">        Parameters</span>
</span><span id="RelRasco-1001"><a href="#RelRasco-1001"><span class="linenos">1001</span></a><span class="sd">        ----------</span>
</span><span id="RelRasco-1002"><a href="#RelRasco-1002"><span class="linenos">1002</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="RelRasco-1003"><a href="#RelRasco-1003"><span class="linenos">1003</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="RelRasco-1004"><a href="#RelRasco-1004"><span class="linenos">1004</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="RelRasco-1005"><a href="#RelRasco-1005"><span class="linenos">1005</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0.</span>
</span><span id="RelRasco-1006"><a href="#RelRasco-1006"><span class="linenos">1006</span></a><span class="sd">            If is -1 then will be infinite iterations until U be empty, by default 10</span>
</span><span id="RelRasco-1007"><a href="#RelRasco-1007"><span class="linenos">1007</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="RelRasco-1008"><a href="#RelRasco-1008"><span class="linenos">1008</span></a><span class="sd">            The number of base estimators in the ensemble., by default 30</span>
</span><span id="RelRasco-1009"><a href="#RelRasco-1009"><span class="linenos">1009</span></a><span class="sd">        subspace_size : int, optional</span>
</span><span id="RelRasco-1010"><a href="#RelRasco-1010"><span class="linenos">1010</span></a><span class="sd">            The number of features for each subspace. If it is None will be the half of the features size., by default None</span>
</span><span id="RelRasco-1011"><a href="#RelRasco-1011"><span class="linenos">1011</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="RelRasco-1012"><a href="#RelRasco-1012"><span class="linenos">1012</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="RelRasco-1013"><a href="#RelRasco-1013"><span class="linenos">1013</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="RelRasco-1014"><a href="#RelRasco-1014"><span class="linenos">1014</span></a><span class="sd">            The number of jobs to run in parallel. -1 means using all processors., by default None</span>
</span><span id="RelRasco-1015"><a href="#RelRasco-1015"><span class="linenos">1015</span></a>
</span><span id="RelRasco-1016"><a href="#RelRasco-1016"><span class="linenos">1016</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RelRasco-1017"><a href="#RelRasco-1017"><span class="linenos">1017</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="RelRasco-1018"><a href="#RelRasco-1018"><span class="linenos">1018</span></a>            <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="RelRasco-1019"><a href="#RelRasco-1019"><span class="linenos">1019</span></a>            <span class="n">max_iterations</span><span class="p">,</span>
</span><span id="RelRasco-1020"><a href="#RelRasco-1020"><span class="linenos">1020</span></a>            <span class="n">n_estimators</span><span class="p">,</span>
</span><span id="RelRasco-1021"><a href="#RelRasco-1021"><span class="linenos">1021</span></a>            <span class="n">subspace_size</span><span class="p">,</span>
</span><span id="RelRasco-1022"><a href="#RelRasco-1022"><span class="linenos">1022</span></a>            <span class="n">random_state</span><span class="p">,</span>
</span><span id="RelRasco-1023"><a href="#RelRasco-1023"><span class="linenos">1023</span></a>            <span class="n">n_jobs</span><span class="p">,</span>
</span><span id="RelRasco-1024"><a href="#RelRasco-1024"><span class="linenos">1024</span></a>        <span class="p">)</span>
</span><span id="RelRasco-1025"><a href="#RelRasco-1025"><span class="linenos">1025</span></a>
</span><span id="RelRasco-1026"><a href="#RelRasco-1026"><span class="linenos">1026</span></a>    <span class="k">def</span> <span class="nf">_generate_random_subspaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RelRasco-1027"><a href="#RelRasco-1027"><span class="linenos">1027</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate the relevant random subspcaes</span>
</span><span id="RelRasco-1028"><a href="#RelRasco-1028"><span class="linenos">1028</span></a>
</span><span id="RelRasco-1029"><a href="#RelRasco-1029"><span class="linenos">1029</span></a><span class="sd">        Parameters</span>
</span><span id="RelRasco-1030"><a href="#RelRasco-1030"><span class="linenos">1030</span></a><span class="sd">        ----------</span>
</span><span id="RelRasco-1031"><a href="#RelRasco-1031"><span class="linenos">1031</span></a><span class="sd">        X : array like</span>
</span><span id="RelRasco-1032"><a href="#RelRasco-1032"><span class="linenos">1032</span></a><span class="sd">            Labeled dataset</span>
</span><span id="RelRasco-1033"><a href="#RelRasco-1033"><span class="linenos">1033</span></a><span class="sd">        y : array like, optional</span>
</span><span id="RelRasco-1034"><a href="#RelRasco-1034"><span class="linenos">1034</span></a><span class="sd">            Target for each X, only needed on Rel-Rasco, by default None</span>
</span><span id="RelRasco-1035"><a href="#RelRasco-1035"><span class="linenos">1035</span></a>
</span><span id="RelRasco-1036"><a href="#RelRasco-1036"><span class="linenos">1036</span></a><span class="sd">        Returns</span>
</span><span id="RelRasco-1037"><a href="#RelRasco-1037"><span class="linenos">1037</span></a><span class="sd">        -------</span>
</span><span id="RelRasco-1038"><a href="#RelRasco-1038"><span class="linenos">1038</span></a><span class="sd">        subspaces: list</span>
</span><span id="RelRasco-1039"><a href="#RelRasco-1039"><span class="linenos">1039</span></a><span class="sd">            List of index of features</span>
</span><span id="RelRasco-1040"><a href="#RelRasco-1040"><span class="linenos">1040</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RelRasco-1041"><a href="#RelRasco-1041"><span class="linenos">1041</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="RelRasco-1042"><a href="#RelRasco-1042"><span class="linenos">1042</span></a>        <span class="n">relevance</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="RelRasco-1043"><a href="#RelRasco-1043"><span class="linenos">1043</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RelRasco-1044"><a href="#RelRasco-1044"><span class="linenos">1044</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="RelRasco-1045"><a href="#RelRasco-1045"><span class="linenos">1045</span></a>            <span class="n">subspace</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RelRasco-1046"><a href="#RelRasco-1046"><span class="linenos">1046</span></a>            <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span><span class="p">):</span>
</span><span id="RelRasco-1047"><a href="#RelRasco-1047"><span class="linenos">1047</span></a>                <span class="n">f1</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="RelRasco-1048"><a href="#RelRasco-1048"><span class="linenos">1048</span></a>                <span class="n">f2</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="RelRasco-1049"><a href="#RelRasco-1049"><span class="linenos">1049</span></a>                <span class="k">if</span> <span class="n">relevance</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">relevance</span><span class="p">[</span><span class="n">f2</span><span class="p">]:</span>
</span><span id="RelRasco-1050"><a href="#RelRasco-1050"><span class="linenos">1050</span></a>                    <span class="n">subspace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="RelRasco-1051"><a href="#RelRasco-1051"><span class="linenos">1051</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="RelRasco-1052"><a href="#RelRasco-1052"><span class="linenos">1052</span></a>                    <span class="n">subspace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
</span><span id="RelRasco-1053"><a href="#RelRasco-1053"><span class="linenos">1053</span></a>            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subspace</span><span class="p">)</span>
</span><span id="RelRasco-1054"><a href="#RelRasco-1054"><span class="linenos">1054</span></a>        <span class="k">return</span> <span class="n">idxs</span>
</span></pre></div>


            <div class="docstring"><h2 id="co-training-based-on-relevant-random-subspaces"><strong>Co-Training based on relevant random subspaces</strong></h2>

<p>Is a variation of <code><a href="#Rasco">sslearn.wrapper.Rasco</a></code> that uses the mutual information of each feature to select the random subspaces.
The process of training is the same as Rasco.</p>

<h2 id="methods"><strong>Methods</strong></h2>

<ul>
<li><code><a href="#RelRasco.fit">fit</a></code>: Fit the model with the labeled instances.</li>
<li><code><a href="#RelRasco.predict">predict</a></code> : Predict the class for each instance.</li>
<li><code><a href="#RelRasco.predict_proba">predict_proba</a></code>: Predict the probability for each class.</li>
<li><code><a href="#RelRasco.score">score</a></code>: Return the mean accuracy on the given test data and labels.</li>
</ul>

<h2 id="example"><strong>Example</strong></h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn"><a href="">sslearn.wrapper</a></span> <span class="kn">import</span> <span class="n">RelRasco</span>
<span class="kn">from</span> <span class="nn"><a href="model_selection.html">sslearn.model_selection</a></span> <span class="kn">import</span> <span class="n">artificial_ssl_dataset</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">artificial_ssl_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">relrasco</span> <span class="o">=</span> <span class="n">RelRasco</span><span class="p">()</span>
<span class="n">relrasco</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">relrasco</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="references"><strong>References</strong></h2>

<p>Yaslan, Y., &amp; Cataltepe, Z. (2010).<br>
Co-training with relevant random subspaces.<br>
<i>Neurocomputing</i>, 73(10-12), 1652-1661.<br>
<a href="https://doi.org/10.1016/j.neucom.2010.01.018">10.1016/j.neucom.2010.01.018</a></p>
</div>


                            <div id="RelRasco.__init__" class="classattr">
                                        <input id="RelRasco.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">RelRasco</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span>,</span><span class="param">	<span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="RelRasco.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelRasco.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelRasco.__init__-988"><a href="#RelRasco.__init__-988"><span class="linenos"> 988</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RelRasco.__init__-989"><a href="#RelRasco.__init__-989"><span class="linenos"> 989</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RelRasco.__init__-990"><a href="#RelRasco.__init__-990"><span class="linenos"> 990</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="RelRasco.__init__-991"><a href="#RelRasco.__init__-991"><span class="linenos"> 991</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="RelRasco.__init__-992"><a href="#RelRasco.__init__-992"><span class="linenos"> 992</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="RelRasco.__init__-993"><a href="#RelRasco.__init__-993"><span class="linenos"> 993</span></a>        <span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco.__init__-994"><a href="#RelRasco.__init__-994"><span class="linenos"> 994</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco.__init__-995"><a href="#RelRasco.__init__-995"><span class="linenos"> 995</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco.__init__-996"><a href="#RelRasco.__init__-996"><span class="linenos"> 996</span></a>    <span class="p">):</span>
</span><span id="RelRasco.__init__-997"><a href="#RelRasco.__init__-997"><span class="linenos"> 997</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RelRasco.__init__-998"><a href="#RelRasco.__init__-998"><span class="linenos"> 998</span></a><span class="sd">        Co-Training with relevant random subspaces</span>
</span><span id="RelRasco.__init__-999"><a href="#RelRasco.__init__-999"><span class="linenos"> 999</span></a>
</span><span id="RelRasco.__init__-1000"><a href="#RelRasco.__init__-1000"><span class="linenos">1000</span></a><span class="sd">        Parameters</span>
</span><span id="RelRasco.__init__-1001"><a href="#RelRasco.__init__-1001"><span class="linenos">1001</span></a><span class="sd">        ----------</span>
</span><span id="RelRasco.__init__-1002"><a href="#RelRasco.__init__-1002"><span class="linenos">1002</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="RelRasco.__init__-1003"><a href="#RelRasco.__init__-1003"><span class="linenos">1003</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="RelRasco.__init__-1004"><a href="#RelRasco.__init__-1004"><span class="linenos">1004</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="RelRasco.__init__-1005"><a href="#RelRasco.__init__-1005"><span class="linenos">1005</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0.</span>
</span><span id="RelRasco.__init__-1006"><a href="#RelRasco.__init__-1006"><span class="linenos">1006</span></a><span class="sd">            If is -1 then will be infinite iterations until U be empty, by default 10</span>
</span><span id="RelRasco.__init__-1007"><a href="#RelRasco.__init__-1007"><span class="linenos">1007</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="RelRasco.__init__-1008"><a href="#RelRasco.__init__-1008"><span class="linenos">1008</span></a><span class="sd">            The number of base estimators in the ensemble., by default 30</span>
</span><span id="RelRasco.__init__-1009"><a href="#RelRasco.__init__-1009"><span class="linenos">1009</span></a><span class="sd">        subspace_size : int, optional</span>
</span><span id="RelRasco.__init__-1010"><a href="#RelRasco.__init__-1010"><span class="linenos">1010</span></a><span class="sd">            The number of features for each subspace. If it is None will be the half of the features size., by default None</span>
</span><span id="RelRasco.__init__-1011"><a href="#RelRasco.__init__-1011"><span class="linenos">1011</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="RelRasco.__init__-1012"><a href="#RelRasco.__init__-1012"><span class="linenos">1012</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="RelRasco.__init__-1013"><a href="#RelRasco.__init__-1013"><span class="linenos">1013</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="RelRasco.__init__-1014"><a href="#RelRasco.__init__-1014"><span class="linenos">1014</span></a><span class="sd">            The number of jobs to run in parallel. -1 means using all processors., by default None</span>
</span><span id="RelRasco.__init__-1015"><a href="#RelRasco.__init__-1015"><span class="linenos">1015</span></a>
</span><span id="RelRasco.__init__-1016"><a href="#RelRasco.__init__-1016"><span class="linenos">1016</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RelRasco.__init__-1017"><a href="#RelRasco.__init__-1017"><span class="linenos">1017</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="RelRasco.__init__-1018"><a href="#RelRasco.__init__-1018"><span class="linenos">1018</span></a>            <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="RelRasco.__init__-1019"><a href="#RelRasco.__init__-1019"><span class="linenos">1019</span></a>            <span class="n">max_iterations</span><span class="p">,</span>
</span><span id="RelRasco.__init__-1020"><a href="#RelRasco.__init__-1020"><span class="linenos">1020</span></a>            <span class="n">n_estimators</span><span class="p">,</span>
</span><span id="RelRasco.__init__-1021"><a href="#RelRasco.__init__-1021"><span class="linenos">1021</span></a>            <span class="n">subspace_size</span><span class="p">,</span>
</span><span id="RelRasco.__init__-1022"><a href="#RelRasco.__init__-1022"><span class="linenos">1022</span></a>            <span class="n">random_state</span><span class="p">,</span>
</span><span id="RelRasco.__init__-1023"><a href="#RelRasco.__init__-1023"><span class="linenos">1023</span></a>            <span class="n">n_jobs</span><span class="p">,</span>
</span><span id="RelRasco.__init__-1024"><a href="#RelRasco.__init__-1024"><span class="linenos">1024</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Co-Training with relevant random subspaces</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>max_iterations</strong> (int, optional):
Maximum number of iterations allowed. Should be greater than or equal to 0.
If is -1 then will be infinite iterations until U be empty, by default 10</li>
<li><strong>n_estimators</strong> (int, optional):
The number of base estimators in the ensemble., by default 30</li>
<li><strong>subspace_size</strong> (int, optional):
The number of features for each subspace. If it is None will be the half of the features size., by default None</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
<li><strong>n_jobs</strong> (int, optional):
The number of jobs to run in parallel. -1 means using all processors., by default None</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Rasco">Rasco</a></dt>
                                <dd id="RelRasco.fit" class="function"><a href="#Rasco.fit">fit</a></dd>

            </div>
            <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="RelRasco.predict_proba" class="function">predict_proba</dd>
                <dd id="RelRasco.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="RelRasco.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="RelRasco.get_params" class="function">get_params</dd>
                <dd id="RelRasco.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CoForest">
                            <input id="CoForest-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CoForest</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="CoForest-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoForest"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoForest-1280"><a href="#CoForest-1280"><span class="linenos">1280</span></a><span class="k">class</span> <span class="nc">CoForest</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="CoForest-1281"><a href="#CoForest-1281"><span class="linenos">1281</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoForest-1282"><a href="#CoForest-1282"><span class="linenos">1282</span></a><span class="sd">    **CoForest classifier. Random Forest co-training**</span>
</span><span id="CoForest-1283"><a href="#CoForest-1283"><span class="linenos">1283</span></a><span class="sd">    ----------------------------</span>
</span><span id="CoForest-1284"><a href="#CoForest-1284"><span class="linenos">1284</span></a><span class="sd">    </span>
</span><span id="CoForest-1285"><a href="#CoForest-1285"><span class="linenos">1285</span></a><span class="sd">    Ensemble method for CoTraining based on Random Forest.</span>
</span><span id="CoForest-1286"><a href="#CoForest-1286"><span class="linenos">1286</span></a>
</span><span id="CoForest-1287"><a href="#CoForest-1287"><span class="linenos">1287</span></a><span class="sd">    The main process is:</span>
</span><span id="CoForest-1288"><a href="#CoForest-1288"><span class="linenos">1288</span></a><span class="sd">    1. Train a committee of classifiers using bootstrap.</span>
</span><span id="CoForest-1289"><a href="#CoForest-1289"><span class="linenos">1289</span></a><span class="sd">    2. While any base classifier is retrained:</span>
</span><span id="CoForest-1290"><a href="#CoForest-1290"><span class="linenos">1290</span></a><span class="sd">        1. Predict the instances from the unlabeled set.</span>
</span><span id="CoForest-1291"><a href="#CoForest-1291"><span class="linenos">1291</span></a><span class="sd">        2. Select the instances with the highest probability.</span>
</span><span id="CoForest-1292"><a href="#CoForest-1292"><span class="linenos">1292</span></a><span class="sd">        3. Label the instances with the highest probability</span>
</span><span id="CoForest-1293"><a href="#CoForest-1293"><span class="linenos">1293</span></a><span class="sd">        4. Add the instances to the labeled set only if the error is not bigger than the previous error.</span>
</span><span id="CoForest-1294"><a href="#CoForest-1294"><span class="linenos">1294</span></a><span class="sd">        5. Retrain the classifier with the new instances.</span>
</span><span id="CoForest-1295"><a href="#CoForest-1295"><span class="linenos">1295</span></a><span class="sd">    3. Combine the probabilities of each classifier.</span>
</span><span id="CoForest-1296"><a href="#CoForest-1296"><span class="linenos">1296</span></a>
</span><span id="CoForest-1297"><a href="#CoForest-1297"><span class="linenos">1297</span></a>
</span><span id="CoForest-1298"><a href="#CoForest-1298"><span class="linenos">1298</span></a><span class="sd">    **Methods**</span>
</span><span id="CoForest-1299"><a href="#CoForest-1299"><span class="linenos">1299</span></a><span class="sd">    -------</span>
</span><span id="CoForest-1300"><a href="#CoForest-1300"><span class="linenos">1300</span></a><span class="sd">    - `fit`: Fit the model with the labeled instances.</span>
</span><span id="CoForest-1301"><a href="#CoForest-1301"><span class="linenos">1301</span></a><span class="sd">    - `predict` : Predict the class for each instance.</span>
</span><span id="CoForest-1302"><a href="#CoForest-1302"><span class="linenos">1302</span></a><span class="sd">    - `predict_proba`: Predict the probability for each class.</span>
</span><span id="CoForest-1303"><a href="#CoForest-1303"><span class="linenos">1303</span></a><span class="sd">    - `score`: Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoForest-1304"><a href="#CoForest-1304"><span class="linenos">1304</span></a>
</span><span id="CoForest-1305"><a href="#CoForest-1305"><span class="linenos">1305</span></a><span class="sd">    **Example**</span>
</span><span id="CoForest-1306"><a href="#CoForest-1306"><span class="linenos">1306</span></a><span class="sd">    -------</span>
</span><span id="CoForest-1307"><a href="#CoForest-1307"><span class="linenos">1307</span></a><span class="sd">    ```python</span>
</span><span id="CoForest-1308"><a href="#CoForest-1308"><span class="linenos">1308</span></a><span class="sd">    from sklearn.datasets import load_iris</span>
</span><span id="CoForest-1309"><a href="#CoForest-1309"><span class="linenos">1309</span></a><span class="sd">    from sslearn.wrapper import CoForest</span>
</span><span id="CoForest-1310"><a href="#CoForest-1310"><span class="linenos">1310</span></a><span class="sd">    from sslearn.model_selection import artificial_ssl_dataset</span>
</span><span id="CoForest-1311"><a href="#CoForest-1311"><span class="linenos">1311</span></a>
</span><span id="CoForest-1312"><a href="#CoForest-1312"><span class="linenos">1312</span></a><span class="sd">    X, y = load_iris(return_X_y=True)</span>
</span><span id="CoForest-1313"><a href="#CoForest-1313"><span class="linenos">1313</span></a><span class="sd">    X, y, X_unlabel, y_unlabel, _, _ = artificial_ssl_dataset(X, y, label_rate=0.1, random_state=0)</span>
</span><span id="CoForest-1314"><a href="#CoForest-1314"><span class="linenos">1314</span></a><span class="sd">    coforest = CoForest()</span>
</span><span id="CoForest-1315"><a href="#CoForest-1315"><span class="linenos">1315</span></a><span class="sd">    coforest.fit(X, y)</span>
</span><span id="CoForest-1316"><a href="#CoForest-1316"><span class="linenos">1316</span></a><span class="sd">    coforest.score(X_unlabel, y_unlabel)</span>
</span><span id="CoForest-1317"><a href="#CoForest-1317"><span class="linenos">1317</span></a><span class="sd">    ```</span>
</span><span id="CoForest-1318"><a href="#CoForest-1318"><span class="linenos">1318</span></a>
</span><span id="CoForest-1319"><a href="#CoForest-1319"><span class="linenos">1319</span></a><span class="sd">    **References**</span>
</span><span id="CoForest-1320"><a href="#CoForest-1320"><span class="linenos">1320</span></a><span class="sd">    ----------</span>
</span><span id="CoForest-1321"><a href="#CoForest-1321"><span class="linenos">1321</span></a><span class="sd">    Li, M., &amp; Zhou, Z.-H. (2007).&lt;br&gt;</span>
</span><span id="CoForest-1322"><a href="#CoForest-1322"><span class="linenos">1322</span></a><span class="sd">    Improve Computer-Aided Diagnosis With Machine Learning Techniques Using Undiagnosed Samples.&lt;br&gt;</span>
</span><span id="CoForest-1323"><a href="#CoForest-1323"><span class="linenos">1323</span></a><span class="sd">    &lt;i&gt;IEEE Transactions on Systems, Man, and Cybernetics - Part A: Systems and Humans&lt;/i&gt;,&lt;br&gt;</span>
</span><span id="CoForest-1324"><a href="#CoForest-1324"><span class="linenos">1324</span></a><span class="sd">    37(6), 1088-1098. [10.1109/tsmca.2007.904745](https://doi.org/10.1109/tsmca.2007.904745)</span>
</span><span id="CoForest-1325"><a href="#CoForest-1325"><span class="linenos">1325</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CoForest-1326"><a href="#CoForest-1326"><span class="linenos">1326</span></a>
</span><span id="CoForest-1327"><a href="#CoForest-1327"><span class="linenos">1327</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.3&quot;</span><span class="p">):</span>
</span><span id="CoForest-1328"><a href="#CoForest-1328"><span class="linenos">1328</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoForest-1329"><a href="#CoForest-1329"><span class="linenos">1329</span></a><span class="sd">        Generate a CoForest classifier.</span>
</span><span id="CoForest-1330"><a href="#CoForest-1330"><span class="linenos">1330</span></a><span class="sd">        A SSL Random Forest adaption for CoTraining. </span>
</span><span id="CoForest-1331"><a href="#CoForest-1331"><span class="linenos">1331</span></a>
</span><span id="CoForest-1332"><a href="#CoForest-1332"><span class="linenos">1332</span></a><span class="sd">        Parameters</span>
</span><span id="CoForest-1333"><a href="#CoForest-1333"><span class="linenos">1333</span></a><span class="sd">        ----------</span>
</span><span id="CoForest-1334"><a href="#CoForest-1334"><span class="linenos">1334</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="CoForest-1335"><a href="#CoForest-1335"><span class="linenos">1335</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="CoForest-1336"><a href="#CoForest-1336"><span class="linenos">1336</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="CoForest-1337"><a href="#CoForest-1337"><span class="linenos">1337</span></a><span class="sd">            The number of base estimators in the ensemble., by default 7</span>
</span><span id="CoForest-1338"><a href="#CoForest-1338"><span class="linenos">1338</span></a><span class="sd">        threshold : float, optional</span>
</span><span id="CoForest-1339"><a href="#CoForest-1339"><span class="linenos">1339</span></a><span class="sd">            The decision threshold. Should be in [0, 1)., by default 0.5</span>
</span><span id="CoForest-1340"><a href="#CoForest-1340"><span class="linenos">1340</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="CoForest-1341"><a href="#CoForest-1341"><span class="linenos">1341</span></a><span class="sd">            The number of jobs to run in parallel for both fit and predict., by default None</span>
</span><span id="CoForest-1342"><a href="#CoForest-1342"><span class="linenos">1342</span></a><span class="sd">        bootstrap : bool, optional</span>
</span><span id="CoForest-1343"><a href="#CoForest-1343"><span class="linenos">1343</span></a><span class="sd">            Whether bootstrap samples are used when building estimators., by default True</span>
</span><span id="CoForest-1344"><a href="#CoForest-1344"><span class="linenos">1344</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoForest-1345"><a href="#CoForest-1345"><span class="linenos">1345</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoForest-1346"><a href="#CoForest-1346"><span class="linenos">1346</span></a><span class="sd">        **kwards : dict, optional</span>
</span><span id="CoForest-1347"><a href="#CoForest-1347"><span class="linenos">1347</span></a><span class="sd">            Additional parameters to be passed to base_estimator, by default None.</span>
</span><span id="CoForest-1348"><a href="#CoForest-1348"><span class="linenos">1348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoForest-1349"><a href="#CoForest-1349"><span class="linenos">1349</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">collection_size</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="CoForest-1350"><a href="#CoForest-1350"><span class="linenos">1350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>
</span><span id="CoForest-1351"><a href="#CoForest-1351"><span class="linenos">1351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="CoForest-1352"><a href="#CoForest-1352"><span class="linenos">1352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap</span> <span class="o">=</span> <span class="n">bootstrap</span>
</span><span id="CoForest-1353"><a href="#CoForest-1353"><span class="linenos">1353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
</span><span id="CoForest-1354"><a href="#CoForest-1354"><span class="linenos">1354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="CoForest-1355"><a href="#CoForest-1355"><span class="linenos">1355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoForest-1356"><a href="#CoForest-1356"><span class="linenos">1356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
</span><span id="CoForest-1357"><a href="#CoForest-1357"><span class="linenos">1357</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.2&quot;</span><span class="p">:</span>
</span><span id="CoForest-1358"><a href="#CoForest-1358"><span class="linenos">1358</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The version 1.0.2 is deprecated. Please use the version 1.0.3&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
</span><span id="CoForest-1359"><a href="#CoForest-1359"><span class="linenos">1359</span></a>
</span><span id="CoForest-1360"><a href="#CoForest-1360"><span class="linenos">1360</span></a>    <span class="k">def</span> <span class="nf">__bootstraping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r_state</span><span class="p">):</span>
</span><span id="CoForest-1361"><a href="#CoForest-1361"><span class="linenos">1361</span></a>        <span class="c1"># It is necessary to bootstrap the data</span>
</span><span id="CoForest-1362"><a href="#CoForest-1362"><span class="linenos">1362</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.3&quot;</span><span class="p">:</span>
</span><span id="CoForest-1363"><a href="#CoForest-1363"><span class="linenos">1363</span></a>            <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoForest-1364"><a href="#CoForest-1364"><span class="linenos">1364</span></a>            <span class="n">columns</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CoForest-1365"><a href="#CoForest-1365"><span class="linenos">1365</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest-1366"><a href="#CoForest-1366"><span class="linenos">1366</span></a>                <span class="n">columns</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
</span><span id="CoForest-1367"><a href="#CoForest-1367"><span class="linenos">1367</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="CoForest-1368"><a href="#CoForest-1368"><span class="linenos">1368</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoForest-1369"><a href="#CoForest-1369"><span class="linenos">1369</span></a>            <span class="c1"># Get a reprentation of each class</span>
</span><span id="CoForest-1370"><a href="#CoForest-1370"><span class="linenos">1370</span></a>            <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="CoForest-1371"><a href="#CoForest-1371"><span class="linenos">1371</span></a>            <span class="c1"># Choose at least one sample from each class</span>
</span><span id="CoForest-1372"><a href="#CoForest-1372"><span class="linenos">1372</span></a>            <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="CoForest-1373"><a href="#CoForest-1373"><span class="linenos">1373</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="CoForest-1374"><a href="#CoForest-1374"><span class="linenos">1374</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">c</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CoForest-1375"><a href="#CoForest-1375"><span class="linenos">1375</span></a>                <span class="c1"># Choose one sample from each class</span>
</span><span id="CoForest-1376"><a href="#CoForest-1376"><span class="linenos">1376</span></a>                <span class="n">X_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:])</span>
</span><span id="CoForest-1377"><a href="#CoForest-1377"><span class="linenos">1377</span></a>                <span class="n">y_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="CoForest-1378"><a href="#CoForest-1378"><span class="linenos">1378</span></a>                <span class="c1"># Remove the sample from the original data</span>
</span><span id="CoForest-1379"><a href="#CoForest-1379"><span class="linenos">1379</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1380"><a href="#CoForest-1380"><span class="linenos">1380</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1381"><a href="#CoForest-1381"><span class="linenos">1381</span></a>            <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">r_state</span><span class="p">)</span>
</span><span id="CoForest-1382"><a href="#CoForest-1382"><span class="linenos">1382</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_label</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1383"><a href="#CoForest-1383"><span class="linenos">1383</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_label</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1384"><a href="#CoForest-1384"><span class="linenos">1384</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest-1385"><a href="#CoForest-1385"><span class="linenos">1385</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</span><span id="CoForest-1386"><a href="#CoForest-1386"><span class="linenos">1386</span></a>        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</span><span id="CoForest-1387"><a href="#CoForest-1387"><span class="linenos">1387</span></a>
</span><span id="CoForest-1388"><a href="#CoForest-1388"><span class="linenos">1388</span></a>    <span class="k">def</span> <span class="nf">__estimate_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hypothesis</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="CoForest-1389"><a href="#CoForest-1389"><span class="linenos">1389</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.3&quot;</span><span class="p">:</span>
</span><span id="CoForest-1390"><a href="#CoForest-1390"><span class="linenos">1390</span></a>            <span class="n">concomitants</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">index</span><span class="p">]</span>
</span><span id="CoForest-1391"><a href="#CoForest-1391"><span class="linenos">1391</span></a>            <span class="n">predicted</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">concomitants</span><span class="p">]</span>
</span><span id="CoForest-1392"><a href="#CoForest-1392"><span class="linenos">1392</span></a>            <span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoForest-1393"><a href="#CoForest-1393"><span class="linenos">1393</span></a>            <span class="c1"># Get the majority vote</span>
</span><span id="CoForest-1394"><a href="#CoForest-1394"><span class="linenos">1394</span></a>            <span class="n">predicted</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mode</span><span class="p">(</span><span class="n">predicted</span><span class="p">)</span>
</span><span id="CoForest-1395"><a href="#CoForest-1395"><span class="linenos">1395</span></a>            <span class="c1"># predicted, _ = st.mode(predicted, axis=1)</span>
</span><span id="CoForest-1396"><a href="#CoForest-1396"><span class="linenos">1396</span></a>            <span class="c1"># Get the error rate</span>
</span><span id="CoForest-1397"><a href="#CoForest-1397"><span class="linenos">1397</span></a>            <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">predicted</span><span class="p">)</span>
</span><span id="CoForest-1398"><a href="#CoForest-1398"><span class="linenos">1398</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1399"><a href="#CoForest-1399"><span class="linenos">1399</span></a>            <span class="n">probas</span> <span class="o">=</span> <span class="n">hypothesis</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="CoForest-1400"><a href="#CoForest-1400"><span class="linenos">1400</span></a>            <span class="n">ei_t</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CoForest-1401"><a href="#CoForest-1401"><span class="linenos">1401</span></a>            <span class="n">classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hypothesis</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="CoForest-1402"><a href="#CoForest-1402"><span class="linenos">1402</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="CoForest-1403"><a href="#CoForest-1403"><span class="linenos">1403</span></a>                <span class="n">true_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="CoForest-1404"><a href="#CoForest-1404"><span class="linenos">1404</span></a>                <span class="n">true_y_index</span> <span class="o">=</span> <span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">true_y</span><span class="p">)</span>
</span><span id="CoForest-1405"><a href="#CoForest-1405"><span class="linenos">1405</span></a>                <span class="n">ei_t</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">probas</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">true_y_index</span><span class="p">]</span>
</span><span id="CoForest-1406"><a href="#CoForest-1406"><span class="linenos">1406</span></a>            <span class="k">if</span> <span class="n">ei_t</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoForest-1407"><a href="#CoForest-1407"><span class="linenos">1407</span></a>                <span class="n">ei_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span>
</span><span id="CoForest-1408"><a href="#CoForest-1408"><span class="linenos">1408</span></a>            <span class="k">return</span> <span class="n">ei_t</span>
</span><span id="CoForest-1409"><a href="#CoForest-1409"><span class="linenos">1409</span></a>
</span><span id="CoForest-1410"><a href="#CoForest-1410"><span class="linenos">1410</span></a>    <span class="k">def</span> <span class="nf">__confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h_index</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoForest-1411"><a href="#CoForest-1411"><span class="linenos">1411</span></a>        <span class="n">concomitants</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">h_index</span><span class="p">]</span>
</span><span id="CoForest-1412"><a href="#CoForest-1412"><span class="linenos">1412</span></a>
</span><span id="CoForest-1413"><a href="#CoForest-1413"><span class="linenos">1413</span></a>        <span class="n">predicted</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">concomitants</span><span class="p">]</span>
</span><span id="CoForest-1414"><a href="#CoForest-1414"><span class="linenos">1414</span></a>        <span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predicted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoForest-1415"><a href="#CoForest-1415"><span class="linenos">1415</span></a>        <span class="c1"># Get the majority vote and the number of votes</span>
</span><span id="CoForest-1416"><a href="#CoForest-1416"><span class="linenos">1416</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">mode</span><span class="p">(</span><span class="n">predicted</span><span class="p">)</span>
</span><span id="CoForest-1417"><a href="#CoForest-1417"><span class="linenos">1417</span></a>        <span class="c1"># _, counts = st.mode(predicted, axis=1)</span>
</span><span id="CoForest-1418"><a href="#CoForest-1418"><span class="linenos">1418</span></a>        <span class="n">confidences</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">concomitants</span><span class="p">)</span>
</span><span id="CoForest-1419"><a href="#CoForest-1419"><span class="linenos">1419</span></a>        <span class="k">return</span> <span class="n">confidences</span>
</span><span id="CoForest-1420"><a href="#CoForest-1420"><span class="linenos">1420</span></a>
</span><span id="CoForest-1421"><a href="#CoForest-1421"><span class="linenos">1421</span></a>    <span class="k">def</span> <span class="nf">_fit_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">beginning</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoForest-1422"><a href="#CoForest-1422"><span class="linenos">1422</span></a>        <span class="n">estimator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="CoForest-1423"><a href="#CoForest-1423"><span class="linenos">1423</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="CoForest-1424"><a href="#CoForest-1424"><span class="linenos">1424</span></a>            <span class="n">estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="CoForest-1425"><a href="#CoForest-1425"><span class="linenos">1425</span></a>
</span><span id="CoForest-1426"><a href="#CoForest-1426"><span class="linenos">1426</span></a>        <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">():</span>
</span><span id="CoForest-1427"><a href="#CoForest-1427"><span class="linenos">1427</span></a>            <span class="n">r_state</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="CoForest-1428"><a href="#CoForest-1428"><span class="linenos">1428</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1429"><a href="#CoForest-1429"><span class="linenos">1429</span></a>            <span class="n">r_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="CoForest-1430"><a href="#CoForest-1430"><span class="linenos">1430</span></a>            <span class="k">if</span> <span class="n">r_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoForest-1431"><a href="#CoForest-1431"><span class="linenos">1431</span></a>                <span class="n">r_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="CoForest-1432"><a href="#CoForest-1432"><span class="linenos">1432</span></a>            <span class="n">r_state</span> <span class="o">+=</span> <span class="n">i</span>
</span><span id="CoForest-1433"><a href="#CoForest-1433"><span class="linenos">1433</span></a>        <span class="c1"># Only in the beginning</span>
</span><span id="CoForest-1434"><a href="#CoForest-1434"><span class="linenos">1434</span></a>        <span class="k">if</span> <span class="n">beginning</span><span class="p">:</span>
</span><span id="CoForest-1435"><a href="#CoForest-1435"><span class="linenos">1435</span></a>            <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__bootstraping</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r_state</span><span class="p">)</span>
</span><span id="CoForest-1436"><a href="#CoForest-1436"><span class="linenos">1436</span></a>
</span><span id="CoForest-1437"><a href="#CoForest-1437"><span class="linenos">1437</span></a>        <span class="k">return</span> <span class="n">skclone</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoForest-1438"><a href="#CoForest-1438"><span class="linenos">1438</span></a>
</span><span id="CoForest-1439"><a href="#CoForest-1439"><span class="linenos">1439</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoForest-1440"><a href="#CoForest-1440"><span class="linenos">1440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a CoForest classifier from the training set (X, y).</span>
</span><span id="CoForest-1441"><a href="#CoForest-1441"><span class="linenos">1441</span></a>
</span><span id="CoForest-1442"><a href="#CoForest-1442"><span class="linenos">1442</span></a><span class="sd">        Parameters</span>
</span><span id="CoForest-1443"><a href="#CoForest-1443"><span class="linenos">1443</span></a><span class="sd">        ----------</span>
</span><span id="CoForest-1444"><a href="#CoForest-1444"><span class="linenos">1444</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoForest-1445"><a href="#CoForest-1445"><span class="linenos">1445</span></a><span class="sd">            The training input samples.</span>
</span><span id="CoForest-1446"><a href="#CoForest-1446"><span class="linenos">1446</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoForest-1447"><a href="#CoForest-1447"><span class="linenos">1447</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="CoForest-1448"><a href="#CoForest-1448"><span class="linenos">1448</span></a>
</span><span id="CoForest-1449"><a href="#CoForest-1449"><span class="linenos">1449</span></a><span class="sd">        Returns</span>
</span><span id="CoForest-1450"><a href="#CoForest-1450"><span class="linenos">1450</span></a><span class="sd">        -------</span>
</span><span id="CoForest-1451"><a href="#CoForest-1451"><span class="linenos">1451</span></a><span class="sd">        self: CoForest</span>
</span><span id="CoForest-1452"><a href="#CoForest-1452"><span class="linenos">1452</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoForest-1453"><a href="#CoForest-1453"><span class="linenos">1453</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoForest-1454"><a href="#CoForest-1454"><span class="linenos">1454</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoForest-1455"><a href="#CoForest-1455"><span class="linenos">1455</span></a>        <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="CoForest-1456"><a href="#CoForest-1456"><span class="linenos">1456</span></a>
</span><span id="CoForest-1457"><a href="#CoForest-1457"><span class="linenos">1457</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoForest-1458"><a href="#CoForest-1458"><span class="linenos">1458</span></a>
</span><span id="CoForest-1459"><a href="#CoForest-1459"><span class="linenos">1459</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoForest-1460"><a href="#CoForest-1460"><span class="linenos">1460</span></a>
</span><span id="CoForest-1461"><a href="#CoForest-1461"><span class="linenos">1461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoForest-1462"><a href="#CoForest-1462"><span class="linenos">1462</span></a>
</span><span id="CoForest-1463"><a href="#CoForest-1463"><span class="linenos">1463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest-1464"><a href="#CoForest-1464"><span class="linenos">1464</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest-1465"><a href="#CoForest-1465"><span class="linenos">1465</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest-1466"><a href="#CoForest-1466"><span class="linenos">1466</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest-1467"><a href="#CoForest-1467"><span class="linenos">1467</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="CoForest-1468"><a href="#CoForest-1468"><span class="linenos">1468</span></a>            <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="CoForest-1469"><a href="#CoForest-1469"><span class="linenos">1469</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2147483647</span><span class="p">))</span>
</span><span id="CoForest-1470"><a href="#CoForest-1470"><span class="linenos">1470</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="CoForest-1471"><a href="#CoForest-1471"><span class="linenos">1471</span></a>
</span><span id="CoForest-1472"><a href="#CoForest-1472"><span class="linenos">1472</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="CoForest-1473"><a href="#CoForest-1473"><span class="linenos">1473</span></a>            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">beginning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoForest-1474"><a href="#CoForest-1474"><span class="linenos">1474</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="CoForest-1475"><a href="#CoForest-1475"><span class="linenos">1475</span></a>        <span class="p">)</span>
</span><span id="CoForest-1476"><a href="#CoForest-1476"><span class="linenos">1476</span></a>
</span><span id="CoForest-1477"><a href="#CoForest-1477"><span class="linenos">1477</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest-1478"><a href="#CoForest-1478"><span class="linenos">1478</span></a>            <span class="c1"># The paper stablishes that the weight of each hypothesis is 0,</span>
</span><span id="CoForest-1479"><a href="#CoForest-1479"><span class="linenos">1479</span></a>            <span class="c1"># but it is not possible to do that because it will be impossible increase the training set</span>
</span><span id="CoForest-1480"><a href="#CoForest-1480"><span class="linenos">1480</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.2&quot;</span><span class="p">:</span>
</span><span id="CoForest-1481"><a href="#CoForest-1481"><span class="linenos">1481</span></a>                <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_label</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>  <span class="c1"># Version 1.0.2</span>
</span><span id="CoForest-1482"><a href="#CoForest-1482"><span class="linenos">1482</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1483"><a href="#CoForest-1483"><span class="linenos">1483</span></a>                <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__confidence</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">X_label</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="CoForest-1484"><a href="#CoForest-1484"><span class="linenos">1484</span></a>
</span><span id="CoForest-1485"><a href="#CoForest-1485"><span class="linenos">1485</span></a>        <span class="n">changing</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="CoForest-1486"><a href="#CoForest-1486"><span class="linenos">1486</span></a>        <span class="k">while</span> <span class="n">changing</span><span class="p">:</span>
</span><span id="CoForest-1487"><a href="#CoForest-1487"><span class="linenos">1487</span></a>            <span class="n">changing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CoForest-1488"><a href="#CoForest-1488"><span class="linenos">1488</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest-1489"><a href="#CoForest-1489"><span class="linenos">1489</span></a>                <span class="n">hi</span><span class="p">,</span> <span class="n">ei</span><span class="p">,</span> <span class="n">wi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="CoForest-1490"><a href="#CoForest-1490"><span class="linenos">1490</span></a>
</span><span id="CoForest-1491"><a href="#CoForest-1491"><span class="linenos">1491</span></a>                <span class="n">ei_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__estimate_error</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="CoForest-1492"><a href="#CoForest-1492"><span class="linenos">1492</span></a>
</span><span id="CoForest-1493"><a href="#CoForest-1493"><span class="linenos">1493</span></a>                <span class="k">if</span> <span class="n">ei_t</span> <span class="o">&lt;</span> <span class="n">ei</span><span class="p">:</span>
</span><span id="CoForest-1494"><a href="#CoForest-1494"><span class="linenos">1494</span></a>                    <span class="n">random_index_subsample</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="CoForest-1495"><a href="#CoForest-1495"><span class="linenos">1495</span></a>                    <span class="n">random_index_subsample</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span>
</span><span id="CoForest-1496"><a href="#CoForest-1496"><span class="linenos">1496</span></a>                        <span class="n">random_index_subsample</span>
</span><span id="CoForest-1497"><a href="#CoForest-1497"><span class="linenos">1497</span></a>                    <span class="p">)</span>
</span><span id="CoForest-1498"><a href="#CoForest-1498"><span class="linenos">1498</span></a>                    <span class="n">cond</span> <span class="o">=</span> <span class="n">random_index_subsample</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">safe_division</span><span class="p">(</span><span class="n">ei</span> <span class="o">*</span> <span class="n">wi</span><span class="p">,</span> <span class="n">ei_t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">))]</span>
</span><span id="CoForest-1499"><a href="#CoForest-1499"><span class="linenos">1499</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest-1500"><a href="#CoForest-1500"><span class="linenos">1500</span></a>                        <span class="n">Ui_t</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="CoForest-1501"><a href="#CoForest-1501"><span class="linenos">1501</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1502"><a href="#CoForest-1502"><span class="linenos">1502</span></a>                        <span class="n">Ui_t</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="CoForest-1503"><a href="#CoForest-1503"><span class="linenos">1503</span></a>
</span><span id="CoForest-1504"><a href="#CoForest-1504"><span class="linenos">1504</span></a>                    <span class="n">raw_predictions</span> <span class="o">=</span> <span class="n">hi</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Ui_t</span><span class="p">)</span>
</span><span id="CoForest-1505"><a href="#CoForest-1505"><span class="linenos">1505</span></a>                    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoForest-1506"><a href="#CoForest-1506"><span class="linenos">1506</span></a>                    <span class="n">class_predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1507"><a href="#CoForest-1507"><span class="linenos">1507</span></a>
</span><span id="CoForest-1508"><a href="#CoForest-1508"><span class="linenos">1508</span></a>                    <span class="n">to_label</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoForest-1509"><a href="#CoForest-1509"><span class="linenos">1509</span></a>                    <span class="n">wi_t</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">to_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="CoForest-1510"><a href="#CoForest-1510"><span class="linenos">1510</span></a>
</span><span id="CoForest-1511"><a href="#CoForest-1511"><span class="linenos">1511</span></a>                    <span class="k">if</span> <span class="n">ei_t</span> <span class="o">*</span> <span class="n">wi_t</span> <span class="o">&lt;</span> <span class="n">ei</span> <span class="o">*</span> <span class="n">wi</span><span class="p">:</span>
</span><span id="CoForest-1512"><a href="#CoForest-1512"><span class="linenos">1512</span></a>                        <span class="n">changing</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoForest-1513"><a href="#CoForest-1513"><span class="linenos">1513</span></a>                        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest-1514"><a href="#CoForest-1514"><span class="linenos">1514</span></a>                            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Ui_t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_label</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoForest-1515"><a href="#CoForest-1515"><span class="linenos">1515</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1516"><a href="#CoForest-1516"><span class="linenos">1516</span></a>                            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Ui_t</span><span class="p">[</span><span class="n">to_label</span><span class="p">]))</span>
</span><span id="CoForest-1517"><a href="#CoForest-1517"><span class="linenos">1517</span></a>                        <span class="n">y_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">class_predicted</span><span class="p">[</span><span class="n">to_label</span><span class="p">]))</span>
</span><span id="CoForest-1518"><a href="#CoForest-1518"><span class="linenos">1518</span></a>                        <span class="n">hi</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CoForest-1519"><a href="#CoForest-1519"><span class="linenos">1519</span></a>                            <span class="n">x_temp</span><span class="p">,</span>
</span><span id="CoForest-1520"><a href="#CoForest-1520"><span class="linenos">1520</span></a>                            <span class="n">y_temp</span><span class="p">,</span>
</span><span id="CoForest-1521"><a href="#CoForest-1521"><span class="linenos">1521</span></a>                            <span class="o">**</span><span class="n">kwards</span>
</span><span id="CoForest-1522"><a href="#CoForest-1522"><span class="linenos">1522</span></a>                        <span class="p">)</span>
</span><span id="CoForest-1523"><a href="#CoForest-1523"><span class="linenos">1523</span></a>
</span><span id="CoForest-1524"><a href="#CoForest-1524"><span class="linenos">1524</span></a>                    <span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ei_t</span>
</span><span id="CoForest-1525"><a href="#CoForest-1525"><span class="linenos">1525</span></a>                    <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wi_t</span>
</span><span id="CoForest-1526"><a href="#CoForest-1526"><span class="linenos">1526</span></a>
</span><span id="CoForest-1527"><a href="#CoForest-1527"><span class="linenos">1527</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span>
</span><span id="CoForest-1528"><a href="#CoForest-1528"><span class="linenos">1528</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="CoForest-1529"><a href="#CoForest-1529"><span class="linenos">1529</span></a>
</span><span id="CoForest-1530"><a href="#CoForest-1530"><span class="linenos">1530</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><h2 id="coforest-classifier-random-forest-co-training"><strong>CoForest classifier. Random Forest co-training</strong></h2>

<p>Ensemble method for CoTraining based on Random Forest.</p>

<p>The main process is:</p>

<ol>
<li>Train a committee of classifiers using bootstrap.</li>
<li>While any base classifier is retrained:
<ol>
<li>Predict the instances from the unlabeled set.</li>
<li>Select the instances with the highest probability.</li>
<li>Label the instances with the highest probability</li>
<li>Add the instances to the labeled set only if the error is not bigger than the previous error.</li>
<li>Retrain the classifier with the new instances.</li>
</ol></li>
<li>Combine the probabilities of each classifier.</li>
</ol>

<h2 id="methods"><strong>Methods</strong></h2>

<ul>
<li><code><a href="#CoForest.fit">fit</a></code>: Fit the model with the labeled instances.</li>
<li><code><a href="#CoForest.predict">predict</a></code> : Predict the class for each instance.</li>
<li><code><a href="#CoForest.predict_proba">predict_proba</a></code>: Predict the probability for each class.</li>
<li><code><a href="#CoForest.score">score</a></code>: Return the mean accuracy on the given test data and labels.</li>
</ul>

<h2 id="example"><strong>Example</strong></h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn"><a href="">sslearn.wrapper</a></span> <span class="kn">import</span> <span class="n">CoForest</span>
<span class="kn">from</span> <span class="nn"><a href="model_selection.html">sslearn.model_selection</a></span> <span class="kn">import</span> <span class="n">artificial_ssl_dataset</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">artificial_ssl_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">coforest</span> <span class="o">=</span> <span class="n">CoForest</span><span class="p">()</span>
<span class="n">coforest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">coforest</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">y_unlabel</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="references"><strong>References</strong></h2>

<p>Li, M., &amp; Zhou, Z.-H. (2007).<br>
Improve Computer-Aided Diagnosis With Machine Learning Techniques Using Undiagnosed Samples.<br>
<i>IEEE Transactions on Systems, Man, and Cybernetics - Part A: Systems and Humans</i>,<br>
37(6), 1088-1098. <a href="https://doi.org/10.1109/tsmca.2007.904745">10.1109/tsmca.2007.904745</a></p>
</div>


                            <div id="CoForest.__init__" class="classattr">
                                        <input id="CoForest.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CoForest</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">n_estimators</span><span class="o">=</span><span class="mi">7</span>,</span><span class="param">	<span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span>,</span><span class="param">	<span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0.3&#39;</span></span>)</span>

                <label class="view-source-button" for="CoForest.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoForest.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoForest.__init__-1327"><a href="#CoForest.__init__-1327"><span class="linenos">1327</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.3&quot;</span><span class="p">):</span>
</span><span id="CoForest.__init__-1328"><a href="#CoForest.__init__-1328"><span class="linenos">1328</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoForest.__init__-1329"><a href="#CoForest.__init__-1329"><span class="linenos">1329</span></a><span class="sd">        Generate a CoForest classifier.</span>
</span><span id="CoForest.__init__-1330"><a href="#CoForest.__init__-1330"><span class="linenos">1330</span></a><span class="sd">        A SSL Random Forest adaption for CoTraining. </span>
</span><span id="CoForest.__init__-1331"><a href="#CoForest.__init__-1331"><span class="linenos">1331</span></a>
</span><span id="CoForest.__init__-1332"><a href="#CoForest.__init__-1332"><span class="linenos">1332</span></a><span class="sd">        Parameters</span>
</span><span id="CoForest.__init__-1333"><a href="#CoForest.__init__-1333"><span class="linenos">1333</span></a><span class="sd">        ----------</span>
</span><span id="CoForest.__init__-1334"><a href="#CoForest.__init__-1334"><span class="linenos">1334</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="CoForest.__init__-1335"><a href="#CoForest.__init__-1335"><span class="linenos">1335</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="CoForest.__init__-1336"><a href="#CoForest.__init__-1336"><span class="linenos">1336</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="CoForest.__init__-1337"><a href="#CoForest.__init__-1337"><span class="linenos">1337</span></a><span class="sd">            The number of base estimators in the ensemble., by default 7</span>
</span><span id="CoForest.__init__-1338"><a href="#CoForest.__init__-1338"><span class="linenos">1338</span></a><span class="sd">        threshold : float, optional</span>
</span><span id="CoForest.__init__-1339"><a href="#CoForest.__init__-1339"><span class="linenos">1339</span></a><span class="sd">            The decision threshold. Should be in [0, 1)., by default 0.5</span>
</span><span id="CoForest.__init__-1340"><a href="#CoForest.__init__-1340"><span class="linenos">1340</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="CoForest.__init__-1341"><a href="#CoForest.__init__-1341"><span class="linenos">1341</span></a><span class="sd">            The number of jobs to run in parallel for both fit and predict., by default None</span>
</span><span id="CoForest.__init__-1342"><a href="#CoForest.__init__-1342"><span class="linenos">1342</span></a><span class="sd">        bootstrap : bool, optional</span>
</span><span id="CoForest.__init__-1343"><a href="#CoForest.__init__-1343"><span class="linenos">1343</span></a><span class="sd">            Whether bootstrap samples are used when building estimators., by default True</span>
</span><span id="CoForest.__init__-1344"><a href="#CoForest.__init__-1344"><span class="linenos">1344</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoForest.__init__-1345"><a href="#CoForest.__init__-1345"><span class="linenos">1345</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoForest.__init__-1346"><a href="#CoForest.__init__-1346"><span class="linenos">1346</span></a><span class="sd">        **kwards : dict, optional</span>
</span><span id="CoForest.__init__-1347"><a href="#CoForest.__init__-1347"><span class="linenos">1347</span></a><span class="sd">            Additional parameters to be passed to base_estimator, by default None.</span>
</span><span id="CoForest.__init__-1348"><a href="#CoForest.__init__-1348"><span class="linenos">1348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoForest.__init__-1349"><a href="#CoForest.__init__-1349"><span class="linenos">1349</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">collection_size</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="CoForest.__init__-1350"><a href="#CoForest.__init__-1350"><span class="linenos">1350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>
</span><span id="CoForest.__init__-1351"><a href="#CoForest.__init__-1351"><span class="linenos">1351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="CoForest.__init__-1352"><a href="#CoForest.__init__-1352"><span class="linenos">1352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap</span> <span class="o">=</span> <span class="n">bootstrap</span>
</span><span id="CoForest.__init__-1353"><a href="#CoForest.__init__-1353"><span class="linenos">1353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
</span><span id="CoForest.__init__-1354"><a href="#CoForest.__init__-1354"><span class="linenos">1354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="CoForest.__init__-1355"><a href="#CoForest.__init__-1355"><span class="linenos">1355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoForest.__init__-1356"><a href="#CoForest.__init__-1356"><span class="linenos">1356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
</span><span id="CoForest.__init__-1357"><a href="#CoForest.__init__-1357"><span class="linenos">1357</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.2&quot;</span><span class="p">:</span>
</span><span id="CoForest.__init__-1358"><a href="#CoForest.__init__-1358"><span class="linenos">1358</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The version 1.0.2 is deprecated. Please use the version 1.0.3&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate a CoForest classifier.
A SSL Random Forest adaption for CoTraining. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>n_estimators</strong> (int, optional):
The number of base estimators in the ensemble., by default 7</li>
<li><strong>threshold</strong> (float, optional):
The decision threshold. Should be in [0, 1)., by default 0.5</li>
<li><strong>n_jobs</strong> (int, optional):
The number of jobs to run in parallel for both fit and predict., by default None</li>
<li><strong>bootstrap</strong> (bool, optional):
Whether bootstrap samples are used when building estimators., by default True</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
<li><strong>**kwards</strong> (dict, optional):
Additional parameters to be passed to base_estimator, by default None.</li>
</ul>
</div>


                            </div>
                            <div id="CoForest.fit" class="classattr">
                                        <input id="CoForest.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoForest.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoForest.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoForest.fit-1439"><a href="#CoForest.fit-1439"><span class="linenos">1439</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoForest.fit-1440"><a href="#CoForest.fit-1440"><span class="linenos">1440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a CoForest classifier from the training set (X, y).</span>
</span><span id="CoForest.fit-1441"><a href="#CoForest.fit-1441"><span class="linenos">1441</span></a>
</span><span id="CoForest.fit-1442"><a href="#CoForest.fit-1442"><span class="linenos">1442</span></a><span class="sd">        Parameters</span>
</span><span id="CoForest.fit-1443"><a href="#CoForest.fit-1443"><span class="linenos">1443</span></a><span class="sd">        ----------</span>
</span><span id="CoForest.fit-1444"><a href="#CoForest.fit-1444"><span class="linenos">1444</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoForest.fit-1445"><a href="#CoForest.fit-1445"><span class="linenos">1445</span></a><span class="sd">            The training input samples.</span>
</span><span id="CoForest.fit-1446"><a href="#CoForest.fit-1446"><span class="linenos">1446</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoForest.fit-1447"><a href="#CoForest.fit-1447"><span class="linenos">1447</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="CoForest.fit-1448"><a href="#CoForest.fit-1448"><span class="linenos">1448</span></a>
</span><span id="CoForest.fit-1449"><a href="#CoForest.fit-1449"><span class="linenos">1449</span></a><span class="sd">        Returns</span>
</span><span id="CoForest.fit-1450"><a href="#CoForest.fit-1450"><span class="linenos">1450</span></a><span class="sd">        -------</span>
</span><span id="CoForest.fit-1451"><a href="#CoForest.fit-1451"><span class="linenos">1451</span></a><span class="sd">        self: CoForest</span>
</span><span id="CoForest.fit-1452"><a href="#CoForest.fit-1452"><span class="linenos">1452</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoForest.fit-1453"><a href="#CoForest.fit-1453"><span class="linenos">1453</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoForest.fit-1454"><a href="#CoForest.fit-1454"><span class="linenos">1454</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoForest.fit-1455"><a href="#CoForest.fit-1455"><span class="linenos">1455</span></a>        <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="CoForest.fit-1456"><a href="#CoForest.fit-1456"><span class="linenos">1456</span></a>
</span><span id="CoForest.fit-1457"><a href="#CoForest.fit-1457"><span class="linenos">1457</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoForest.fit-1458"><a href="#CoForest.fit-1458"><span class="linenos">1458</span></a>
</span><span id="CoForest.fit-1459"><a href="#CoForest.fit-1459"><span class="linenos">1459</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoForest.fit-1460"><a href="#CoForest.fit-1460"><span class="linenos">1460</span></a>
</span><span id="CoForest.fit-1461"><a href="#CoForest.fit-1461"><span class="linenos">1461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoForest.fit-1462"><a href="#CoForest.fit-1462"><span class="linenos">1462</span></a>
</span><span id="CoForest.fit-1463"><a href="#CoForest.fit-1463"><span class="linenos">1463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest.fit-1464"><a href="#CoForest.fit-1464"><span class="linenos">1464</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest.fit-1465"><a href="#CoForest.fit-1465"><span class="linenos">1465</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest.fit-1466"><a href="#CoForest.fit-1466"><span class="linenos">1466</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest.fit-1467"><a href="#CoForest.fit-1467"><span class="linenos">1467</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="CoForest.fit-1468"><a href="#CoForest.fit-1468"><span class="linenos">1468</span></a>            <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="CoForest.fit-1469"><a href="#CoForest.fit-1469"><span class="linenos">1469</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2147483647</span><span class="p">))</span>
</span><span id="CoForest.fit-1470"><a href="#CoForest.fit-1470"><span class="linenos">1470</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="CoForest.fit-1471"><a href="#CoForest.fit-1471"><span class="linenos">1471</span></a>
</span><span id="CoForest.fit-1472"><a href="#CoForest.fit-1472"><span class="linenos">1472</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="CoForest.fit-1473"><a href="#CoForest.fit-1473"><span class="linenos">1473</span></a>            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">beginning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoForest.fit-1474"><a href="#CoForest.fit-1474"><span class="linenos">1474</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="CoForest.fit-1475"><a href="#CoForest.fit-1475"><span class="linenos">1475</span></a>        <span class="p">)</span>
</span><span id="CoForest.fit-1476"><a href="#CoForest.fit-1476"><span class="linenos">1476</span></a>
</span><span id="CoForest.fit-1477"><a href="#CoForest.fit-1477"><span class="linenos">1477</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest.fit-1478"><a href="#CoForest.fit-1478"><span class="linenos">1478</span></a>            <span class="c1"># The paper stablishes that the weight of each hypothesis is 0,</span>
</span><span id="CoForest.fit-1479"><a href="#CoForest.fit-1479"><span class="linenos">1479</span></a>            <span class="c1"># but it is not possible to do that because it will be impossible increase the training set</span>
</span><span id="CoForest.fit-1480"><a href="#CoForest.fit-1480"><span class="linenos">1480</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.2&quot;</span><span class="p">:</span>
</span><span id="CoForest.fit-1481"><a href="#CoForest.fit-1481"><span class="linenos">1481</span></a>                <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_label</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>  <span class="c1"># Version 1.0.2</span>
</span><span id="CoForest.fit-1482"><a href="#CoForest.fit-1482"><span class="linenos">1482</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest.fit-1483"><a href="#CoForest.fit-1483"><span class="linenos">1483</span></a>                <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__confidence</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">X_label</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="CoForest.fit-1484"><a href="#CoForest.fit-1484"><span class="linenos">1484</span></a>
</span><span id="CoForest.fit-1485"><a href="#CoForest.fit-1485"><span class="linenos">1485</span></a>        <span class="n">changing</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="CoForest.fit-1486"><a href="#CoForest.fit-1486"><span class="linenos">1486</span></a>        <span class="k">while</span> <span class="n">changing</span><span class="p">:</span>
</span><span id="CoForest.fit-1487"><a href="#CoForest.fit-1487"><span class="linenos">1487</span></a>            <span class="n">changing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CoForest.fit-1488"><a href="#CoForest.fit-1488"><span class="linenos">1488</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest.fit-1489"><a href="#CoForest.fit-1489"><span class="linenos">1489</span></a>                <span class="n">hi</span><span class="p">,</span> <span class="n">ei</span><span class="p">,</span> <span class="n">wi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="CoForest.fit-1490"><a href="#CoForest.fit-1490"><span class="linenos">1490</span></a>
</span><span id="CoForest.fit-1491"><a href="#CoForest.fit-1491"><span class="linenos">1491</span></a>                <span class="n">ei_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__estimate_error</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="CoForest.fit-1492"><a href="#CoForest.fit-1492"><span class="linenos">1492</span></a>
</span><span id="CoForest.fit-1493"><a href="#CoForest.fit-1493"><span class="linenos">1493</span></a>                <span class="k">if</span> <span class="n">ei_t</span> <span class="o">&lt;</span> <span class="n">ei</span><span class="p">:</span>
</span><span id="CoForest.fit-1494"><a href="#CoForest.fit-1494"><span class="linenos">1494</span></a>                    <span class="n">random_index_subsample</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="CoForest.fit-1495"><a href="#CoForest.fit-1495"><span class="linenos">1495</span></a>                    <span class="n">random_index_subsample</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span>
</span><span id="CoForest.fit-1496"><a href="#CoForest.fit-1496"><span class="linenos">1496</span></a>                        <span class="n">random_index_subsample</span>
</span><span id="CoForest.fit-1497"><a href="#CoForest.fit-1497"><span class="linenos">1497</span></a>                    <span class="p">)</span>
</span><span id="CoForest.fit-1498"><a href="#CoForest.fit-1498"><span class="linenos">1498</span></a>                    <span class="n">cond</span> <span class="o">=</span> <span class="n">random_index_subsample</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">safe_division</span><span class="p">(</span><span class="n">ei</span> <span class="o">*</span> <span class="n">wi</span><span class="p">,</span> <span class="n">ei_t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">))]</span>
</span><span id="CoForest.fit-1499"><a href="#CoForest.fit-1499"><span class="linenos">1499</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest.fit-1500"><a href="#CoForest.fit-1500"><span class="linenos">1500</span></a>                        <span class="n">Ui_t</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="CoForest.fit-1501"><a href="#CoForest.fit-1501"><span class="linenos">1501</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest.fit-1502"><a href="#CoForest.fit-1502"><span class="linenos">1502</span></a>                        <span class="n">Ui_t</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="CoForest.fit-1503"><a href="#CoForest.fit-1503"><span class="linenos">1503</span></a>
</span><span id="CoForest.fit-1504"><a href="#CoForest.fit-1504"><span class="linenos">1504</span></a>                    <span class="n">raw_predictions</span> <span class="o">=</span> <span class="n">hi</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Ui_t</span><span class="p">)</span>
</span><span id="CoForest.fit-1505"><a href="#CoForest.fit-1505"><span class="linenos">1505</span></a>                    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoForest.fit-1506"><a href="#CoForest.fit-1506"><span class="linenos">1506</span></a>                    <span class="n">class_predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest.fit-1507"><a href="#CoForest.fit-1507"><span class="linenos">1507</span></a>
</span><span id="CoForest.fit-1508"><a href="#CoForest.fit-1508"><span class="linenos">1508</span></a>                    <span class="n">to_label</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoForest.fit-1509"><a href="#CoForest.fit-1509"><span class="linenos">1509</span></a>                    <span class="n">wi_t</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">to_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="CoForest.fit-1510"><a href="#CoForest.fit-1510"><span class="linenos">1510</span></a>
</span><span id="CoForest.fit-1511"><a href="#CoForest.fit-1511"><span class="linenos">1511</span></a>                    <span class="k">if</span> <span class="n">ei_t</span> <span class="o">*</span> <span class="n">wi_t</span> <span class="o">&lt;</span> <span class="n">ei</span> <span class="o">*</span> <span class="n">wi</span><span class="p">:</span>
</span><span id="CoForest.fit-1512"><a href="#CoForest.fit-1512"><span class="linenos">1512</span></a>                        <span class="n">changing</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoForest.fit-1513"><a href="#CoForest.fit-1513"><span class="linenos">1513</span></a>                        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest.fit-1514"><a href="#CoForest.fit-1514"><span class="linenos">1514</span></a>                            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Ui_t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_label</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoForest.fit-1515"><a href="#CoForest.fit-1515"><span class="linenos">1515</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest.fit-1516"><a href="#CoForest.fit-1516"><span class="linenos">1516</span></a>                            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Ui_t</span><span class="p">[</span><span class="n">to_label</span><span class="p">]))</span>
</span><span id="CoForest.fit-1517"><a href="#CoForest.fit-1517"><span class="linenos">1517</span></a>                        <span class="n">y_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">class_predicted</span><span class="p">[</span><span class="n">to_label</span><span class="p">]))</span>
</span><span id="CoForest.fit-1518"><a href="#CoForest.fit-1518"><span class="linenos">1518</span></a>                        <span class="n">hi</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CoForest.fit-1519"><a href="#CoForest.fit-1519"><span class="linenos">1519</span></a>                            <span class="n">x_temp</span><span class="p">,</span>
</span><span id="CoForest.fit-1520"><a href="#CoForest.fit-1520"><span class="linenos">1520</span></a>                            <span class="n">y_temp</span><span class="p">,</span>
</span><span id="CoForest.fit-1521"><a href="#CoForest.fit-1521"><span class="linenos">1521</span></a>                            <span class="o">**</span><span class="n">kwards</span>
</span><span id="CoForest.fit-1522"><a href="#CoForest.fit-1522"><span class="linenos">1522</span></a>                        <span class="p">)</span>
</span><span id="CoForest.fit-1523"><a href="#CoForest.fit-1523"><span class="linenos">1523</span></a>
</span><span id="CoForest.fit-1524"><a href="#CoForest.fit-1524"><span class="linenos">1524</span></a>                    <span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ei_t</span>
</span><span id="CoForest.fit-1525"><a href="#CoForest.fit-1525"><span class="linenos">1525</span></a>                    <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wi_t</span>
</span><span id="CoForest.fit-1526"><a href="#CoForest.fit-1526"><span class="linenos">1526</span></a>
</span><span id="CoForest.fit-1527"><a href="#CoForest.fit-1527"><span class="linenos">1527</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span>
</span><span id="CoForest.fit-1528"><a href="#CoForest.fit-1528"><span class="linenos">1528</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="CoForest.fit-1529"><a href="#CoForest.fit-1529"><span class="linenos">1529</span></a>
</span><span id="CoForest.fit-1530"><a href="#CoForest.fit-1530"><span class="linenos">1530</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a CoForest classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (CoForest):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="CoForest.predict_proba" class="function">predict_proba</dd>
                <dd id="CoForest.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="CoForest.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="CoForest.get_params" class="function">get_params</dd>
                <dd id="CoForest.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TriTraining">
                            <input id="TriTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TriTraining</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="TriTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TriTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TriTraining-25"><a href="#TriTraining-25"><span class="linenos"> 25</span></a><span class="k">class</span> <span class="nc">TriTraining</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="TriTraining-26"><a href="#TriTraining-26"><span class="linenos"> 26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TriTraining-27"><a href="#TriTraining-27"><span class="linenos"> 27</span></a><span class="sd">    **TriTraining. Trio of classifiers with bootstrapping.**</span>
</span><span id="TriTraining-28"><a href="#TriTraining-28"><span class="linenos"> 28</span></a>
</span><span id="TriTraining-29"><a href="#TriTraining-29"><span class="linenos"> 29</span></a><span class="sd">    The main process is:</span>
</span><span id="TriTraining-30"><a href="#TriTraining-30"><span class="linenos"> 30</span></a><span class="sd">    1. Generate three classifiers using bootstrapping.</span>
</span><span id="TriTraining-31"><a href="#TriTraining-31"><span class="linenos"> 31</span></a><span class="sd">    2. Iterate until convergence:</span>
</span><span id="TriTraining-32"><a href="#TriTraining-32"><span class="linenos"> 32</span></a><span class="sd">        1. Calculate the error between two hypotheses.</span>
</span><span id="TriTraining-33"><a href="#TriTraining-33"><span class="linenos"> 33</span></a><span class="sd">        2. If the error is less than the previous error, generate a dataset with the instances where both hypotheses agree.</span>
</span><span id="TriTraining-34"><a href="#TriTraining-34"><span class="linenos"> 34</span></a><span class="sd">        3. Retrain the classifiers with the new dataset and the original labeled dataset.</span>
</span><span id="TriTraining-35"><a href="#TriTraining-35"><span class="linenos"> 35</span></a><span class="sd">    3. Combine the predictions of the three classifiers.</span>
</span><span id="TriTraining-36"><a href="#TriTraining-36"><span class="linenos"> 36</span></a>
</span><span id="TriTraining-37"><a href="#TriTraining-37"><span class="linenos"> 37</span></a><span class="sd">    **Methods**</span>
</span><span id="TriTraining-38"><a href="#TriTraining-38"><span class="linenos"> 38</span></a><span class="sd">    -------</span>
</span><span id="TriTraining-39"><a href="#TriTraining-39"><span class="linenos"> 39</span></a><span class="sd">    - `fit`: Fit the model with the labeled instances.</span>
</span><span id="TriTraining-40"><a href="#TriTraining-40"><span class="linenos"> 40</span></a><span class="sd">    - `predict` : Predict the class for each instance.</span>
</span><span id="TriTraining-41"><a href="#TriTraining-41"><span class="linenos"> 41</span></a><span class="sd">    - `predict_proba`: Predict the probability for each class.</span>
</span><span id="TriTraining-42"><a href="#TriTraining-42"><span class="linenos"> 42</span></a><span class="sd">    - `score`: Return the mean accuracy on the given test data and labels.</span>
</span><span id="TriTraining-43"><a href="#TriTraining-43"><span class="linenos"> 43</span></a>
</span><span id="TriTraining-44"><a href="#TriTraining-44"><span class="linenos"> 44</span></a><span class="sd">    **References**</span>
</span><span id="TriTraining-45"><a href="#TriTraining-45"><span class="linenos"> 45</span></a><span class="sd">    ----------</span>
</span><span id="TriTraining-46"><a href="#TriTraining-46"><span class="linenos"> 46</span></a><span class="sd">    Zhi-Hua Zhou and Ming Li,&lt;br&gt;</span>
</span><span id="TriTraining-47"><a href="#TriTraining-47"><span class="linenos"> 47</span></a><span class="sd">    Tri-training: exploiting unlabeled data using three classifiers,&lt;br&gt;</span>
</span><span id="TriTraining-48"><a href="#TriTraining-48"><span class="linenos"> 48</span></a><span class="sd">    in &lt;i&gt;IEEE Transactions on Knowledge and Data Engineering&lt;/i&gt;,&lt;br&gt;</span>
</span><span id="TriTraining-49"><a href="#TriTraining-49"><span class="linenos"> 49</span></a><span class="sd">    vol. 17, no. 11, pp. 1529-1541, Nov. 2005,&lt;br&gt;</span>
</span><span id="TriTraining-50"><a href="#TriTraining-50"><span class="linenos"> 50</span></a><span class="sd">    [10.1109/TKDE.2005.186](https://doi.org/10.1109/TKDE.2005.186)</span>
</span><span id="TriTraining-51"><a href="#TriTraining-51"><span class="linenos"> 51</span></a>
</span><span id="TriTraining-52"><a href="#TriTraining-52"><span class="linenos"> 52</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TriTraining-53"><a href="#TriTraining-53"><span class="linenos"> 53</span></a>
</span><span id="TriTraining-54"><a href="#TriTraining-54"><span class="linenos"> 54</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="TriTraining-55"><a href="#TriTraining-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TriTraining-56"><a href="#TriTraining-56"><span class="linenos"> 56</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="TriTraining-57"><a href="#TriTraining-57"><span class="linenos"> 57</span></a>        <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining-58"><a href="#TriTraining-58"><span class="linenos"> 58</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining-59"><a href="#TriTraining-59"><span class="linenos"> 59</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining-60"><a href="#TriTraining-60"><span class="linenos"> 60</span></a>    <span class="p">):</span>
</span><span id="TriTraining-61"><a href="#TriTraining-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;TriTraining. Trio of classifiers with bootstrapping.</span>
</span><span id="TriTraining-62"><a href="#TriTraining-62"><span class="linenos"> 62</span></a>
</span><span id="TriTraining-63"><a href="#TriTraining-63"><span class="linenos"> 63</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-64"><a href="#TriTraining-64"><span class="linenos"> 64</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-65"><a href="#TriTraining-65"><span class="linenos"> 65</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="TriTraining-66"><a href="#TriTraining-66"><span class="linenos"> 66</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="TriTraining-67"><a href="#TriTraining-67"><span class="linenos"> 67</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="TriTraining-68"><a href="#TriTraining-68"><span class="linenos"> 68</span></a><span class="sd">            Number of samples to generate.</span>
</span><span id="TriTraining-69"><a href="#TriTraining-69"><span class="linenos"> 69</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="TriTraining-70"><a href="#TriTraining-70"><span class="linenos"> 70</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="TriTraining-71"><a href="#TriTraining-71"><span class="linenos"> 71</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="TriTraining-72"><a href="#TriTraining-72"><span class="linenos"> 72</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="TriTraining-73"><a href="#TriTraining-73"><span class="linenos"> 73</span></a><span class="sd">            The number of jobs to run in parallel for both `fit` and `predict`.</span>
</span><span id="TriTraining-74"><a href="#TriTraining-74"><span class="linenos"> 74</span></a><span class="sd">            `None` means 1 unless in a :obj:`joblib.parallel_backend` context.</span>
</span><span id="TriTraining-75"><a href="#TriTraining-75"><span class="linenos"> 75</span></a><span class="sd">            `-1` means using all processors., by default None</span>
</span><span id="TriTraining-76"><a href="#TriTraining-76"><span class="linenos"> 76</span></a><span class="sd">       </span>
</span><span id="TriTraining-77"><a href="#TriTraining-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-78"><a href="#TriTraining-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="TriTraining-79"><a href="#TriTraining-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">collection_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining-80"><a href="#TriTraining-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">=</span> <span class="n">n_samples</span>
</span><span id="TriTraining-81"><a href="#TriTraining-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
</span><span id="TriTraining-82"><a href="#TriTraining-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="TriTraining-83"><a href="#TriTraining-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="TriTraining-84"><a href="#TriTraining-84"><span class="linenos"> 84</span></a>
</span><span id="TriTraining-85"><a href="#TriTraining-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="TriTraining-86"><a href="#TriTraining-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a TriTraining classifier from the training set (X, y).</span>
</span><span id="TriTraining-87"><a href="#TriTraining-87"><span class="linenos"> 87</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-88"><a href="#TriTraining-88"><span class="linenos"> 88</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-89"><a href="#TriTraining-89"><span class="linenos"> 89</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="TriTraining-90"><a href="#TriTraining-90"><span class="linenos"> 90</span></a><span class="sd">            The training input samples.</span>
</span><span id="TriTraining-91"><a href="#TriTraining-91"><span class="linenos"> 91</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="TriTraining-92"><a href="#TriTraining-92"><span class="linenos"> 92</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="TriTraining-93"><a href="#TriTraining-93"><span class="linenos"> 93</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining-94"><a href="#TriTraining-94"><span class="linenos"> 94</span></a><span class="sd">        -------</span>
</span><span id="TriTraining-95"><a href="#TriTraining-95"><span class="linenos"> 95</span></a><span class="sd">        self : TriTraining</span>
</span><span id="TriTraining-96"><a href="#TriTraining-96"><span class="linenos"> 96</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="TriTraining-97"><a href="#TriTraining-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-98"><a href="#TriTraining-98"><span class="linenos"> 98</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="TriTraining-99"><a href="#TriTraining-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining-100"><a href="#TriTraining-100"><span class="linenos">100</span></a>
</span><span id="TriTraining-101"><a href="#TriTraining-101"><span class="linenos">101</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="TriTraining-102"><a href="#TriTraining-102"><span class="linenos">102</span></a>
</span><span id="TriTraining-103"><a href="#TriTraining-103"><span class="linenos">103</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="TriTraining-104"><a href="#TriTraining-104"><span class="linenos">104</span></a>
</span><span id="TriTraining-105"><a href="#TriTraining-105"><span class="linenos">105</span></a>        <span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining-106"><a href="#TriTraining-106"><span class="linenos">106</span></a>        <span class="n">e_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-107"><a href="#TriTraining-107"><span class="linenos">107</span></a>        <span class="n">l_</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-108"><a href="#TriTraining-108"><span class="linenos">108</span></a>
</span><span id="TriTraining-109"><a href="#TriTraining-109"><span class="linenos">109</span></a>        <span class="c1"># Get a random instance for each class to keep class index</span>
</span><span id="TriTraining-110"><a href="#TriTraining-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining-111"><a href="#TriTraining-111"><span class="linenos">111</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="TriTraining-112"><a href="#TriTraining-112"><span class="linenos">112</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="TriTraining-113"><a href="#TriTraining-113"><span class="linenos">113</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="TriTraining-114"><a href="#TriTraining-114"><span class="linenos">114</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining-115"><a href="#TriTraining-115"><span class="linenos">115</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining-116"><a href="#TriTraining-116"><span class="linenos">116</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining-117"><a href="#TriTraining-117"><span class="linenos">117</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="TriTraining-118"><a href="#TriTraining-118"><span class="linenos">118</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="TriTraining-119"><a href="#TriTraining-119"><span class="linenos">119</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="TriTraining-120"><a href="#TriTraining-120"><span class="linenos">120</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="TriTraining-121"><a href="#TriTraining-121"><span class="linenos">121</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="TriTraining-122"><a href="#TriTraining-122"><span class="linenos">122</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TriTraining-123"><a href="#TriTraining-123"><span class="linenos">123</span></a>                <span class="k">break</span>
</span><span id="TriTraining-124"><a href="#TriTraining-124"><span class="linenos">124</span></a>
</span><span id="TriTraining-125"><a href="#TriTraining-125"><span class="linenos">125</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining-126"><a href="#TriTraining-126"><span class="linenos">126</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="TriTraining-127"><a href="#TriTraining-127"><span class="linenos">127</span></a>                <span class="n">X_label</span><span class="p">,</span>
</span><span id="TriTraining-128"><a href="#TriTraining-128"><span class="linenos">128</span></a>                <span class="n">y_label</span><span class="p">,</span>
</span><span id="TriTraining-129"><a href="#TriTraining-129"><span class="linenos">129</span></a>                <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="TriTraining-130"><a href="#TriTraining-130"><span class="linenos">130</span></a>                <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="TriTraining-131"><a href="#TriTraining-131"><span class="linenos">131</span></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="TriTraining-132"><a href="#TriTraining-132"><span class="linenos">132</span></a>            <span class="p">)</span>
</span><span id="TriTraining-133"><a href="#TriTraining-133"><span class="linenos">133</span></a>
</span><span id="TriTraining-134"><a href="#TriTraining-134"><span class="linenos">134</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining-135"><a href="#TriTraining-135"><span class="linenos">135</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="TriTraining-136"><a href="#TriTraining-136"><span class="linenos">136</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">])</span>
</span><span id="TriTraining-137"><a href="#TriTraining-137"><span class="linenos">137</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TriTraining-138"><a href="#TriTraining-138"><span class="linenos">138</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TriTraining-139"><a href="#TriTraining-139"><span class="linenos">139</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TriTraining-140"><a href="#TriTraining-140"><span class="linenos">140</span></a>
</span><span id="TriTraining-141"><a href="#TriTraining-141"><span class="linenos">141</span></a>            <span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="TriTraining-142"><a href="#TriTraining-142"><span class="linenos">142</span></a>                <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="TriTraining-143"><a href="#TriTraining-143"><span class="linenos">143</span></a>            <span class="p">)</span>
</span><span id="TriTraining-144"><a href="#TriTraining-144"><span class="linenos">144</span></a>
</span><span id="TriTraining-145"><a href="#TriTraining-145"><span class="linenos">145</span></a>        <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="TriTraining-146"><a href="#TriTraining-146"><span class="linenos">146</span></a>        <span class="k">while</span> <span class="n">something_has_changed</span><span class="p">:</span>
</span><span id="TriTraining-147"><a href="#TriTraining-147"><span class="linenos">147</span></a>            <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TriTraining-148"><a href="#TriTraining-148"><span class="linenos">148</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-149"><a href="#TriTraining-149"><span class="linenos">149</span></a>            <span class="n">Ly</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-150"><a href="#TriTraining-150"><span class="linenos">150</span></a>            <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining-151"><a href="#TriTraining-151"><span class="linenos">151</span></a>            <span class="n">updates</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="TriTraining-152"><a href="#TriTraining-152"><span class="linenos">152</span></a>
</span><span id="TriTraining-153"><a href="#TriTraining-153"><span class="linenos">153</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining-154"><a href="#TriTraining-154"><span class="linenos">154</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="TriTraining-155"><a href="#TriTraining-155"><span class="linenos">155</span></a>                <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="TriTraining-156"><a href="#TriTraining-156"><span class="linenos">156</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_measure_error</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span>
</span><span id="TriTraining-157"><a href="#TriTraining-157"><span class="linenos">157</span></a>                <span class="p">)</span>
</span><span id="TriTraining-158"><a href="#TriTraining-158"><span class="linenos">158</span></a>                <span class="k">if</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining-159"><a href="#TriTraining-159"><span class="linenos">159</span></a>                    <span class="k">continue</span>
</span><span id="TriTraining-160"><a href="#TriTraining-160"><span class="linenos">160</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="TriTraining-161"><a href="#TriTraining-161"><span class="linenos">161</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="TriTraining-162"><a href="#TriTraining-162"><span class="linenos">162</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="TriTraining-163"><a href="#TriTraining-163"><span class="linenos">163</span></a>                <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="TriTraining-164"><a href="#TriTraining-164"><span class="linenos">164</span></a>
</span><span id="TriTraining-165"><a href="#TriTraining-165"><span class="linenos">165</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TriTraining-166"><a href="#TriTraining-166"><span class="linenos">166</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
</span><span id="TriTraining-167"><a href="#TriTraining-167"><span class="linenos">167</span></a>                        <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="TriTraining-168"><a href="#TriTraining-168"><span class="linenos">168</span></a>                    <span class="p">)</span>
</span><span id="TriTraining-169"><a href="#TriTraining-169"><span class="linenos">169</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="TriTraining-170"><a href="#TriTraining-170"><span class="linenos">170</span></a>                    <span class="k">continue</span>
</span><span id="TriTraining-171"><a href="#TriTraining-171"><span class="linenos">171</span></a>                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining-172"><a href="#TriTraining-172"><span class="linenos">172</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining-173"><a href="#TriTraining-173"><span class="linenos">173</span></a>                <span class="k">elif</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">):</span>
</span><span id="TriTraining-174"><a href="#TriTraining-174"><span class="linenos">174</span></a>                    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_subsample</span><span class="p">(</span>
</span><span id="TriTraining-175"><a href="#TriTraining-175"><span class="linenos">175</span></a>                        <span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="TriTraining-176"><a href="#TriTraining-176"><span class="linenos">176</span></a>                        <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
</span><span id="TriTraining-177"><a href="#TriTraining-177"><span class="linenos">177</span></a>                            <span class="n">safe_division</span><span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="TriTraining-178"><a href="#TriTraining-178"><span class="linenos">178</span></a>                        <span class="p">),</span>
</span><span id="TriTraining-179"><a href="#TriTraining-179"><span class="linenos">179</span></a>                        <span class="n">random_state</span><span class="p">,</span>
</span><span id="TriTraining-180"><a href="#TriTraining-180"><span class="linenos">180</span></a>                    <span class="p">)</span>
</span><span id="TriTraining-181"><a href="#TriTraining-181"><span class="linenos">181</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining-182"><a href="#TriTraining-182"><span class="linenos">182</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="TriTraining-183"><a href="#TriTraining-183"><span class="linenos">183</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining-184"><a href="#TriTraining-184"><span class="linenos">184</span></a>
</span><span id="TriTraining-185"><a href="#TriTraining-185"><span class="linenos">185</span></a>            <span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="TriTraining-186"><a href="#TriTraining-186"><span class="linenos">186</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span>
</span><span id="TriTraining-187"><a href="#TriTraining-187"><span class="linenos">187</span></a>                    <span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span>
</span><span id="TriTraining-188"><a href="#TriTraining-188"><span class="linenos">188</span></a>                <span class="p">)</span>
</span><span id="TriTraining-189"><a href="#TriTraining-189"><span class="linenos">189</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining-190"><a href="#TriTraining-190"><span class="linenos">190</span></a>            <span class="p">)</span>
</span><span id="TriTraining-191"><a href="#TriTraining-191"><span class="linenos">191</span></a>
</span><span id="TriTraining-192"><a href="#TriTraining-192"><span class="linenos">192</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining-193"><a href="#TriTraining-193"><span class="linenos">193</span></a>                <span class="k">if</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining-194"><a href="#TriTraining-194"><span class="linenos">194</span></a>                    <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="TriTraining-195"><a href="#TriTraining-195"><span class="linenos">195</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="TriTraining-196"><a href="#TriTraining-196"><span class="linenos">196</span></a>                    <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining-197"><a href="#TriTraining-197"><span class="linenos">197</span></a>
</span><span id="TriTraining-198"><a href="#TriTraining-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">hypotheses</span>
</span><span id="TriTraining-199"><a href="#TriTraining-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-200"><a href="#TriTraining-200"><span class="linenos">200</span></a>
</span><span id="TriTraining-201"><a href="#TriTraining-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="TriTraining-202"><a href="#TriTraining-202"><span class="linenos">202</span></a>
</span><span id="TriTraining-203"><a href="#TriTraining-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">_fit_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">,</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="TriTraining-204"><a href="#TriTraining-204"><span class="linenos">204</span></a>        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
</span><span id="TriTraining-205"><a href="#TriTraining-205"><span class="linenos">205</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="TriTraining-206"><a href="#TriTraining-206"><span class="linenos">206</span></a>                <span class="n">_tempL</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span>
</span><span id="TriTraining-207"><a href="#TriTraining-207"><span class="linenos">207</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TriTraining-208"><a href="#TriTraining-208"><span class="linenos">208</span></a>                <span class="n">_tempL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
</span><span id="TriTraining-209"><a href="#TriTraining-209"><span class="linenos">209</span></a>            <span class="n">_tempY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">Ly</span><span class="p">))</span>
</span><span id="TriTraining-210"><a href="#TriTraining-210"><span class="linenos">210</span></a>
</span><span id="TriTraining-211"><a href="#TriTraining-211"><span class="linenos">211</span></a>            <span class="k">return</span> <span class="n">hyp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">_tempL</span><span class="p">,</span> <span class="n">_tempY</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="TriTraining-212"><a href="#TriTraining-212"><span class="linenos">212</span></a>        <span class="k">return</span> <span class="n">hyp</span>
</span><span id="TriTraining-213"><a href="#TriTraining-213"><span class="linenos">213</span></a>
</span><span id="TriTraining-214"><a href="#TriTraining-214"><span class="linenos">214</span></a>    <span class="nd">@staticmethod</span>
</span><span id="TriTraining-215"><a href="#TriTraining-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">_another_hs</span><span class="p">(</span><span class="n">hs</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="TriTraining-216"><a href="#TriTraining-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the other hypotheses</span>
</span><span id="TriTraining-217"><a href="#TriTraining-217"><span class="linenos">217</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-218"><a href="#TriTraining-218"><span class="linenos">218</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-219"><a href="#TriTraining-219"><span class="linenos">219</span></a><span class="sd">        hs : list</span>
</span><span id="TriTraining-220"><a href="#TriTraining-220"><span class="linenos">220</span></a><span class="sd">            hypotheses collection</span>
</span><span id="TriTraining-221"><a href="#TriTraining-221"><span class="linenos">221</span></a><span class="sd">        index : int</span>
</span><span id="TriTraining-222"><a href="#TriTraining-222"><span class="linenos">222</span></a><span class="sd">            base hypothesis  index</span>
</span><span id="TriTraining-223"><a href="#TriTraining-223"><span class="linenos">223</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining-224"><a href="#TriTraining-224"><span class="linenos">224</span></a><span class="sd">        -------</span>
</span><span id="TriTraining-225"><a href="#TriTraining-225"><span class="linenos">225</span></a><span class="sd">        classifiers: list</span>
</span><span id="TriTraining-226"><a href="#TriTraining-226"><span class="linenos">226</span></a><span class="sd">            Collection of other hypotheses</span>
</span><span id="TriTraining-227"><a href="#TriTraining-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-228"><a href="#TriTraining-228"><span class="linenos">228</span></a>        <span class="n">another_hs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining-229"><a href="#TriTraining-229"><span class="linenos">229</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hs</span><span class="p">)):</span>
</span><span id="TriTraining-230"><a href="#TriTraining-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">index</span><span class="p">:</span>
</span><span id="TriTraining-231"><a href="#TriTraining-231"><span class="linenos">231</span></a>                <span class="n">another_hs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="TriTraining-232"><a href="#TriTraining-232"><span class="linenos">232</span></a>        <span class="k">return</span> <span class="n">another_hs</span>
</span><span id="TriTraining-233"><a href="#TriTraining-233"><span class="linenos">233</span></a>
</span><span id="TriTraining-234"><a href="#TriTraining-234"><span class="linenos">234</span></a>    <span class="nd">@staticmethod</span>
</span><span id="TriTraining-235"><a href="#TriTraining-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">_subsample</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TriTraining-236"><a href="#TriTraining-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Randomly removes |L| - s number of examples from L</span>
</span><span id="TriTraining-237"><a href="#TriTraining-237"><span class="linenos">237</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-238"><a href="#TriTraining-238"><span class="linenos">238</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-239"><a href="#TriTraining-239"><span class="linenos">239</span></a><span class="sd">        L : tuple of array-like</span>
</span><span id="TriTraining-240"><a href="#TriTraining-240"><span class="linenos">240</span></a><span class="sd">            Collection pseudo-labeled candidates and its labels</span>
</span><span id="TriTraining-241"><a href="#TriTraining-241"><span class="linenos">241</span></a><span class="sd">        s : int</span>
</span><span id="TriTraining-242"><a href="#TriTraining-242"><span class="linenos">242</span></a><span class="sd">            Equation 10 in paper</span>
</span><span id="TriTraining-243"><a href="#TriTraining-243"><span class="linenos">243</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="TriTraining-244"><a href="#TriTraining-244"><span class="linenos">244</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="TriTraining-245"><a href="#TriTraining-245"><span class="linenos">245</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining-246"><a href="#TriTraining-246"><span class="linenos">246</span></a><span class="sd">        -------</span>
</span><span id="TriTraining-247"><a href="#TriTraining-247"><span class="linenos">247</span></a><span class="sd">        subsamples: tuple</span>
</span><span id="TriTraining-248"><a href="#TriTraining-248"><span class="linenos">248</span></a><span class="sd">            Collection of pseudo-labeled selected for enlarged labeled examples.</span>
</span><span id="TriTraining-249"><a href="#TriTraining-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-250"><a href="#TriTraining-250"><span class="linenos">250</span></a>        <span class="n">to_remove</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">s</span>
</span><span id="TriTraining-251"><a href="#TriTraining-251"><span class="linenos">251</span></a>        <span class="n">select</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">to_remove</span>
</span><span id="TriTraining-252"><a href="#TriTraining-252"><span class="linenos">252</span></a>
</span><span id="TriTraining-253"><a href="#TriTraining-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="n">resample</span><span class="p">(</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">select</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="TriTraining-254"><a href="#TriTraining-254"><span class="linenos">254</span></a>
</span><span id="TriTraining-255"><a href="#TriTraining-255"><span class="linenos">255</span></a>    <span class="k">def</span> <span class="nf">_measure_error</span><span class="p">(</span>
</span><span id="TriTraining-256"><a href="#TriTraining-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h1</span><span class="p">:</span> <span class="n">ClassifierMixin</span><span class="p">,</span> <span class="n">h2</span><span class="p">:</span> <span class="n">ClassifierMixin</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span>
</span><span id="TriTraining-257"><a href="#TriTraining-257"><span class="linenos">257</span></a>    <span class="p">):</span>
</span><span id="TriTraining-258"><a href="#TriTraining-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the error between two hypotheses</span>
</span><span id="TriTraining-259"><a href="#TriTraining-259"><span class="linenos">259</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-260"><a href="#TriTraining-260"><span class="linenos">260</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-261"><a href="#TriTraining-261"><span class="linenos">261</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="TriTraining-262"><a href="#TriTraining-262"><span class="linenos">262</span></a><span class="sd">            The training labeled input samples.</span>
</span><span id="TriTraining-263"><a href="#TriTraining-263"><span class="linenos">263</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="TriTraining-264"><a href="#TriTraining-264"><span class="linenos">264</span></a><span class="sd">            The target values (class labels).</span>
</span><span id="TriTraining-265"><a href="#TriTraining-265"><span class="linenos">265</span></a><span class="sd">        h1 : ClassifierMixin</span>
</span><span id="TriTraining-266"><a href="#TriTraining-266"><span class="linenos">266</span></a><span class="sd">            First hypothesis</span>
</span><span id="TriTraining-267"><a href="#TriTraining-267"><span class="linenos">267</span></a><span class="sd">        h2 : ClassifierMixin</span>
</span><span id="TriTraining-268"><a href="#TriTraining-268"><span class="linenos">268</span></a><span class="sd">            Second hypothesis</span>
</span><span id="TriTraining-269"><a href="#TriTraining-269"><span class="linenos">269</span></a><span class="sd">        epsilon : float</span>
</span><span id="TriTraining-270"><a href="#TriTraining-270"><span class="linenos">270</span></a><span class="sd">            A small number to avoid division by zero</span>
</span><span id="TriTraining-271"><a href="#TriTraining-271"><span class="linenos">271</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining-272"><a href="#TriTraining-272"><span class="linenos">272</span></a><span class="sd">        -------</span>
</span><span id="TriTraining-273"><a href="#TriTraining-273"><span class="linenos">273</span></a><span class="sd">        error : float</span>
</span><span id="TriTraining-274"><a href="#TriTraining-274"><span class="linenos">274</span></a><span class="sd">            Division of the number of labeled examples on which both h1 and h2 make incorrect classification,</span>
</span><span id="TriTraining-275"><a href="#TriTraining-275"><span class="linenos">275</span></a><span class="sd">            by the number of labeled examples on which the classification made by h1 is the same as that made by h2.</span>
</span><span id="TriTraining-276"><a href="#TriTraining-276"><span class="linenos">276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-277"><a href="#TriTraining-277"><span class="linenos">277</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">h1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="TriTraining-278"><a href="#TriTraining-278"><span class="linenos">278</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="TriTraining-279"><a href="#TriTraining-279"><span class="linenos">279</span></a>
</span><span id="TriTraining-280"><a href="#TriTraining-280"><span class="linenos">280</span></a>        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">!=</span> <span class="n">y</span><span class="p">))</span>
</span><span id="TriTraining-281"><a href="#TriTraining-281"><span class="linenos">281</span></a>        <span class="n">coincidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">)</span>
</span><span id="TriTraining-282"><a href="#TriTraining-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">safe_division</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">coincidence</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p><strong>TriTraining. Trio of classifiers with bootstrapping.</strong></p>

<p>The main process is:</p>

<ol>
<li>Generate three classifiers using bootstrapping.</li>
<li>Iterate until convergence:
<ol>
<li>Calculate the error between two hypotheses.</li>
<li>If the error is less than the previous error, generate a dataset with the instances where both hypotheses agree.</li>
<li>Retrain the classifiers with the new dataset and the original labeled dataset.</li>
</ol></li>
<li>Combine the predictions of the three classifiers.</li>
</ol>

<h2 id="methods"><strong>Methods</strong></h2>

<ul>
<li><code><a href="#TriTraining.fit">fit</a></code>: Fit the model with the labeled instances.</li>
<li><code><a href="#TriTraining.predict">predict</a></code> : Predict the class for each instance.</li>
<li><code><a href="#TriTraining.predict_proba">predict_proba</a></code>: Predict the probability for each class.</li>
<li><code><a href="#TriTraining.score">score</a></code>: Return the mean accuracy on the given test data and labels.</li>
</ul>

<h2 id="references"><strong>References</strong></h2>

<p>Zhi-Hua Zhou and Ming Li,<br>
Tri-training: exploiting unlabeled data using three classifiers,<br>
in <i>IEEE Transactions on Knowledge and Data Engineering</i>,<br>
vol. 17, no. 11, pp. 1529-1541, Nov. 2005,<br>
<a href="https://doi.org/10.1109/TKDE.2005.186">10.1109/TKDE.2005.186</a></p>
</div>


                            <div id="TriTraining.__init__" class="classattr">
                                        <input id="TriTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TriTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="TriTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TriTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TriTraining.__init__-54"><a href="#TriTraining.__init__-54"><span class="linenos">54</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="TriTraining.__init__-55"><a href="#TriTraining.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TriTraining.__init__-56"><a href="#TriTraining.__init__-56"><span class="linenos">56</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="TriTraining.__init__-57"><a href="#TriTraining.__init__-57"><span class="linenos">57</span></a>        <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining.__init__-58"><a href="#TriTraining.__init__-58"><span class="linenos">58</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining.__init__-59"><a href="#TriTraining.__init__-59"><span class="linenos">59</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining.__init__-60"><a href="#TriTraining.__init__-60"><span class="linenos">60</span></a>    <span class="p">):</span>
</span><span id="TriTraining.__init__-61"><a href="#TriTraining.__init__-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;TriTraining. Trio of classifiers with bootstrapping.</span>
</span><span id="TriTraining.__init__-62"><a href="#TriTraining.__init__-62"><span class="linenos">62</span></a>
</span><span id="TriTraining.__init__-63"><a href="#TriTraining.__init__-63"><span class="linenos">63</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining.__init__-64"><a href="#TriTraining.__init__-64"><span class="linenos">64</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining.__init__-65"><a href="#TriTraining.__init__-65"><span class="linenos">65</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="TriTraining.__init__-66"><a href="#TriTraining.__init__-66"><span class="linenos">66</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="TriTraining.__init__-67"><a href="#TriTraining.__init__-67"><span class="linenos">67</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="TriTraining.__init__-68"><a href="#TriTraining.__init__-68"><span class="linenos">68</span></a><span class="sd">            Number of samples to generate.</span>
</span><span id="TriTraining.__init__-69"><a href="#TriTraining.__init__-69"><span class="linenos">69</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="TriTraining.__init__-70"><a href="#TriTraining.__init__-70"><span class="linenos">70</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="TriTraining.__init__-71"><a href="#TriTraining.__init__-71"><span class="linenos">71</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="TriTraining.__init__-72"><a href="#TriTraining.__init__-72"><span class="linenos">72</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="TriTraining.__init__-73"><a href="#TriTraining.__init__-73"><span class="linenos">73</span></a><span class="sd">            The number of jobs to run in parallel for both `fit` and `predict`.</span>
</span><span id="TriTraining.__init__-74"><a href="#TriTraining.__init__-74"><span class="linenos">74</span></a><span class="sd">            `None` means 1 unless in a :obj:`joblib.parallel_backend` context.</span>
</span><span id="TriTraining.__init__-75"><a href="#TriTraining.__init__-75"><span class="linenos">75</span></a><span class="sd">            `-1` means using all processors., by default None</span>
</span><span id="TriTraining.__init__-76"><a href="#TriTraining.__init__-76"><span class="linenos">76</span></a><span class="sd">       </span>
</span><span id="TriTraining.__init__-77"><a href="#TriTraining.__init__-77"><span class="linenos">77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining.__init__-78"><a href="#TriTraining.__init__-78"><span class="linenos">78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="TriTraining.__init__-79"><a href="#TriTraining.__init__-79"><span class="linenos">79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">collection_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining.__init__-80"><a href="#TriTraining.__init__-80"><span class="linenos">80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">=</span> <span class="n">n_samples</span>
</span><span id="TriTraining.__init__-81"><a href="#TriTraining.__init__-81"><span class="linenos">81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
</span><span id="TriTraining.__init__-82"><a href="#TriTraining.__init__-82"><span class="linenos">82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="TriTraining.__init__-83"><a href="#TriTraining.__init__-83"><span class="linenos">83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span></pre></div>


            <div class="docstring"><p>TriTraining. Trio of classifiers with bootstrapping.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>n_samples</strong> (int, optional):
Number of samples to generate.
If left to None this is automatically set to the first dimension of the arrays., by default None</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
<li><strong>n_jobs</strong> (int, optional):
The number of jobs to run in parallel for both <code><a href="#TriTraining.fit">fit</a></code> and <code><a href="#TriTraining.predict">predict</a></code>.
<code>None</code> means 1 unless in a <code>joblib.parallel_backend</code> context.
<code>-1</code> means using all processors., by default None</li>
</ul>
</div>


                            </div>
                            <div id="TriTraining.fit" class="classattr">
                                        <input id="TriTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TriTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TriTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TriTraining.fit-85"><a href="#TriTraining.fit-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="TriTraining.fit-86"><a href="#TriTraining.fit-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a TriTraining classifier from the training set (X, y).</span>
</span><span id="TriTraining.fit-87"><a href="#TriTraining.fit-87"><span class="linenos"> 87</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining.fit-88"><a href="#TriTraining.fit-88"><span class="linenos"> 88</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining.fit-89"><a href="#TriTraining.fit-89"><span class="linenos"> 89</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="TriTraining.fit-90"><a href="#TriTraining.fit-90"><span class="linenos"> 90</span></a><span class="sd">            The training input samples.</span>
</span><span id="TriTraining.fit-91"><a href="#TriTraining.fit-91"><span class="linenos"> 91</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="TriTraining.fit-92"><a href="#TriTraining.fit-92"><span class="linenos"> 92</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="TriTraining.fit-93"><a href="#TriTraining.fit-93"><span class="linenos"> 93</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining.fit-94"><a href="#TriTraining.fit-94"><span class="linenos"> 94</span></a><span class="sd">        -------</span>
</span><span id="TriTraining.fit-95"><a href="#TriTraining.fit-95"><span class="linenos"> 95</span></a><span class="sd">        self : TriTraining</span>
</span><span id="TriTraining.fit-96"><a href="#TriTraining.fit-96"><span class="linenos"> 96</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="TriTraining.fit-97"><a href="#TriTraining.fit-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining.fit-98"><a href="#TriTraining.fit-98"><span class="linenos"> 98</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="TriTraining.fit-99"><a href="#TriTraining.fit-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining.fit-100"><a href="#TriTraining.fit-100"><span class="linenos">100</span></a>
</span><span id="TriTraining.fit-101"><a href="#TriTraining.fit-101"><span class="linenos">101</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="TriTraining.fit-102"><a href="#TriTraining.fit-102"><span class="linenos">102</span></a>
</span><span id="TriTraining.fit-103"><a href="#TriTraining.fit-103"><span class="linenos">103</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="TriTraining.fit-104"><a href="#TriTraining.fit-104"><span class="linenos">104</span></a>
</span><span id="TriTraining.fit-105"><a href="#TriTraining.fit-105"><span class="linenos">105</span></a>        <span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining.fit-106"><a href="#TriTraining.fit-106"><span class="linenos">106</span></a>        <span class="n">e_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-107"><a href="#TriTraining.fit-107"><span class="linenos">107</span></a>        <span class="n">l_</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-108"><a href="#TriTraining.fit-108"><span class="linenos">108</span></a>
</span><span id="TriTraining.fit-109"><a href="#TriTraining.fit-109"><span class="linenos">109</span></a>        <span class="c1"># Get a random instance for each class to keep class index</span>
</span><span id="TriTraining.fit-110"><a href="#TriTraining.fit-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining.fit-111"><a href="#TriTraining.fit-111"><span class="linenos">111</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="TriTraining.fit-112"><a href="#TriTraining.fit-112"><span class="linenos">112</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="TriTraining.fit-113"><a href="#TriTraining.fit-113"><span class="linenos">113</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="TriTraining.fit-114"><a href="#TriTraining.fit-114"><span class="linenos">114</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining.fit-115"><a href="#TriTraining.fit-115"><span class="linenos">115</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining.fit-116"><a href="#TriTraining.fit-116"><span class="linenos">116</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining.fit-117"><a href="#TriTraining.fit-117"><span class="linenos">117</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="TriTraining.fit-118"><a href="#TriTraining.fit-118"><span class="linenos">118</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="TriTraining.fit-119"><a href="#TriTraining.fit-119"><span class="linenos">119</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="TriTraining.fit-120"><a href="#TriTraining.fit-120"><span class="linenos">120</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="TriTraining.fit-121"><a href="#TriTraining.fit-121"><span class="linenos">121</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="TriTraining.fit-122"><a href="#TriTraining.fit-122"><span class="linenos">122</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TriTraining.fit-123"><a href="#TriTraining.fit-123"><span class="linenos">123</span></a>                <span class="k">break</span>
</span><span id="TriTraining.fit-124"><a href="#TriTraining.fit-124"><span class="linenos">124</span></a>
</span><span id="TriTraining.fit-125"><a href="#TriTraining.fit-125"><span class="linenos">125</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining.fit-126"><a href="#TriTraining.fit-126"><span class="linenos">126</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="TriTraining.fit-127"><a href="#TriTraining.fit-127"><span class="linenos">127</span></a>                <span class="n">X_label</span><span class="p">,</span>
</span><span id="TriTraining.fit-128"><a href="#TriTraining.fit-128"><span class="linenos">128</span></a>                <span class="n">y_label</span><span class="p">,</span>
</span><span id="TriTraining.fit-129"><a href="#TriTraining.fit-129"><span class="linenos">129</span></a>                <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="TriTraining.fit-130"><a href="#TriTraining.fit-130"><span class="linenos">130</span></a>                <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="TriTraining.fit-131"><a href="#TriTraining.fit-131"><span class="linenos">131</span></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="TriTraining.fit-132"><a href="#TriTraining.fit-132"><span class="linenos">132</span></a>            <span class="p">)</span>
</span><span id="TriTraining.fit-133"><a href="#TriTraining.fit-133"><span class="linenos">133</span></a>
</span><span id="TriTraining.fit-134"><a href="#TriTraining.fit-134"><span class="linenos">134</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining.fit-135"><a href="#TriTraining.fit-135"><span class="linenos">135</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="TriTraining.fit-136"><a href="#TriTraining.fit-136"><span class="linenos">136</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">])</span>
</span><span id="TriTraining.fit-137"><a href="#TriTraining.fit-137"><span class="linenos">137</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TriTraining.fit-138"><a href="#TriTraining.fit-138"><span class="linenos">138</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TriTraining.fit-139"><a href="#TriTraining.fit-139"><span class="linenos">139</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TriTraining.fit-140"><a href="#TriTraining.fit-140"><span class="linenos">140</span></a>
</span><span id="TriTraining.fit-141"><a href="#TriTraining.fit-141"><span class="linenos">141</span></a>            <span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="TriTraining.fit-142"><a href="#TriTraining.fit-142"><span class="linenos">142</span></a>                <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="TriTraining.fit-143"><a href="#TriTraining.fit-143"><span class="linenos">143</span></a>            <span class="p">)</span>
</span><span id="TriTraining.fit-144"><a href="#TriTraining.fit-144"><span class="linenos">144</span></a>
</span><span id="TriTraining.fit-145"><a href="#TriTraining.fit-145"><span class="linenos">145</span></a>        <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="TriTraining.fit-146"><a href="#TriTraining.fit-146"><span class="linenos">146</span></a>        <span class="k">while</span> <span class="n">something_has_changed</span><span class="p">:</span>
</span><span id="TriTraining.fit-147"><a href="#TriTraining.fit-147"><span class="linenos">147</span></a>            <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TriTraining.fit-148"><a href="#TriTraining.fit-148"><span class="linenos">148</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-149"><a href="#TriTraining.fit-149"><span class="linenos">149</span></a>            <span class="n">Ly</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-150"><a href="#TriTraining.fit-150"><span class="linenos">150</span></a>            <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining.fit-151"><a href="#TriTraining.fit-151"><span class="linenos">151</span></a>            <span class="n">updates</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="TriTraining.fit-152"><a href="#TriTraining.fit-152"><span class="linenos">152</span></a>
</span><span id="TriTraining.fit-153"><a href="#TriTraining.fit-153"><span class="linenos">153</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining.fit-154"><a href="#TriTraining.fit-154"><span class="linenos">154</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="TriTraining.fit-155"><a href="#TriTraining.fit-155"><span class="linenos">155</span></a>                <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="TriTraining.fit-156"><a href="#TriTraining.fit-156"><span class="linenos">156</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_measure_error</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span>
</span><span id="TriTraining.fit-157"><a href="#TriTraining.fit-157"><span class="linenos">157</span></a>                <span class="p">)</span>
</span><span id="TriTraining.fit-158"><a href="#TriTraining.fit-158"><span class="linenos">158</span></a>                <span class="k">if</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining.fit-159"><a href="#TriTraining.fit-159"><span class="linenos">159</span></a>                    <span class="k">continue</span>
</span><span id="TriTraining.fit-160"><a href="#TriTraining.fit-160"><span class="linenos">160</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="TriTraining.fit-161"><a href="#TriTraining.fit-161"><span class="linenos">161</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="TriTraining.fit-162"><a href="#TriTraining.fit-162"><span class="linenos">162</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="TriTraining.fit-163"><a href="#TriTraining.fit-163"><span class="linenos">163</span></a>                <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="TriTraining.fit-164"><a href="#TriTraining.fit-164"><span class="linenos">164</span></a>
</span><span id="TriTraining.fit-165"><a href="#TriTraining.fit-165"><span class="linenos">165</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TriTraining.fit-166"><a href="#TriTraining.fit-166"><span class="linenos">166</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
</span><span id="TriTraining.fit-167"><a href="#TriTraining.fit-167"><span class="linenos">167</span></a>                        <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="TriTraining.fit-168"><a href="#TriTraining.fit-168"><span class="linenos">168</span></a>                    <span class="p">)</span>
</span><span id="TriTraining.fit-169"><a href="#TriTraining.fit-169"><span class="linenos">169</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="TriTraining.fit-170"><a href="#TriTraining.fit-170"><span class="linenos">170</span></a>                    <span class="k">continue</span>
</span><span id="TriTraining.fit-171"><a href="#TriTraining.fit-171"><span class="linenos">171</span></a>                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining.fit-172"><a href="#TriTraining.fit-172"><span class="linenos">172</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining.fit-173"><a href="#TriTraining.fit-173"><span class="linenos">173</span></a>                <span class="k">elif</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">):</span>
</span><span id="TriTraining.fit-174"><a href="#TriTraining.fit-174"><span class="linenos">174</span></a>                    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_subsample</span><span class="p">(</span>
</span><span id="TriTraining.fit-175"><a href="#TriTraining.fit-175"><span class="linenos">175</span></a>                        <span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="TriTraining.fit-176"><a href="#TriTraining.fit-176"><span class="linenos">176</span></a>                        <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
</span><span id="TriTraining.fit-177"><a href="#TriTraining.fit-177"><span class="linenos">177</span></a>                            <span class="n">safe_division</span><span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="TriTraining.fit-178"><a href="#TriTraining.fit-178"><span class="linenos">178</span></a>                        <span class="p">),</span>
</span><span id="TriTraining.fit-179"><a href="#TriTraining.fit-179"><span class="linenos">179</span></a>                        <span class="n">random_state</span><span class="p">,</span>
</span><span id="TriTraining.fit-180"><a href="#TriTraining.fit-180"><span class="linenos">180</span></a>                    <span class="p">)</span>
</span><span id="TriTraining.fit-181"><a href="#TriTraining.fit-181"><span class="linenos">181</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining.fit-182"><a href="#TriTraining.fit-182"><span class="linenos">182</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="TriTraining.fit-183"><a href="#TriTraining.fit-183"><span class="linenos">183</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining.fit-184"><a href="#TriTraining.fit-184"><span class="linenos">184</span></a>
</span><span id="TriTraining.fit-185"><a href="#TriTraining.fit-185"><span class="linenos">185</span></a>            <span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="TriTraining.fit-186"><a href="#TriTraining.fit-186"><span class="linenos">186</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span>
</span><span id="TriTraining.fit-187"><a href="#TriTraining.fit-187"><span class="linenos">187</span></a>                    <span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span>
</span><span id="TriTraining.fit-188"><a href="#TriTraining.fit-188"><span class="linenos">188</span></a>                <span class="p">)</span>
</span><span id="TriTraining.fit-189"><a href="#TriTraining.fit-189"><span class="linenos">189</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining.fit-190"><a href="#TriTraining.fit-190"><span class="linenos">190</span></a>            <span class="p">)</span>
</span><span id="TriTraining.fit-191"><a href="#TriTraining.fit-191"><span class="linenos">191</span></a>
</span><span id="TriTraining.fit-192"><a href="#TriTraining.fit-192"><span class="linenos">192</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining.fit-193"><a href="#TriTraining.fit-193"><span class="linenos">193</span></a>                <span class="k">if</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining.fit-194"><a href="#TriTraining.fit-194"><span class="linenos">194</span></a>                    <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="TriTraining.fit-195"><a href="#TriTraining.fit-195"><span class="linenos">195</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="TriTraining.fit-196"><a href="#TriTraining.fit-196"><span class="linenos">196</span></a>                    <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining.fit-197"><a href="#TriTraining.fit-197"><span class="linenos">197</span></a>
</span><span id="TriTraining.fit-198"><a href="#TriTraining.fit-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">hypotheses</span>
</span><span id="TriTraining.fit-199"><a href="#TriTraining.fit-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-200"><a href="#TriTraining.fit-200"><span class="linenos">200</span></a>
</span><span id="TriTraining.fit-201"><a href="#TriTraining.fit-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a TriTraining classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabeled.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (TriTraining):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="TriTraining.predict_proba" class="function">predict_proba</dd>
                <dd id="TriTraining.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="TriTraining.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="TriTraining.get_params" class="function">get_params</dd>
                <dd id="TriTraining.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="DeTriTraining">
                            <input id="DeTriTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DeTriTraining</span><wbr>(<span class="base"><a href="#TriTraining">sslearn.wrapper.TriTraining</a></span>):

                <label class="view-source-button" for="DeTriTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeTriTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeTriTraining-557"><a href="#DeTriTraining-557"><span class="linenos">557</span></a><span class="k">class</span> <span class="nc">DeTriTraining</span><span class="p">(</span><span class="n">TriTraining</span><span class="p">):</span>
</span><span id="DeTriTraining-558"><a href="#DeTriTraining-558"><span class="linenos">558</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DeTriTraining-559"><a href="#DeTriTraining-559"><span class="linenos">559</span></a><span class="sd">    **TriTraining with Data Editing.**</span>
</span><span id="DeTriTraining-560"><a href="#DeTriTraining-560"><span class="linenos">560</span></a>
</span><span id="DeTriTraining-561"><a href="#DeTriTraining-561"><span class="linenos">561</span></a><span class="sd">    It is a variation of the TriTraining, the main difference is that the instances are depurated in each iteration.</span>
</span><span id="DeTriTraining-562"><a href="#DeTriTraining-562"><span class="linenos">562</span></a><span class="sd">    It means that the instances with their neighbors that have the same class are kept, the rest are removed.</span>
</span><span id="DeTriTraining-563"><a href="#DeTriTraining-563"><span class="linenos">563</span></a><span class="sd">    At the end of the iterations, the instances are clustered and the class is assigned to the cluster centroid.</span>
</span><span id="DeTriTraining-564"><a href="#DeTriTraining-564"><span class="linenos">564</span></a>
</span><span id="DeTriTraining-565"><a href="#DeTriTraining-565"><span class="linenos">565</span></a><span class="sd">    **Methods**</span>
</span><span id="DeTriTraining-566"><a href="#DeTriTraining-566"><span class="linenos">566</span></a><span class="sd">    -------</span>
</span><span id="DeTriTraining-567"><a href="#DeTriTraining-567"><span class="linenos">567</span></a><span class="sd">    - `fit`: Fit the model with the labeled instances.</span>
</span><span id="DeTriTraining-568"><a href="#DeTriTraining-568"><span class="linenos">568</span></a><span class="sd">    - `predict` : Predict the class for each instance.</span>
</span><span id="DeTriTraining-569"><a href="#DeTriTraining-569"><span class="linenos">569</span></a><span class="sd">    - `predict_proba`: Predict the probability for each class.</span>
</span><span id="DeTriTraining-570"><a href="#DeTriTraining-570"><span class="linenos">570</span></a><span class="sd">    - `score`: Return the mean accuracy on the given test data and labels.</span>
</span><span id="DeTriTraining-571"><a href="#DeTriTraining-571"><span class="linenos">571</span></a>
</span><span id="DeTriTraining-572"><a href="#DeTriTraining-572"><span class="linenos">572</span></a><span class="sd">    **References**</span>
</span><span id="DeTriTraining-573"><a href="#DeTriTraining-573"><span class="linenos">573</span></a><span class="sd">    ----------</span>
</span><span id="DeTriTraining-574"><a href="#DeTriTraining-574"><span class="linenos">574</span></a><span class="sd">    Deng C., Guo M.Z. (2006)&lt;br&gt;</span>
</span><span id="DeTriTraining-575"><a href="#DeTriTraining-575"><span class="linenos">575</span></a><span class="sd">    Tri-training and Data Editing Based Semi-supervised Clustering Algorithm, &lt;br&gt;</span>
</span><span id="DeTriTraining-576"><a href="#DeTriTraining-576"><span class="linenos">576</span></a><span class="sd">    in &lt;i&gt;Gelbukh A., Reyes-Garcia C.A. (eds) MICAI 2006: Advances in Artificial Intelligence. MICAI 2006.&lt;/i&gt;&lt;br&gt;</span>
</span><span id="DeTriTraining-577"><a href="#DeTriTraining-577"><span class="linenos">577</span></a><span class="sd">    Lecture Notes in Computer Science, vol 4293. Springer, Berlin, Heidelberg.&lt;br&gt;</span>
</span><span id="DeTriTraining-578"><a href="#DeTriTraining-578"><span class="linenos">578</span></a><span class="sd">    [10.1007/11925231_61](https://doi.org/10.1007/11925231_61)</span>
</span><span id="DeTriTraining-579"><a href="#DeTriTraining-579"><span class="linenos">579</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-580"><a href="#DeTriTraining-580"><span class="linenos">580</span></a>
</span><span id="DeTriTraining-581"><a href="#DeTriTraining-581"><span class="linenos">581</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="DeTriTraining-582"><a href="#DeTriTraining-582"><span class="linenos">582</span></a>                 <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;seeded&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DeTriTraining-583"><a href="#DeTriTraining-583"><span class="linenos">583</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DeTriTraining-584"><a href="#DeTriTraining-584"><span class="linenos">584</span></a><span class="sd">        DeTriTraining - TriTraining with Depurated and Clustering.</span>
</span><span id="DeTriTraining-585"><a href="#DeTriTraining-585"><span class="linenos">585</span></a><span class="sd">        Avoid the noise generated by the TriTraining algorithm by depurating the enlarged dataset and clustering the instances.        </span>
</span><span id="DeTriTraining-586"><a href="#DeTriTraining-586"><span class="linenos">586</span></a>
</span><span id="DeTriTraining-587"><a href="#DeTriTraining-587"><span class="linenos">587</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining-588"><a href="#DeTriTraining-588"><span class="linenos">588</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-589"><a href="#DeTriTraining-589"><span class="linenos">589</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="DeTriTraining-590"><a href="#DeTriTraining-590"><span class="linenos">590</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="DeTriTraining-591"><a href="#DeTriTraining-591"><span class="linenos">591</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="DeTriTraining-592"><a href="#DeTriTraining-592"><span class="linenos">592</span></a><span class="sd">            Number of samples to generate. </span>
</span><span id="DeTriTraining-593"><a href="#DeTriTraining-593"><span class="linenos">593</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="DeTriTraining-594"><a href="#DeTriTraining-594"><span class="linenos">594</span></a><span class="sd">        k_neighbors : int, optional</span>
</span><span id="DeTriTraining-595"><a href="#DeTriTraining-595"><span class="linenos">595</span></a><span class="sd">            Number of neighbors for depurate classification. </span>
</span><span id="DeTriTraining-596"><a href="#DeTriTraining-596"><span class="linenos">596</span></a><span class="sd">            If at least k_neighbors/2+1 have a class other than the one predicted, the class is ignored., by default 3</span>
</span><span id="DeTriTraining-597"><a href="#DeTriTraining-597"><span class="linenos">597</span></a><span class="sd">        mode : string, optional</span>
</span><span id="DeTriTraining-598"><a href="#DeTriTraining-598"><span class="linenos">598</span></a><span class="sd">            How to calculate the cluster each instance belongs to.</span>
</span><span id="DeTriTraining-599"><a href="#DeTriTraining-599"><span class="linenos">599</span></a><span class="sd">            If `seeded` each instance belong to nearest cluster.</span>
</span><span id="DeTriTraining-600"><a href="#DeTriTraining-600"><span class="linenos">600</span></a><span class="sd">            If `constrained` each instance belong to nearest cluster unless the instance is in to enlarged dataset, </span>
</span><span id="DeTriTraining-601"><a href="#DeTriTraining-601"><span class="linenos">601</span></a><span class="sd">            then the instance belongs to the cluster of its class., by default `seeded`</span>
</span><span id="DeTriTraining-602"><a href="#DeTriTraining-602"><span class="linenos">602</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="DeTriTraining-603"><a href="#DeTriTraining-603"><span class="linenos">603</span></a><span class="sd">            Maximum number of iterations, by default 100</span>
</span><span id="DeTriTraining-604"><a href="#DeTriTraining-604"><span class="linenos">604</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="DeTriTraining-605"><a href="#DeTriTraining-605"><span class="linenos">605</span></a><span class="sd">            The number of parallel jobs to run for neighbors search. </span>
</span><span id="DeTriTraining-606"><a href="#DeTriTraining-606"><span class="linenos">606</span></a><span class="sd">            None means 1 unless in a joblib.parallel_backend context. -1 means using all processors. </span>
</span><span id="DeTriTraining-607"><a href="#DeTriTraining-607"><span class="linenos">607</span></a><span class="sd">            Doesn&#39;t affect fit method., by default None</span>
</span><span id="DeTriTraining-608"><a href="#DeTriTraining-608"><span class="linenos">608</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="DeTriTraining-609"><a href="#DeTriTraining-609"><span class="linenos">609</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="DeTriTraining-610"><a href="#DeTriTraining-610"><span class="linenos">610</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-611"><a href="#DeTriTraining-611"><span class="linenos">611</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="DeTriTraining-612"><a href="#DeTriTraining-612"><span class="linenos">612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k_neighbors</span> <span class="o">=</span> <span class="n">k_neighbors</span>
</span><span id="DeTriTraining-613"><a href="#DeTriTraining-613"><span class="linenos">613</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
</span><span id="DeTriTraining-614"><a href="#DeTriTraining-614"><span class="linenos">614</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="DeTriTraining-615"><a href="#DeTriTraining-615"><span class="linenos">615</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="DeTriTraining-616"><a href="#DeTriTraining-616"><span class="linenos">616</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;seeded&quot;</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">:</span>
</span><span id="DeTriTraining-617"><a href="#DeTriTraining-617"><span class="linenos">617</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;`mode` must be </span><span class="se">\&quot;</span><span class="s2">seeded</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">constrained</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="DeTriTraining-618"><a href="#DeTriTraining-618"><span class="linenos">618</span></a>
</span><span id="DeTriTraining-619"><a href="#DeTriTraining-619"><span class="linenos">619</span></a>    <span class="k">def</span> <span class="nf">_depure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="p">):</span>
</span><span id="DeTriTraining-620"><a href="#DeTriTraining-620"><span class="linenos">620</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Depure the S dataset</span>
</span><span id="DeTriTraining-621"><a href="#DeTriTraining-621"><span class="linenos">621</span></a>
</span><span id="DeTriTraining-622"><a href="#DeTriTraining-622"><span class="linenos">622</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining-623"><a href="#DeTriTraining-623"><span class="linenos">623</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-624"><a href="#DeTriTraining-624"><span class="linenos">624</span></a><span class="sd">        S : tuple (X, y)</span>
</span><span id="DeTriTraining-625"><a href="#DeTriTraining-625"><span class="linenos">625</span></a><span class="sd">            Enlarged dataset</span>
</span><span id="DeTriTraining-626"><a href="#DeTriTraining-626"><span class="linenos">626</span></a>
</span><span id="DeTriTraining-627"><a href="#DeTriTraining-627"><span class="linenos">627</span></a><span class="sd">        Returns</span>
</span><span id="DeTriTraining-628"><a href="#DeTriTraining-628"><span class="linenos">628</span></a><span class="sd">        -------</span>
</span><span id="DeTriTraining-629"><a href="#DeTriTraining-629"><span class="linenos">629</span></a><span class="sd">        tuple : (X, y)</span>
</span><span id="DeTriTraining-630"><a href="#DeTriTraining-630"><span class="linenos">630</span></a><span class="sd">            Enlarged dataset with instances where at least k_neighbors/2+1 have the same class.</span>
</span><span id="DeTriTraining-631"><a href="#DeTriTraining-631"><span class="linenos">631</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-632"><a href="#DeTriTraining-632"><span class="linenos">632</span></a>        <span class="n">init</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DeTriTraining-633"><a href="#DeTriTraining-633"><span class="linenos">633</span></a>        <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k_neighbors</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="DeTriTraining-634"><a href="#DeTriTraining-634"><span class="linenos">634</span></a>        <span class="n">valid</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DeTriTraining-635"><a href="#DeTriTraining-635"><span class="linenos">635</span></a>        <span class="c1">#print(f&quot;Depure time: {time.time() - init}&quot;)</span>
</span><span id="DeTriTraining-636"><a href="#DeTriTraining-636"><span class="linenos">636</span></a>        <span class="k">return</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">valid</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">valid</span><span class="p">]</span>
</span><span id="DeTriTraining-637"><a href="#DeTriTraining-637"><span class="linenos">637</span></a>
</span><span id="DeTriTraining-638"><a href="#DeTriTraining-638"><span class="linenos">638</span></a>    <span class="k">def</span> <span class="nf">_clustering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DeTriTraining-639"><a href="#DeTriTraining-639"><span class="linenos">639</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clustering phase of the fitting</span>
</span><span id="DeTriTraining-640"><a href="#DeTriTraining-640"><span class="linenos">640</span></a>
</span><span id="DeTriTraining-641"><a href="#DeTriTraining-641"><span class="linenos">641</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining-642"><a href="#DeTriTraining-642"><span class="linenos">642</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-643"><a href="#DeTriTraining-643"><span class="linenos">643</span></a><span class="sd">        S : tuple (X, y)</span>
</span><span id="DeTriTraining-644"><a href="#DeTriTraining-644"><span class="linenos">644</span></a><span class="sd">            Enlarged dataset</span>
</span><span id="DeTriTraining-645"><a href="#DeTriTraining-645"><span class="linenos">645</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DeTriTraining-646"><a href="#DeTriTraining-646"><span class="linenos">646</span></a><span class="sd">            Complete dataset, only features</span>
</span><span id="DeTriTraining-647"><a href="#DeTriTraining-647"><span class="linenos">647</span></a>
</span><span id="DeTriTraining-648"><a href="#DeTriTraining-648"><span class="linenos">648</span></a><span class="sd">        Returns</span>
</span><span id="DeTriTraining-649"><a href="#DeTriTraining-649"><span class="linenos">649</span></a><span class="sd">        -------</span>
</span><span id="DeTriTraining-650"><a href="#DeTriTraining-650"><span class="linenos">650</span></a><span class="sd">        y: array-like of shape (n_samples,)</span>
</span><span id="DeTriTraining-651"><a href="#DeTriTraining-651"><span class="linenos">651</span></a><span class="sd">            class predicted for each instance</span>
</span><span id="DeTriTraining-652"><a href="#DeTriTraining-652"><span class="linenos">652</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-653"><a href="#DeTriTraining-653"><span class="linenos">653</span></a>        <span class="n">centroids</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="DeTriTraining-654"><a href="#DeTriTraining-654"><span class="linenos">654</span></a>        <span class="n">clusters</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="DeTriTraining-655"><a href="#DeTriTraining-655"><span class="linenos">655</span></a>
</span><span id="DeTriTraining-656"><a href="#DeTriTraining-656"><span class="linenos">656</span></a>        <span class="c1"># uses as numpy</span>
</span><span id="DeTriTraining-657"><a href="#DeTriTraining-657"><span class="linenos">657</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="DeTriTraining-658"><a href="#DeTriTraining-658"><span class="linenos">658</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="DeTriTraining-659"><a href="#DeTriTraining-659"><span class="linenos">659</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="DeTriTraining-660"><a href="#DeTriTraining-660"><span class="linenos">660</span></a>            <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="DeTriTraining-661"><a href="#DeTriTraining-661"><span class="linenos">661</span></a>
</span><span id="DeTriTraining-662"><a href="#DeTriTraining-662"><span class="linenos">662</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
</span><span id="DeTriTraining-663"><a href="#DeTriTraining-663"><span class="linenos">663</span></a>            <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-664"><a href="#DeTriTraining-664"><span class="linenos">664</span></a>
</span><span id="DeTriTraining-665"><a href="#DeTriTraining-665"><span class="linenos">665</span></a>        <span class="k">def</span> <span class="nf">seeded</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
</span><span id="DeTriTraining-666"><a href="#DeTriTraining-666"><span class="linenos">666</span></a>            <span class="c1"># For each instance, calculate the distance to each centroid</span>
</span><span id="DeTriTraining-667"><a href="#DeTriTraining-667"><span class="linenos">667</span></a>            <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DeTriTraining-668"><a href="#DeTriTraining-668"><span class="linenos">668</span></a>            <span class="c1"># Get the index of the nearest centroid</span>
</span><span id="DeTriTraining-669"><a href="#DeTriTraining-669"><span class="linenos">669</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DeTriTraining-670"><a href="#DeTriTraining-670"><span class="linenos">670</span></a>
</span><span id="DeTriTraining-671"><a href="#DeTriTraining-671"><span class="linenos">671</span></a>        <span class="k">def</span> <span class="nf">constrained</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
</span><span id="DeTriTraining-672"><a href="#DeTriTraining-672"><span class="linenos">672</span></a>            <span class="c1"># Calculate the distances to centroids using broadcasting</span>
</span><span id="DeTriTraining-673"><a href="#DeTriTraining-673"><span class="linenos">673</span></a>            <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DeTriTraining-674"><a href="#DeTriTraining-674"><span class="linenos">674</span></a>            <span class="c1"># Get the index of the nearest centroid</span>
</span><span id="DeTriTraining-675"><a href="#DeTriTraining-675"><span class="linenos">675</span></a>            <span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DeTriTraining-676"><a href="#DeTriTraining-676"><span class="linenos">676</span></a>            <span class="c1"># Create a mask to find instances in X that belong to S[0]</span>
</span><span id="DeTriTraining-677"><a href="#DeTriTraining-677"><span class="linenos">677</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">X</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
</span><span id="DeTriTraining-678"><a href="#DeTriTraining-678"><span class="linenos">678</span></a>            <span class="c1"># Find the row and column indices where all elements are True</span>
</span><span id="DeTriTraining-679"><a href="#DeTriTraining-679"><span class="linenos">679</span></a>            <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</span><span id="DeTriTraining-680"><a href="#DeTriTraining-680"><span class="linenos">680</span></a>            <span class="c1"># Initialize cluster with -1</span>
</span><span id="DeTriTraining-681"><a href="#DeTriTraining-681"><span class="linenos">681</span></a>            <span class="n">cluster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DeTriTraining-682"><a href="#DeTriTraining-682"><span class="linenos">682</span></a>            <span class="c1"># Update cluster for the instances found in S[0]</span>
</span><span id="DeTriTraining-683"><a href="#DeTriTraining-683"><span class="linenos">683</span></a>            <span class="n">cluster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</span><span id="DeTriTraining-684"><a href="#DeTriTraining-684"><span class="linenos">684</span></a>            <span class="c1"># Update cluster for instances not found in S[0]</span>
</span><span id="DeTriTraining-685"><a href="#DeTriTraining-685"><span class="linenos">685</span></a>            <span class="n">cluster</span><span class="p">[</span><span class="n">cluster</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">nearest</span><span class="p">[</span><span class="n">cluster</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DeTriTraining-686"><a href="#DeTriTraining-686"><span class="linenos">686</span></a>
</span><span id="DeTriTraining-687"><a href="#DeTriTraining-687"><span class="linenos">687</span></a>            <span class="k">return</span> <span class="n">cluster</span>
</span><span id="DeTriTraining-688"><a href="#DeTriTraining-688"><span class="linenos">688</span></a>
</span><span id="DeTriTraining-689"><a href="#DeTriTraining-689"><span class="linenos">689</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;seeded&quot;</span><span class="p">:</span>
</span><span id="DeTriTraining-690"><a href="#DeTriTraining-690"><span class="linenos">690</span></a>            <span class="n">op</span> <span class="o">=</span> <span class="n">seeded</span>
</span><span id="DeTriTraining-691"><a href="#DeTriTraining-691"><span class="linenos">691</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;constrained&quot;</span><span class="p">:</span>
</span><span id="DeTriTraining-692"><a href="#DeTriTraining-692"><span class="linenos">692</span></a>            <span class="n">op</span> <span class="o">=</span> <span class="n">constrained</span>
</span><span id="DeTriTraining-693"><a href="#DeTriTraining-693"><span class="linenos">693</span></a>
</span><span id="DeTriTraining-694"><a href="#DeTriTraining-694"><span class="linenos">694</span></a>        <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining-695"><a href="#DeTriTraining-695"><span class="linenos">695</span></a>        <span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DeTriTraining-696"><a href="#DeTriTraining-696"><span class="linenos">696</span></a>        <span class="k">while</span> <span class="n">changes</span> <span class="ow">and</span> <span class="n">iterations</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">:</span>
</span><span id="DeTriTraining-697"><a href="#DeTriTraining-697"><span class="linenos">697</span></a>            <span class="n">changes</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DeTriTraining-698"><a href="#DeTriTraining-698"><span class="linenos">698</span></a>            <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DeTriTraining-699"><a href="#DeTriTraining-699"><span class="linenos">699</span></a>            <span class="c1"># Need to vectorize</span>
</span><span id="DeTriTraining-700"><a href="#DeTriTraining-700"><span class="linenos">700</span></a>            <span class="n">new_clusters</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DeTriTraining-701"><a href="#DeTriTraining-701"><span class="linenos">701</span></a>            <span class="n">new_centroids</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="DeTriTraining-702"><a href="#DeTriTraining-702"><span class="linenos">702</span></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
</span><span id="DeTriTraining-703"><a href="#DeTriTraining-703"><span class="linenos">703</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">new_clusters</span> <span class="o">==</span> <span class="n">k</span><span class="p">):</span>
</span><span id="DeTriTraining-704"><a href="#DeTriTraining-704"><span class="linenos">704</span></a>                    <span class="n">new_centroids</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">new_clusters</span> <span class="o">==</span> <span class="n">k</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-705"><a href="#DeTriTraining-705"><span class="linenos">705</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">new_centroids</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
</span><span id="DeTriTraining-706"><a href="#DeTriTraining-706"><span class="linenos">706</span></a>                        <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining-707"><a href="#DeTriTraining-707"><span class="linenos">707</span></a>            <span class="n">centroids</span> <span class="o">=</span> <span class="n">new_centroids</span>
</span><span id="DeTriTraining-708"><a href="#DeTriTraining-708"><span class="linenos">708</span></a>
</span><span id="DeTriTraining-709"><a href="#DeTriTraining-709"><span class="linenos">709</span></a>        <span class="k">return</span> <span class="n">new_clusters</span>
</span><span id="DeTriTraining-710"><a href="#DeTriTraining-710"><span class="linenos">710</span></a>
</span><span id="DeTriTraining-711"><a href="#DeTriTraining-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="DeTriTraining-712"><a href="#DeTriTraining-712"><span class="linenos">712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a DeTriTraining classifier from the training set (X, y).</span>
</span><span id="DeTriTraining-713"><a href="#DeTriTraining-713"><span class="linenos">713</span></a>
</span><span id="DeTriTraining-714"><a href="#DeTriTraining-714"><span class="linenos">714</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining-715"><a href="#DeTriTraining-715"><span class="linenos">715</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-716"><a href="#DeTriTraining-716"><span class="linenos">716</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DeTriTraining-717"><a href="#DeTriTraining-717"><span class="linenos">717</span></a><span class="sd">            The training input samples.</span>
</span><span id="DeTriTraining-718"><a href="#DeTriTraining-718"><span class="linenos">718</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="DeTriTraining-719"><a href="#DeTriTraining-719"><span class="linenos">719</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="DeTriTraining-720"><a href="#DeTriTraining-720"><span class="linenos">720</span></a>
</span><span id="DeTriTraining-721"><a href="#DeTriTraining-721"><span class="linenos">721</span></a><span class="sd">        Returns</span>
</span><span id="DeTriTraining-722"><a href="#DeTriTraining-722"><span class="linenos">722</span></a><span class="sd">        -------</span>
</span><span id="DeTriTraining-723"><a href="#DeTriTraining-723"><span class="linenos">723</span></a><span class="sd">        self: DeTriTraining</span>
</span><span id="DeTriTraining-724"><a href="#DeTriTraining-724"><span class="linenos">724</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="DeTriTraining-725"><a href="#DeTriTraining-725"><span class="linenos">725</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-726"><a href="#DeTriTraining-726"><span class="linenos">726</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeTriTraining-727"><a href="#DeTriTraining-727"><span class="linenos">727</span></a>
</span><span id="DeTriTraining-728"><a href="#DeTriTraining-728"><span class="linenos">728</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="DeTriTraining-729"><a href="#DeTriTraining-729"><span class="linenos">729</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-730"><a href="#DeTriTraining-730"><span class="linenos">730</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-731"><a href="#DeTriTraining-731"><span class="linenos">731</span></a>
</span><span id="DeTriTraining-732"><a href="#DeTriTraining-732"><span class="linenos">732</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="DeTriTraining-733"><a href="#DeTriTraining-733"><span class="linenos">733</span></a>
</span><span id="DeTriTraining-734"><a href="#DeTriTraining-734"><span class="linenos">734</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-735"><a href="#DeTriTraining-735"><span class="linenos">735</span></a>
</span><span id="DeTriTraining-736"><a href="#DeTriTraining-736"><span class="linenos">736</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="DeTriTraining-737"><a href="#DeTriTraining-737"><span class="linenos">737</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DeTriTraining-738"><a href="#DeTriTraining-738"><span class="linenos">738</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DeTriTraining-739"><a href="#DeTriTraining-739"><span class="linenos">739</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-740"><a href="#DeTriTraining-740"><span class="linenos">740</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining-741"><a href="#DeTriTraining-741"><span class="linenos">741</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-742"><a href="#DeTriTraining-742"><span class="linenos">742</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="DeTriTraining-743"><a href="#DeTriTraining-743"><span class="linenos">743</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="DeTriTraining-744"><a href="#DeTriTraining-744"><span class="linenos">744</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="DeTriTraining-745"><a href="#DeTriTraining-745"><span class="linenos">745</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="DeTriTraining-746"><a href="#DeTriTraining-746"><span class="linenos">746</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="DeTriTraining-747"><a href="#DeTriTraining-747"><span class="linenos">747</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeTriTraining-748"><a href="#DeTriTraining-748"><span class="linenos">748</span></a>                <span class="k">break</span>
</span><span id="DeTriTraining-749"><a href="#DeTriTraining-749"><span class="linenos">749</span></a>
</span><span id="DeTriTraining-750"><a href="#DeTriTraining-750"><span class="linenos">750</span></a>        <span class="n">S_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DeTriTraining-751"><a href="#DeTriTraining-751"><span class="linenos">751</span></a>        <span class="n">hypothesis</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DeTriTraining-752"><a href="#DeTriTraining-752"><span class="linenos">752</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining-753"><a href="#DeTriTraining-753"><span class="linenos">753</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span> <span class="o">=</span> \
</span><span id="DeTriTraining-754"><a href="#DeTriTraining-754"><span class="linenos">754</span></a>                <span class="n">resample</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeTriTraining-755"><a href="#DeTriTraining-755"><span class="linenos">755</span></a>                         <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="DeTriTraining-756"><a href="#DeTriTraining-756"><span class="linenos">756</span></a>                         <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="DeTriTraining-757"><a href="#DeTriTraining-757"><span class="linenos">757</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining-758"><a href="#DeTriTraining-758"><span class="linenos">758</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="DeTriTraining-759"><a href="#DeTriTraining-759"><span class="linenos">759</span></a>            <span class="n">hypothesis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="DeTriTraining-760"><a href="#DeTriTraining-760"><span class="linenos">760</span></a>                <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="DeTriTraining-761"><a href="#DeTriTraining-761"><span class="linenos">761</span></a>                    <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="DeTriTraining-762"><a href="#DeTriTraining-762"><span class="linenos">762</span></a>            <span class="p">)</span>
</span><span id="DeTriTraining-763"><a href="#DeTriTraining-763"><span class="linenos">763</span></a>
</span><span id="DeTriTraining-764"><a href="#DeTriTraining-764"><span class="linenos">764</span></a>            <span class="c1"># Keep class order</span>
</span><span id="DeTriTraining-765"><a href="#DeTriTraining-765"><span class="linenos">765</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining-766"><a href="#DeTriTraining-766"><span class="linenos">766</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-767"><a href="#DeTriTraining-767"><span class="linenos">767</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DeTriTraining-768"><a href="#DeTriTraining-768"><span class="linenos">768</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-769"><a href="#DeTriTraining-769"><span class="linenos">769</span></a>
</span><span id="DeTriTraining-770"><a href="#DeTriTraining-770"><span class="linenos">770</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-771"><a href="#DeTriTraining-771"><span class="linenos">771</span></a>
</span><span id="DeTriTraining-772"><a href="#DeTriTraining-772"><span class="linenos">772</span></a>            <span class="n">S_</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">))</span>
</span><span id="DeTriTraining-773"><a href="#DeTriTraining-773"><span class="linenos">773</span></a>
</span><span id="DeTriTraining-774"><a href="#DeTriTraining-774"><span class="linenos">774</span></a>        <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining-775"><a href="#DeTriTraining-775"><span class="linenos">775</span></a>        <span class="n">last_addition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="DeTriTraining-776"><a href="#DeTriTraining-776"><span class="linenos">776</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span>
</span><span id="DeTriTraining-777"><a href="#DeTriTraining-777"><span class="linenos">777</span></a>        <span class="k">while</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">:</span>
</span><span id="DeTriTraining-778"><a href="#DeTriTraining-778"><span class="linenos">778</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DeTriTraining-779"><a href="#DeTriTraining-779"><span class="linenos">779</span></a>            <span class="n">changes</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DeTriTraining-780"><a href="#DeTriTraining-780"><span class="linenos">780</span></a>
</span><span id="DeTriTraining-781"><a href="#DeTriTraining-781"><span class="linenos">781</span></a>            <span class="c1"># Enlarged</span>
</span><span id="DeTriTraining-782"><a href="#DeTriTraining-782"><span class="linenos">782</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="DeTriTraining-783"><a href="#DeTriTraining-783"><span class="linenos">783</span></a>
</span><span id="DeTriTraining-784"><a href="#DeTriTraining-784"><span class="linenos">784</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining-785"><a href="#DeTriTraining-785"><span class="linenos">785</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="DeTriTraining-786"><a href="#DeTriTraining-786"><span class="linenos">786</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="DeTriTraining-787"><a href="#DeTriTraining-787"><span class="linenos">787</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="DeTriTraining-788"><a href="#DeTriTraining-788"><span class="linenos">788</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">validx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">])</span>
</span><span id="DeTriTraining-789"><a href="#DeTriTraining-789"><span class="linenos">789</span></a>
</span><span id="DeTriTraining-790"><a href="#DeTriTraining-790"><span class="linenos">790</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
</span><span id="DeTriTraining-791"><a href="#DeTriTraining-791"><span class="linenos">791</span></a>
</span><span id="DeTriTraining-792"><a href="#DeTriTraining-792"><span class="linenos">792</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeTriTraining-793"><a href="#DeTriTraining-793"><span class="linenos">793</span></a>                    <span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="DeTriTraining-794"><a href="#DeTriTraining-794"><span class="linenos">794</span></a>                    <span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depure</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DeTriTraining-795"><a href="#DeTriTraining-795"><span class="linenos">795</span></a>
</span><span id="DeTriTraining-796"><a href="#DeTriTraining-796"><span class="linenos">796</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining-797"><a href="#DeTriTraining-797"><span class="linenos">797</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_label</span><span class="p">):</span>
</span><span id="DeTriTraining-798"><a href="#DeTriTraining-798"><span class="linenos">798</span></a>                    <span class="n">last_addition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="DeTriTraining-799"><a href="#DeTriTraining-799"><span class="linenos">799</span></a>                    <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining-800"><a href="#DeTriTraining-800"><span class="linenos">800</span></a>                    <span class="n">hypothesis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="DeTriTraining-801"><a href="#DeTriTraining-801"><span class="linenos">801</span></a>
</span><span id="DeTriTraining-802"><a href="#DeTriTraining-802"><span class="linenos">802</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">changes</span><span class="p">:</span>
</span><span id="DeTriTraining-803"><a href="#DeTriTraining-803"><span class="linenos">803</span></a>                <span class="k">break</span>
</span><span id="DeTriTraining-804"><a href="#DeTriTraining-804"><span class="linenos">804</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DeTriTraining-805"><a href="#DeTriTraining-805"><span class="linenos">805</span></a>            <span class="n">warn</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Maximum number of iterations reached before convergence. Consider increasing max_iter to improve the fit.&quot;</span><span class="p">,</span> <span class="n">ConvergenceWarning</span><span class="p">)</span>
</span><span id="DeTriTraining-806"><a href="#DeTriTraining-806"><span class="linenos">806</span></a>
</span><span id="DeTriTraining-807"><a href="#DeTriTraining-807"><span class="linenos">807</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">])</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">])</span>
</span><span id="DeTriTraining-808"><a href="#DeTriTraining-808"><span class="linenos">808</span></a>        <span class="n">S_0</span><span class="p">,</span> <span class="n">index_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DeTriTraining-809"><a href="#DeTriTraining-809"><span class="linenos">809</span></a>        <span class="n">S_1</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">index_</span><span class="p">]</span>
</span><span id="DeTriTraining-810"><a href="#DeTriTraining-810"><span class="linenos">810</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">S_0</span><span class="p">,</span> <span class="n">S_1</span>
</span><span id="DeTriTraining-811"><a href="#DeTriTraining-811"><span class="linenos">811</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depure</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># Change, is S - L (only new)</span>
</span><span id="DeTriTraining-812"><a href="#DeTriTraining-812"><span class="linenos">812</span></a>
</span><span id="DeTriTraining-813"><a href="#DeTriTraining-813"><span class="linenos">813</span></a>        <span class="n">new_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clustering</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</span><span id="DeTriTraining-814"><a href="#DeTriTraining-814"><span class="linenos">814</span></a>
</span><span id="DeTriTraining-815"><a href="#DeTriTraining-815"><span class="linenos">815</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="p">[</span><span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)]</span>
</span><span id="DeTriTraining-816"><a href="#DeTriTraining-816"><span class="linenos">816</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span>
</span><span id="DeTriTraining-817"><a href="#DeTriTraining-817"><span class="linenos">817</span></a>
</span><span id="DeTriTraining-818"><a href="#DeTriTraining-818"><span class="linenos">818</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p><strong>TriTraining with Data Editing.</strong></p>

<p>It is a variation of the TriTraining, the main difference is that the instances are depurated in each iteration.
It means that the instances with their neighbors that have the same class are kept, the rest are removed.
At the end of the iterations, the instances are clustered and the class is assigned to the cluster centroid.</p>

<h2 id="methods"><strong>Methods</strong></h2>

<ul>
<li><code><a href="#DeTriTraining.fit">fit</a></code>: Fit the model with the labeled instances.</li>
<li><code><a href="#DeTriTraining.predict">predict</a></code> : Predict the class for each instance.</li>
<li><code><a href="#DeTriTraining.predict_proba">predict_proba</a></code>: Predict the probability for each class.</li>
<li><code><a href="#DeTriTraining.score">score</a></code>: Return the mean accuracy on the given test data and labels.</li>
</ul>

<h2 id="references"><strong>References</strong></h2>

<p>Deng C., Guo M.Z. (2006)<br>
Tri-training and Data Editing Based Semi-supervised Clustering Algorithm, <br>
in <i>Gelbukh A., Reyes-Garcia C.A. (eds) MICAI 2006: Advances in Artificial Intelligence. MICAI 2006.</i><br>
Lecture Notes in Computer Science, vol 4293. Springer, Berlin, Heidelberg.<br>
<a href="https://doi.org/10.1007/11925231_61">10.1007/11925231_61</a></p>
</div>


                            <div id="DeTriTraining.__init__" class="classattr">
                                        <input id="DeTriTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DeTriTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">k_neighbors</span><span class="o">=</span><span class="mi">3</span>,</span><span class="param">	<span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">mode</span><span class="o">=</span><span class="s1">&#39;seeded&#39;</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="DeTriTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeTriTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeTriTraining.__init__-581"><a href="#DeTriTraining.__init__-581"><span class="linenos">581</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="DeTriTraining.__init__-582"><a href="#DeTriTraining.__init__-582"><span class="linenos">582</span></a>                 <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;seeded&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DeTriTraining.__init__-583"><a href="#DeTriTraining.__init__-583"><span class="linenos">583</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DeTriTraining.__init__-584"><a href="#DeTriTraining.__init__-584"><span class="linenos">584</span></a><span class="sd">        DeTriTraining - TriTraining with Depurated and Clustering.</span>
</span><span id="DeTriTraining.__init__-585"><a href="#DeTriTraining.__init__-585"><span class="linenos">585</span></a><span class="sd">        Avoid the noise generated by the TriTraining algorithm by depurating the enlarged dataset and clustering the instances.        </span>
</span><span id="DeTriTraining.__init__-586"><a href="#DeTriTraining.__init__-586"><span class="linenos">586</span></a>
</span><span id="DeTriTraining.__init__-587"><a href="#DeTriTraining.__init__-587"><span class="linenos">587</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining.__init__-588"><a href="#DeTriTraining.__init__-588"><span class="linenos">588</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining.__init__-589"><a href="#DeTriTraining.__init__-589"><span class="linenos">589</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="DeTriTraining.__init__-590"><a href="#DeTriTraining.__init__-590"><span class="linenos">590</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="DeTriTraining.__init__-591"><a href="#DeTriTraining.__init__-591"><span class="linenos">591</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="DeTriTraining.__init__-592"><a href="#DeTriTraining.__init__-592"><span class="linenos">592</span></a><span class="sd">            Number of samples to generate. </span>
</span><span id="DeTriTraining.__init__-593"><a href="#DeTriTraining.__init__-593"><span class="linenos">593</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="DeTriTraining.__init__-594"><a href="#DeTriTraining.__init__-594"><span class="linenos">594</span></a><span class="sd">        k_neighbors : int, optional</span>
</span><span id="DeTriTraining.__init__-595"><a href="#DeTriTraining.__init__-595"><span class="linenos">595</span></a><span class="sd">            Number of neighbors for depurate classification. </span>
</span><span id="DeTriTraining.__init__-596"><a href="#DeTriTraining.__init__-596"><span class="linenos">596</span></a><span class="sd">            If at least k_neighbors/2+1 have a class other than the one predicted, the class is ignored., by default 3</span>
</span><span id="DeTriTraining.__init__-597"><a href="#DeTriTraining.__init__-597"><span class="linenos">597</span></a><span class="sd">        mode : string, optional</span>
</span><span id="DeTriTraining.__init__-598"><a href="#DeTriTraining.__init__-598"><span class="linenos">598</span></a><span class="sd">            How to calculate the cluster each instance belongs to.</span>
</span><span id="DeTriTraining.__init__-599"><a href="#DeTriTraining.__init__-599"><span class="linenos">599</span></a><span class="sd">            If `seeded` each instance belong to nearest cluster.</span>
</span><span id="DeTriTraining.__init__-600"><a href="#DeTriTraining.__init__-600"><span class="linenos">600</span></a><span class="sd">            If `constrained` each instance belong to nearest cluster unless the instance is in to enlarged dataset, </span>
</span><span id="DeTriTraining.__init__-601"><a href="#DeTriTraining.__init__-601"><span class="linenos">601</span></a><span class="sd">            then the instance belongs to the cluster of its class., by default `seeded`</span>
</span><span id="DeTriTraining.__init__-602"><a href="#DeTriTraining.__init__-602"><span class="linenos">602</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="DeTriTraining.__init__-603"><a href="#DeTriTraining.__init__-603"><span class="linenos">603</span></a><span class="sd">            Maximum number of iterations, by default 100</span>
</span><span id="DeTriTraining.__init__-604"><a href="#DeTriTraining.__init__-604"><span class="linenos">604</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="DeTriTraining.__init__-605"><a href="#DeTriTraining.__init__-605"><span class="linenos">605</span></a><span class="sd">            The number of parallel jobs to run for neighbors search. </span>
</span><span id="DeTriTraining.__init__-606"><a href="#DeTriTraining.__init__-606"><span class="linenos">606</span></a><span class="sd">            None means 1 unless in a joblib.parallel_backend context. -1 means using all processors. </span>
</span><span id="DeTriTraining.__init__-607"><a href="#DeTriTraining.__init__-607"><span class="linenos">607</span></a><span class="sd">            Doesn&#39;t affect fit method., by default None</span>
</span><span id="DeTriTraining.__init__-608"><a href="#DeTriTraining.__init__-608"><span class="linenos">608</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="DeTriTraining.__init__-609"><a href="#DeTriTraining.__init__-609"><span class="linenos">609</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="DeTriTraining.__init__-610"><a href="#DeTriTraining.__init__-610"><span class="linenos">610</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining.__init__-611"><a href="#DeTriTraining.__init__-611"><span class="linenos">611</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="DeTriTraining.__init__-612"><a href="#DeTriTraining.__init__-612"><span class="linenos">612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k_neighbors</span> <span class="o">=</span> <span class="n">k_neighbors</span>
</span><span id="DeTriTraining.__init__-613"><a href="#DeTriTraining.__init__-613"><span class="linenos">613</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
</span><span id="DeTriTraining.__init__-614"><a href="#DeTriTraining.__init__-614"><span class="linenos">614</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="DeTriTraining.__init__-615"><a href="#DeTriTraining.__init__-615"><span class="linenos">615</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="DeTriTraining.__init__-616"><a href="#DeTriTraining.__init__-616"><span class="linenos">616</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;seeded&quot;</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">:</span>
</span><span id="DeTriTraining.__init__-617"><a href="#DeTriTraining.__init__-617"><span class="linenos">617</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;`mode` must be </span><span class="se">\&quot;</span><span class="s2">seeded</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">constrained</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>DeTriTraining - TriTraining with Depurated and Clustering.
Avoid the noise generated by the TriTraining algorithm by depurating the enlarged dataset and clustering the instances.        </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>n_samples</strong> (int, optional):
Number of samples to generate. 
If left to None this is automatically set to the first dimension of the arrays., by default None</li>
<li><strong>k_neighbors</strong> (int, optional):
Number of neighbors for depurate classification. 
If at least k_neighbors/2+1 have a class other than the one predicted, the class is ignored., by default 3</li>
<li><strong>mode</strong> (string, optional):
How to calculate the cluster each instance belongs to.
If <code>seeded</code> each instance belong to nearest cluster.
If <code>constrained</code> each instance belong to nearest cluster unless the instance is in to enlarged dataset, 
then the instance belongs to the cluster of its class., by default <code>seeded</code></li>
<li><strong>max_iterations</strong> (int, optional):
Maximum number of iterations, by default 100</li>
<li><strong>n_jobs</strong> (int, optional):
The number of parallel jobs to run for neighbors search. 
None means 1 unless in a joblib.parallel_backend context. -1 means using all processors. 
Doesn't affect fit method., by default None</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>
</div>


                            </div>
                            <div id="DeTriTraining.fit" class="classattr">
                                        <input id="DeTriTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeTriTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeTriTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeTriTraining.fit-711"><a href="#DeTriTraining.fit-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-712"><a href="#DeTriTraining.fit-712"><span class="linenos">712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a DeTriTraining classifier from the training set (X, y).</span>
</span><span id="DeTriTraining.fit-713"><a href="#DeTriTraining.fit-713"><span class="linenos">713</span></a>
</span><span id="DeTriTraining.fit-714"><a href="#DeTriTraining.fit-714"><span class="linenos">714</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining.fit-715"><a href="#DeTriTraining.fit-715"><span class="linenos">715</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining.fit-716"><a href="#DeTriTraining.fit-716"><span class="linenos">716</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DeTriTraining.fit-717"><a href="#DeTriTraining.fit-717"><span class="linenos">717</span></a><span class="sd">            The training input samples.</span>
</span><span id="DeTriTraining.fit-718"><a href="#DeTriTraining.fit-718"><span class="linenos">718</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="DeTriTraining.fit-719"><a href="#DeTriTraining.fit-719"><span class="linenos">719</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="DeTriTraining.fit-720"><a href="#DeTriTraining.fit-720"><span class="linenos">720</span></a>
</span><span id="DeTriTraining.fit-721"><a href="#DeTriTraining.fit-721"><span class="linenos">721</span></a><span class="sd">        Returns</span>
</span><span id="DeTriTraining.fit-722"><a href="#DeTriTraining.fit-722"><span class="linenos">722</span></a><span class="sd">        -------</span>
</span><span id="DeTriTraining.fit-723"><a href="#DeTriTraining.fit-723"><span class="linenos">723</span></a><span class="sd">        self: DeTriTraining</span>
</span><span id="DeTriTraining.fit-724"><a href="#DeTriTraining.fit-724"><span class="linenos">724</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="DeTriTraining.fit-725"><a href="#DeTriTraining.fit-725"><span class="linenos">725</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining.fit-726"><a href="#DeTriTraining.fit-726"><span class="linenos">726</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-727"><a href="#DeTriTraining.fit-727"><span class="linenos">727</span></a>
</span><span id="DeTriTraining.fit-728"><a href="#DeTriTraining.fit-728"><span class="linenos">728</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="DeTriTraining.fit-729"><a href="#DeTriTraining.fit-729"><span class="linenos">729</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-730"><a href="#DeTriTraining.fit-730"><span class="linenos">730</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-731"><a href="#DeTriTraining.fit-731"><span class="linenos">731</span></a>
</span><span id="DeTriTraining.fit-732"><a href="#DeTriTraining.fit-732"><span class="linenos">732</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-733"><a href="#DeTriTraining.fit-733"><span class="linenos">733</span></a>
</span><span id="DeTriTraining.fit-734"><a href="#DeTriTraining.fit-734"><span class="linenos">734</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-735"><a href="#DeTriTraining.fit-735"><span class="linenos">735</span></a>
</span><span id="DeTriTraining.fit-736"><a href="#DeTriTraining.fit-736"><span class="linenos">736</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-737"><a href="#DeTriTraining.fit-737"><span class="linenos">737</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DeTriTraining.fit-738"><a href="#DeTriTraining.fit-738"><span class="linenos">738</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DeTriTraining.fit-739"><a href="#DeTriTraining.fit-739"><span class="linenos">739</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-740"><a href="#DeTriTraining.fit-740"><span class="linenos">740</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-741"><a href="#DeTriTraining.fit-741"><span class="linenos">741</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-742"><a href="#DeTriTraining.fit-742"><span class="linenos">742</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-743"><a href="#DeTriTraining.fit-743"><span class="linenos">743</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-744"><a href="#DeTriTraining.fit-744"><span class="linenos">744</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-745"><a href="#DeTriTraining.fit-745"><span class="linenos">745</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-746"><a href="#DeTriTraining.fit-746"><span class="linenos">746</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-747"><a href="#DeTriTraining.fit-747"><span class="linenos">747</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-748"><a href="#DeTriTraining.fit-748"><span class="linenos">748</span></a>                <span class="k">break</span>
</span><span id="DeTriTraining.fit-749"><a href="#DeTriTraining.fit-749"><span class="linenos">749</span></a>
</span><span id="DeTriTraining.fit-750"><a href="#DeTriTraining.fit-750"><span class="linenos">750</span></a>        <span class="n">S_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DeTriTraining.fit-751"><a href="#DeTriTraining.fit-751"><span class="linenos">751</span></a>        <span class="n">hypothesis</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DeTriTraining.fit-752"><a href="#DeTriTraining.fit-752"><span class="linenos">752</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-753"><a href="#DeTriTraining.fit-753"><span class="linenos">753</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span> <span class="o">=</span> \
</span><span id="DeTriTraining.fit-754"><a href="#DeTriTraining.fit-754"><span class="linenos">754</span></a>                <span class="n">resample</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeTriTraining.fit-755"><a href="#DeTriTraining.fit-755"><span class="linenos">755</span></a>                         <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="DeTriTraining.fit-756"><a href="#DeTriTraining.fit-756"><span class="linenos">756</span></a>                         <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-757"><a href="#DeTriTraining.fit-757"><span class="linenos">757</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-758"><a href="#DeTriTraining.fit-758"><span class="linenos">758</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-759"><a href="#DeTriTraining.fit-759"><span class="linenos">759</span></a>            <span class="n">hypothesis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="DeTriTraining.fit-760"><a href="#DeTriTraining.fit-760"><span class="linenos">760</span></a>                <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="DeTriTraining.fit-761"><a href="#DeTriTraining.fit-761"><span class="linenos">761</span></a>                    <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-762"><a href="#DeTriTraining.fit-762"><span class="linenos">762</span></a>            <span class="p">)</span>
</span><span id="DeTriTraining.fit-763"><a href="#DeTriTraining.fit-763"><span class="linenos">763</span></a>
</span><span id="DeTriTraining.fit-764"><a href="#DeTriTraining.fit-764"><span class="linenos">764</span></a>            <span class="c1"># Keep class order</span>
</span><span id="DeTriTraining.fit-765"><a href="#DeTriTraining.fit-765"><span class="linenos">765</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-766"><a href="#DeTriTraining.fit-766"><span class="linenos">766</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-767"><a href="#DeTriTraining.fit-767"><span class="linenos">767</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-768"><a href="#DeTriTraining.fit-768"><span class="linenos">768</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-769"><a href="#DeTriTraining.fit-769"><span class="linenos">769</span></a>
</span><span id="DeTriTraining.fit-770"><a href="#DeTriTraining.fit-770"><span class="linenos">770</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-771"><a href="#DeTriTraining.fit-771"><span class="linenos">771</span></a>
</span><span id="DeTriTraining.fit-772"><a href="#DeTriTraining.fit-772"><span class="linenos">772</span></a>            <span class="n">S_</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">))</span>
</span><span id="DeTriTraining.fit-773"><a href="#DeTriTraining.fit-773"><span class="linenos">773</span></a>
</span><span id="DeTriTraining.fit-774"><a href="#DeTriTraining.fit-774"><span class="linenos">774</span></a>        <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining.fit-775"><a href="#DeTriTraining.fit-775"><span class="linenos">775</span></a>        <span class="n">last_addition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="DeTriTraining.fit-776"><a href="#DeTriTraining.fit-776"><span class="linenos">776</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span>
</span><span id="DeTriTraining.fit-777"><a href="#DeTriTraining.fit-777"><span class="linenos">777</span></a>        <span class="k">while</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-778"><a href="#DeTriTraining.fit-778"><span class="linenos">778</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DeTriTraining.fit-779"><a href="#DeTriTraining.fit-779"><span class="linenos">779</span></a>            <span class="n">changes</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DeTriTraining.fit-780"><a href="#DeTriTraining.fit-780"><span class="linenos">780</span></a>
</span><span id="DeTriTraining.fit-781"><a href="#DeTriTraining.fit-781"><span class="linenos">781</span></a>            <span class="c1"># Enlarged</span>
</span><span id="DeTriTraining.fit-782"><a href="#DeTriTraining.fit-782"><span class="linenos">782</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="DeTriTraining.fit-783"><a href="#DeTriTraining.fit-783"><span class="linenos">783</span></a>
</span><span id="DeTriTraining.fit-784"><a href="#DeTriTraining.fit-784"><span class="linenos">784</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-785"><a href="#DeTriTraining.fit-785"><span class="linenos">785</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-786"><a href="#DeTriTraining.fit-786"><span class="linenos">786</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-787"><a href="#DeTriTraining.fit-787"><span class="linenos">787</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-788"><a href="#DeTriTraining.fit-788"><span class="linenos">788</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">validx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">])</span>
</span><span id="DeTriTraining.fit-789"><a href="#DeTriTraining.fit-789"><span class="linenos">789</span></a>
</span><span id="DeTriTraining.fit-790"><a href="#DeTriTraining.fit-790"><span class="linenos">790</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-791"><a href="#DeTriTraining.fit-791"><span class="linenos">791</span></a>
</span><span id="DeTriTraining.fit-792"><a href="#DeTriTraining.fit-792"><span class="linenos">792</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-793"><a href="#DeTriTraining.fit-793"><span class="linenos">793</span></a>                    <span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="DeTriTraining.fit-794"><a href="#DeTriTraining.fit-794"><span class="linenos">794</span></a>                    <span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depure</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DeTriTraining.fit-795"><a href="#DeTriTraining.fit-795"><span class="linenos">795</span></a>
</span><span id="DeTriTraining.fit-796"><a href="#DeTriTraining.fit-796"><span class="linenos">796</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-797"><a href="#DeTriTraining.fit-797"><span class="linenos">797</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_label</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-798"><a href="#DeTriTraining.fit-798"><span class="linenos">798</span></a>                    <span class="n">last_addition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="DeTriTraining.fit-799"><a href="#DeTriTraining.fit-799"><span class="linenos">799</span></a>                    <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining.fit-800"><a href="#DeTriTraining.fit-800"><span class="linenos">800</span></a>                    <span class="n">hypothesis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-801"><a href="#DeTriTraining.fit-801"><span class="linenos">801</span></a>
</span><span id="DeTriTraining.fit-802"><a href="#DeTriTraining.fit-802"><span class="linenos">802</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">changes</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-803"><a href="#DeTriTraining.fit-803"><span class="linenos">803</span></a>                <span class="k">break</span>
</span><span id="DeTriTraining.fit-804"><a href="#DeTriTraining.fit-804"><span class="linenos">804</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-805"><a href="#DeTriTraining.fit-805"><span class="linenos">805</span></a>            <span class="n">warn</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Maximum number of iterations reached before convergence. Consider increasing max_iter to improve the fit.&quot;</span><span class="p">,</span> <span class="n">ConvergenceWarning</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-806"><a href="#DeTriTraining.fit-806"><span class="linenos">806</span></a>
</span><span id="DeTriTraining.fit-807"><a href="#DeTriTraining.fit-807"><span class="linenos">807</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">])</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">])</span>
</span><span id="DeTriTraining.fit-808"><a href="#DeTriTraining.fit-808"><span class="linenos">808</span></a>        <span class="n">S_0</span><span class="p">,</span> <span class="n">index_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-809"><a href="#DeTriTraining.fit-809"><span class="linenos">809</span></a>        <span class="n">S_1</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">index_</span><span class="p">]</span>
</span><span id="DeTriTraining.fit-810"><a href="#DeTriTraining.fit-810"><span class="linenos">810</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">S_0</span><span class="p">,</span> <span class="n">S_1</span>
</span><span id="DeTriTraining.fit-811"><a href="#DeTriTraining.fit-811"><span class="linenos">811</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depure</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># Change, is S - L (only new)</span>
</span><span id="DeTriTraining.fit-812"><a href="#DeTriTraining.fit-812"><span class="linenos">812</span></a>
</span><span id="DeTriTraining.fit-813"><a href="#DeTriTraining.fit-813"><span class="linenos">813</span></a>        <span class="n">new_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clustering</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-814"><a href="#DeTriTraining.fit-814"><span class="linenos">814</span></a>
</span><span id="DeTriTraining.fit-815"><a href="#DeTriTraining.fit-815"><span class="linenos">815</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="p">[</span><span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)]</span>
</span><span id="DeTriTraining.fit-816"><a href="#DeTriTraining.fit-816"><span class="linenos">816</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span>
</span><span id="DeTriTraining.fit-817"><a href="#DeTriTraining.fit-817"><span class="linenos">817</span></a>
</span><span id="DeTriTraining.fit-818"><a href="#DeTriTraining.fit-818"><span class="linenos">818</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a DeTriTraining classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (DeTriTraining):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="DeTriTraining.predict_proba" class="function">predict_proba</dd>
                <dd id="DeTriTraining.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="DeTriTraining.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="DeTriTraining.get_params" class="function">get_params</dd>
                <dd id="DeTriTraining.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>